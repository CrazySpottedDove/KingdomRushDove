local i18n = require("i18n")
require("constants")
local anchor_x = 0
local anchor_y = 0
local image_x = 0
local image_y = nil
local tt = nil
local scripts = require("game_scripts")
require("templates")
local function adx(v)
    return v - anchor_x * image_x
end
local function ady(v)
    return v - anchor_y * image_y
end
require("game_templates_utils")

local function enemies()
    tt = RT("enemy_sheep_ground", "enemy")
    anchor_y = 0.2
    image_y = 38
    tt.enemy.gold = 0
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 80
    tt.health_bar.offset = vec_2(0, ady(32))
    tt.info.i18n_key = "ENEMY_SHEEP"
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0013" or "info_portraits_sc_0013"
    tt.info.enc_icon = nil
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_sheep.update
    tt.motion.max_speed = 1.5 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_sheep_ground"
    tt.sound_events.insert = "Sheep"
    tt.sound_events.death = "DeathEplosion"
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 10)
    tt.unit.mod_offset = vec_2(0, ady(15))
    tt.vis.bans = bor(F_BLOCK, F_SKELETON, F_EAT, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY)
    tt.clicks_to_destroy = 8
    tt = RT("enemy_sheep_fly", "enemy_sheep_ground")
    anchor_y = 0.038461538461538464
    image_y = 78
    tt.enemy.gold = 80
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 389
    tt.health_bar.offset = vec_2(0, ady(68))
    tt.motion.max_speed = 2.08 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_sheep_fly"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].offset = vec_2(0, 0)
    tt.ui.click_rect.pos.y = 40
    tt.unit.disintegrate_fx = "fx_enemy_desintegrate_air"
    tt.unit.hit_offset = vec_2(0, ady(56))
    tt.unit.mod_offset = vec_2(0, ady(48))
    tt.unit.show_blood_pool = false
    tt.vis.flags = bor(F_ENEMY, F_FLYING)
    tt = RT("enemy_goblin", "enemy")

    AC(tt, "melee")

    image_y = 32
    image_x = 46
    anchor_y = 0.2
    anchor_x = 0.5
    tt.enemy.gold = 3
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 20
    tt.health_bar.offset = vec_2(0, 25)
    tt.info.i18n_key = "ENEMY_GOBLIN"
    tt.info.enc_icon = 1
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0006" or "info_portraits_sc_0006"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 4
    tt.melee.attacks[1].damage_min = 1
    tt.melee.attacks[1].hit_time = fts(9)
    tt.motion.max_speed = 1.2 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, anchor_y)
    tt.render.sprites[1].prefix = "goblin"
    tt.sound_events.death = "DeathGoblin"
    tt.unit.hit_offset = vec_2(0, 8)
    tt.unit.mod_offset = vec_2(adx(22), ady(15))
    tt = RT("enemy_fat_orc", "enemy")

    AC(tt, "melee")

    anchor_y = 0.19
    anchor_x = 0.5
    image_y = 42
    image_x = 58
    tt.enemy.gold = 9
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.armor = 0.3
    tt.health.hp_max = 80
    tt.health_bar.offset = vec_2(0, 30)
    tt.info.i18n_key = "ENEMY_FAT_ORC"
    tt.info.enc_icon = 2
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0007" or "info_portraits_sc_0007"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 8
    tt.melee.attacks[1].damage_min = 4
    tt.melee.attacks[1].hit_time = fts(6)
    tt.motion.max_speed = 0.8 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.19)
    tt.render.sprites[1].prefix = "enemy_fat_orc"
    tt.sound_events.death = "DeathOrc"
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.mod_offset = vec_2(adx(30), ady(20))
    tt = RT("enemy_wolf_small", "enemy")

    AC(tt, "dodge", "melee")

    anchor_y = 0.21
    anchor_x = 0.5
    image_y = 28
    image_x = 38
    tt.dodge.chance = 0.3
    tt.dodge.silent = true
    tt.enemy.gold = 5
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 35
    tt.health_bar.offset = vec_2(0, 25)
    tt.info.i18n_key = "ENEMY_WULF"
    tt.info.enc_icon = 13
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0012" or "info_portraits_sc_0012"
    tt.melee.attacks[1].cooldown = 1 + fts(14)
    tt.melee.attacks[1].damage_max = 3
    tt.melee.attacks[1].damage_min = 1
    tt.melee.attacks[1].hit_time = fts(9)
    tt.melee.attacks[1].sound = "WolfAttack"
    tt.motion.max_speed = 2.5 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.21)
    tt.render.sprites[1].prefix = "enemy_wolf_small"
    tt.sound_events.death = "DeathPuff"
    tt.sound_events.death_by_explosion = "DeathPuff"
    tt.unit.can_explode = false
    tt.unit.show_blood_pool = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 11)
    tt.unit.mod_offset = vec_2(adx(22), ady(14))
    tt.vis.bans = bor(F_SKELETON)

    tt = RT("enemy_wolf", "enemy")
    AC(tt, "dodge", "melee")
    anchor_y = 0.26
    anchor_x = 0.5
    image_y = 50
    image_x = 60
    tt.dodge.chance = 0.5
    tt.dodge.silent = true
    tt.enemy.gold = 12
    tt.enemy.melee_slot = vec_2(25, 0)
    tt.health.hp_max = 120
    tt.health.magic_armor = 0.5
    tt.health_bar.offset = vec_2(0, 35)
    tt.info.i18n_key = "ENEMY_WORG"
    tt.info.enc_icon = 14
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0020" or "info_portraits_sc_0020"
    tt.melee.attacks[1].cooldown = 1 + fts(14)
    tt.melee.attacks[1].damage_max = 18
    tt.melee.attacks[1].damage_min = 12
    tt.melee.attacks[1].hit_time = fts(9)
    tt.melee.attacks[1].sound = "WolfAttack"
    tt.motion.max_speed = 2 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.26)
    tt.render.sprites[1].prefix = "enemy_wolf"
    tt.sound_events.death = "DeathPuff"
    tt.sound_events.death_by_explosion = "DeathPuff"
    tt.unit.can_explode = false
    tt.unit.show_blood_pool = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 13)
    tt.unit.marker_offset.y = 2
    tt.unit.mod_offset = vec_2(adx(29), ady(26))
    tt.vis.bans = bor(F_SKELETON)

    tt = RT("enemy_shadow_archer", "enemy")
    AC(tt, "melee", "ranged")
    anchor_y = 0.2
    anchor_x = 0.5
    image_y = 36
    image_x = 54
    tt.enemy.gold = 16
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 180
    tt.health.magic_armor = 0.3
    tt.health_bar.offset = vec_2(0, 31)
    tt.info.i18n_key = "ENEMY_SHADOW_ARCHER"
    tt.info.enc_icon = 11
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0025" or "info_portraits_sc_0025"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 20
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(4)
    tt.motion.max_speed = 1.2 * FPS
    tt.ranged.attacks[1].bullet = "arrow_shadow_archer"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(4, 12.5)}
    tt.ranged.attacks[1].cooldown = 1 + fts(12)
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].max_range = 145
    tt.ranged.attacks[1].min_range = 50
    tt.ranged.attacks[1].shoot_time = fts(7)
    tt.ranged.attacks[1].requires_magic = true
    tt.render.sprites[1].anchor = vec_2(0.5, 0.2)
    tt.render.sprites[1].prefix = "enemy_shadow_archer"
    tt.sound_events.death = "DeathHuman"
    tt.unit.hit_offset = vec_2(0, 15)
    tt.unit.mod_offset = vec_2(adx(26), ady(20))
    tt.unit.marker_offset.y = 1

    tt = RT("enemy_shaman", "enemy")
    AC(tt, "melee", "timed_attacks")
    anchor_y = 0.2
    anchor_x = 0.5
    image_y = 60
    image_x = 60
    tt.enemy.gold = 10
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 100
    tt.health.magic_armor = 0.85
    tt.health_bar.offset = vec_2(0, 33)
    tt.info.i18n_key = "ENEMY_SHAMAN"
    tt.info.enc_icon = 3
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0009" or "info_portraits_sc_0009"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_shaman.update
    tt.melee.attacks[1].cooldown = 1 + fts(18)
    tt.melee.attacks[1].damage_max = 5
    tt.melee.attacks[1].damage_min = 3
    tt.melee.attacks[1].hit_time = fts(9)
    tt.motion.max_speed = 1 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.2)
    tt.render.sprites[1].prefix = "enemy_shaman"
    tt.sound_events.death = "DeathGoblin"
    tt.timed_attacks.list[1] = E:clone_c("mod_attack")
    tt.timed_attacks.list[1].animation = "heal"
    tt.timed_attacks.list[1].cast_time = fts(14)
    tt.timed_attacks.list[1].cooldown = 8
    tt.timed_attacks.list[1].max_count = 3
    tt.timed_attacks.list[1].max_range = 95
    tt.timed_attacks.list[1].mod = "mod_shaman_heal"
    tt.timed_attacks.list[1].sound = "EnemyHealing"
    tt.timed_attacks.list[1].vis_flags = bor(F_MOD)
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, -2)
    tt.unit.mod_offset = vec_2(adx(30), ady(20))
    tt = RT("enemy_gargoyle", "enemy")
    anchor_y = 0
    anchor_x = 0.5
    image_y = 88
    image_x = 58
    tt.enemy.gold = 12
    tt.health.hp_max = 90
    tt.health_bar.offset = vec_2(adx(29), ady(69))
    tt.info.i18n_key = "ENEMY_GARGOYLE"
    tt.info.enc_icon = 10
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0010" or "info_portraits_sc_0010"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_passive.update
    tt.motion.max_speed = 1.2 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_gargoyle"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].offset = vec_2(0, 0)
    tt.sound_events.death = "DeathPuff"
    tt.ui.click_rect = r(-14, 34, 28, 30)
    tt.unit.can_explode = false
    tt.unit.can_disintegrate = true
    tt.unit.disintegrate_fx = "fx_enemy_desintegrate_air"
    tt.unit.hit_offset = vec_2(0, 52)
    tt.unit.hide_after_death = true
    tt.unit.mod_offset = vec_2(adx(31), ady(50))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_BLOCK, F_THORN, F_SKELETON)
    tt.vis.flags = bor(F_ENEMY, F_FLYING)
    tt = RT("enemy_ogre", "enemy")

    AC(tt, "melee")

    anchor_y = 0.2
    anchor_x = 0.5
    image_y = 80
    image_x = 86
    tt.enemy.gold = 50
    tt.enemy.lives_cost = 3
    tt.enemy.melee_slot = vec_2(24, 0)
    tt.health.hp_max = 800
    tt.health_bar.offset = vec_2(0, 53)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.i18n_key = "ENEMY_OGRE"
    tt.info.enc_icon = 4
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0011" or "info_portraits_sc_0011"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 60
    tt.melee.attacks[1].damage_min = 40
    tt.melee.attacks[1].hit_time = fts(16)
    tt.motion.max_speed = 0.7 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_ogre"
    tt.sound_events.death = "DeathBig"
    tt.ui.click_rect.size = vec_2(34, 45)
    tt.ui.click_rect.pos.x = -17
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 20)
    tt.unit.mod_offset = vec_2(adx(42), ady(33))
    tt.unit.size = UNIT_SIZE_MEDIUM

    tt = RT("enemy_spider_tiny", "enemy")
    AC(tt, "melee")
    anchor_y = 0.25
    anchor_x = 0.5
    image_y = 24
    image_x = 30
    tt.enemy.gold = 1
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.health.hp_max = 10
    tt.health.magic_armor = 0.5
    tt.health_bar.offset = vec_2(0, 16)
    tt.info.i18n_key = "ENEMY_SPIDERTINY"
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0023" or "info_portraits_sc_0023"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 5
    tt.melee.attacks[1].damage_min = 1
    tt.melee.attacks[1].hit_time = fts(12)
    tt.melee.attacks[1].sound_hit = "SpiderAttack"
    tt.motion.max_speed = 2 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_spider_tiny"
    tt.sound_events.death = "DeathEplosionShortA"
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.explode_fx = "fx_spider_explode"
    tt.unit.hit_offset = vec_2(0, 8)
    tt.unit.marker_offset = vec_2(0, ady(5))
    tt.unit.mod_offset = vec_2(adx(18), ady(13))
    tt.vis.bans = bor(F_SKELETON, F_POISON)

    tt = RT("enemy_spider_small", "enemy")
    AC(tt, "melee")
    anchor_y = 0.25
    anchor_x = 0.5
    image_y = 28
    image_x = 36
    tt.enemy.gold = 6
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.health.hp_max = 60
    tt.health.magic_armor = 0.65
    tt.health_bar.offset = vec_2(0, 22)
    tt.info.i18n_key = "ENEMY_SPIDERSMALL"
    tt.info.enc_icon = 8
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0022" or "info_portraits_sc_0022"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 18
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(12)
    tt.melee.attacks[1].sound_hit = "SpiderAttack"
    tt.motion.max_speed = 1.5 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_spider_small"
    tt.sound_events.death = "DeathEplosion"
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.explode_fx = "fx_spider_explode"
    tt.unit.hit_offset = vec_2(0, 8)
    tt.unit.marker_offset = vec_2(0, -1)
    tt.unit.mod_offset = vec_2(adx(20), ady(15))
    tt.vis.bans = bor(F_SKELETON, F_POISON)

    tt = RT("enemy_spider_big", "enemy")
    AC(tt, "melee", "timed_attacks")
    anchor_y = 0.25
    anchor_x = 0.5
    image_y = 40
    image_x = 56
    tt.enemy.gold = 20
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(24, 0)
    tt.health.hp_max = 250
    tt.health.magic_armor = 0.8
    tt.health_bar.offset = vec_2(0, 32)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.i18n_key = "ENEMY_SPIDER"
    tt.info.enc_icon = 9
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0021" or "info_portraits_sc_0021"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_spider_big.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 25
    tt.melee.attacks[1].damage_min = 15
    tt.melee.attacks[1].hit_time = fts(12)
    tt.melee.attacks[1].sound_hit = "SpiderAttack"
    tt.motion.max_speed = 1 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_spider"
    tt.sound_events.death = "DeathEplosion"
    tt.timed_attacks.list[1] = E:clone_c("bullet_attack")
    tt.timed_attacks.list[1].bullet = "enemy_spider_egg"
    tt.timed_attacks.list[1].max_cooldown = 10
    tt.timed_attacks.list[1].max_count = 3
    tt.timed_attacks.list[1].min_cooldown = 5
    tt.ui.click_rect = r(-20, -5, 40, 30)
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.explode_fx = "fx_spider_explode"
    tt.unit.hit_offset = vec_2(0, 8)
    tt.unit.marker_offset = vec_2(-0.4, -2.2)
    tt.unit.mod_offset = vec_2(adx(26), ady(18))
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_SKELETON, F_POISON)

    tt = E:register_t("enemy_spider_egg", "decal_scripted")
    E:add_comps(tt, "render", "spawner", "tween")
    tt.main_script.update = scripts.enemies_spawner.update
    tt.render.sprites[1].anchor.y = 0.22
    tt.render.sprites[1].prefix = "enemy_spider_egg"
    tt.render.sprites[1].loop = false
    tt.spawner.count = 3
    tt.spawner.cycle_time = fts(6)
    tt.spawner.entity = "enemy_spider_tiny"
    tt.spawner.node_offset = 5
    tt.spawner.pos_offset = vec_2(0, 1)
    tt.spawner.allowed_subpaths = {1, 2, 3}
    tt.spawner.random_subpath = false
    tt.spawner.animation_start = "start"
    tt.tween.disabled = true
    tt.tween.props[1].keys = {{0, 255}, {4, 0}}
    tt.tween.remove = true

    tt = RT("enemy_brigand", "enemy")
    AC(tt, "melee")
    anchor_y = 0.2
    anchor_x = 0.5
    image_y = 38
    image_x = 50
    tt.enemy.gold = 15
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.armor = 0.5
    tt.health.hp_max = 160
    tt.health_bar.offset = vec_2(0, 31)
    tt.info.i18n_key = "ENEMY_BRIGAND"
    tt.info.enc_icon = 6
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0018" or "info_portraits_sc_0018"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 10
    tt.melee.attacks[1].damage_min = 6
    tt.melee.attacks[1].hit_time = fts(9)
    tt.motion.max_speed = 0.8 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_brigand"
    tt.sound_events.death = "DeathHuman"
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.mod_offset = vec_2(adx(24), ady(19))
    tt = RT("enemy_dark_knight", "enemy")

    AC(tt, "melee")

    anchor_y = 0.2
    anchor_x = 0.5
    image_y = 46
    image_x = 64
    tt.enemy.gold = 25
    tt.enemy.melee_slot = vec_2(24, 0)
    tt.health.armor = 0.8
    tt.health.hp_max = 300
    tt.health_bar.offset = vec_2(0, 35)
    tt.info.i18n_key = "ENEMY_DARK_KNIGHT"
    tt.info.enc_icon = 12
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0024" or "info_portraits_sc_0024"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 25
    tt.melee.attacks[1].damage_min = 15
    tt.melee.attacks[1].hit_time = fts(7)
    tt.motion.max_speed = 0.7 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_dark_knight"
    tt.sound_events.death = "DeathHuman"
    tt.unit.hit_offset = vec_2(0, 16)
    tt.unit.mod_offset = vec_2(adx(32), ady(20))
    tt.unit.marker_offset.y = -2
    tt = RT("enemy_marauder", "enemy")

    AC(tt, "melee")

    anchor_y = 0.22
    anchor_x = 0.5
    image_y = 56
    image_x = 78
    tt.enemy.gold = 40
    tt.enemy.lives_cost = 3
    tt.enemy.melee_slot = vec_2(24, 0)
    tt.health.armor = 0.6
    tt.health.hp_max = 600
    tt.health_bar.offset = vec_2(0, 48)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.i18n_key = "ENEMY_MARAUDER"
    tt.info.enc_icon = 7
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0019" or "info_portraits_sc_0019"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 24
    tt.melee.attacks[1].damage_min = 16
    tt.melee.attacks[1].hit_time = fts(10)
    tt.motion.max_speed = 0.8 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_marauder"
    tt.sound_events.death = "DeathHuman"
    tt.ui.click_rect = r(-20, -5, 40, 40)
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 20)
    tt.unit.mod_offset = vec_2(adx(39), ady(24))
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt = RT("enemy_bandit", "enemy")

    AC(tt, "melee", "dodge")

    anchor_y = 0.2
    anchor_x = 0.5
    image_y = 34
    image_x = 48
    tt.dodge.chance = 0.5
    tt.dodge.silent = true
    tt.enemy.gold = 8
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 70
    tt.health_bar.offset = vec_2(0, 30)
    tt.info.i18n_key = "ENEMY_BANDIT"
    tt.info.enc_icon = 5
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0008" or "info_portraits_sc_0008"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 30
    tt.melee.attacks[1].damage_min = 20
    tt.melee.attacks[1].hit_time = fts(4)
    tt.motion.max_speed = 1.2 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_bandit"
    tt.sound_events.death = "DeathHuman"
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, 2)
    tt.unit.mod_offset = vec_2(adx(24), ady(17))

    tt = RT("enemy_slayer", "enemy")
    AC(tt, "melee")
    anchor_y = 0.22
    anchor_x = 0.5
    image_y = 66
    image_x = 74
    tt.enemy.gold = 100
    tt.enemy.lives_cost = 3
    tt.enemy.melee_slot = vec_2(24, 0)
    tt.health.armor = 0.95
    tt.health.hp_max = 1200
    tt.health_bar.offset = vec_2(0, 50)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.i18n_key = "ENEMY_SLAYER"
    tt.info.enc_icon = 22
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0046" or "info_portraits_sc_0046"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 76
    tt.melee.attacks[1].damage_min = 24
    tt.melee.attacks[1].hit_time = fts(7)
    tt.melee.attacks[1].side_effect = function(this, store, attack, target)
        if this.enemy.can_do_magic then
            local regen = (this.health.hp_max - this.health.hp) * 0.04
            this.health.hp = this.health.hp + regen
        end
    end
    tt.motion.max_speed = 0.7 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_slayer"
    tt.sound_events.death = "DeathHuman"
    tt.ui.click_rect.size = vec_2(32, 42)
    tt.ui.click_rect.pos.x = -16
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 20)
    tt.unit.mod_offset = vec_2(adx(37), ady(25))
    tt.unit.size = UNIT_SIZE_MEDIUM

    tt = RT("enemy_rocketeer", "enemy")
    anchor_y = 0
    anchor_x = 0.5
    image_y = 88
    image_x = 80
    tt.enemy.gold = 30
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 340
    tt.health.on_damage = scripts.enemy_rocketeer.on_damage
    tt.health_bar.offset = vec_2(0, 78)
    tt.info.i18n_key = "ENEMY_ROCKETEER"
    tt.info.enc_icon = 21
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0045" or "info_portraits_sc_0045"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_passive.update
    tt.motion.max_speed = 1.2 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0)
    tt.render.sprites[1].prefix = "enemy_rocketeer"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].offset = vec_2(0, 0)
    tt.sound_events.death = "BombExplosionSound"
    tt.ui.click_rect = r(-14, 40, 28, 34)
    tt.unit.can_explode = false
    tt.unit.can_disintegrate = true
    tt.unit.disintegrate_fx = "fx_enemy_desintegrate_air"
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 58)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(adx(40), ady(56))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_BLOCK, F_THORN, F_SKELETON)
    tt.vis.flags = bor(F_ENEMY, F_FLYING)

    tt = RT("enemy_troll", "enemy")
    AC(tt, "melee", "auras")
    anchor_y = 0.22727272727272727
    anchor_x = 0.5
    image_y = 44
    image_x = 60
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "aura_troll_regen"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 25
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 280
    tt.info.i18n_key = "ENEMY_TROLL"
    tt.info.enc_icon = 17
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0029" or "info_portraits_sc_0029"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 40
    tt.melee.attacks[1].damage_min = 20
    tt.melee.attacks[1].hit_time = fts(7)
    tt.motion.max_speed = 0.9 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_troll"
    tt.sound_events.death = "DeathTroll"
    tt.unit.hit_offset = vec_2(0, 13)
    tt.unit.mod_offset = vec_2(adx(28), ady(23))
    tt = RT("enemy_whitewolf", "enemy")

    AC(tt, "melee", "dodge")

    anchor_y = 0.3275862068965517
    anchor_x = 0.5
    image_y = 58
    image_x = 64
    tt.dodge.chance = 0.5
    tt.dodge.silent = true
    tt.enemy.gold = 35
    tt.enemy.melee_slot = vec_2(24, 0)
    tt.health.hp_max = 350
    tt.health.magic_armor = 0.5
    tt.health_bar.offset = vec_2(0, 39)
    tt.info.i18n_key = "ENEMY_WHITE_WOLF"
    tt.info.enc_icon = 16
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0032" or "info_portraits_sc_0032"
    tt.melee.attacks[1].cooldown = 1 + fts(14)
    tt.melee.attacks[1].damage_max = 40
    tt.melee.attacks[1].damage_min = 20
    tt.melee.attacks[1].hit_time = fts(9)
    tt.melee.attacks[1].sound = "WolfAttack"
    tt.motion.max_speed = 2 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_whitewolf"
    tt.sound_events.death = "DeathPuff"
    tt.sound_events.death_by_explosion = "DeathPuff"
    tt.ui.click_rect.size.x = 32
    tt.ui.click_rect.pos.x = -16
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 13)
    tt.unit.mod_offset = vec_2(adx(32), ady(32))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_SKELETON)
    tt = RT("enemy_yeti", "enemy")

    AC(tt, "melee")

    anchor_y = 0.19
    anchor_x = 0.5
    image_y = 80
    image_x = 100
    tt.enemy.gold = 120
    tt.enemy.lives_cost = 5
    tt.enemy.melee_slot = vec_2(25, 0)
    tt.health.hp_max = 2200
    tt.health_bar.offset = vec_2(0, 56)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.i18n_key = "ENEMY_YETI"
    tt.info.enc_icon = 20
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0033" or "info_portraits_sc_0033"
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 2.5
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].damage_max = 150
    tt.melee.attacks[1].damage_min = 50
    tt.melee.attacks[1].damage_radius = 50
    tt.melee.attacks[1].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[1].hit_decal = "decal_ground_hit"
    tt.melee.attacks[1].hit_fx = "fx_ground_hit"
    tt.melee.attacks[1].hit_offset = vec_2(30, 0)
    tt.melee.attacks[1].hit_time = fts(13)
    tt.melee.attacks[1].sound = "AreaAttack"
    tt.melee.attacks[1].sound_args = {
        delay = fts(13)
    }
    tt.motion.max_speed = 0.8 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_yeti"
    tt.sound_events.death = "DeathBig"
    tt.ui.click_rect.size = vec_2(50, 50)
    tt.ui.click_rect.pos.x = -25
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 24)
    tt.unit.mod_offset = vec_2(adx(47), ady(35))
    tt.unit.size = UNIT_SIZE_LARGE
    tt = RT("enemy_forest_troll", "enemy")

    AC(tt, "melee", "auras")

    anchor_y = 0.21
    anchor_x = 0.5
    image_y = 100
    image_x = 156
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "aura_forest_troll_regen"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 200
    tt.enemy.lives_cost = 5
    tt.enemy.melee_slot = vec_2(35, 0)
    tt.health.hp_max = 4000
    tt.health_bar.offset = vec_2(0, 76)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.i18n_key = "ENEMY_FOREST_TROLL"
    tt.info.enc_icon = 39
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0062" or "info_portraits_sc_0060"
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 2.5
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].damage_max = 150
    tt.melee.attacks[1].damage_min = 50
    tt.melee.attacks[1].damage_radius = 50
    tt.melee.attacks[1].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[1].hit_decal = "decal_ground_hit"
    tt.melee.attacks[1].hit_fx = "fx_ground_hit"
    tt.melee.attacks[1].hit_offset = vec_2(30, 0)
    tt.melee.attacks[1].hit_time = fts(15)
    tt.melee.attacks[1].sound = "AreaAttack"
    tt.melee.attacks[1].sound_args = {
        delay = fts(15)
    }
    tt.motion.max_speed = 0.6 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_forest_troll"
    tt.sound_events.death = "DeathBig"
    tt.ui.click_rect.size = vec_2(58, 55)
    tt.ui.click_rect.pos = vec_2(-30, 3)
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 30)
    tt.unit.marker_offset = vec_2(1, 2)
    tt.unit.mod_offset = vec_2(adx(78), ady(45))
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_THORN, F_POISON, F_STUN, F_FREEZE)
    tt = RT("enemy_orc_armored", "enemy")

    AC(tt, "melee")

    anchor_y = 0.14
    anchor_x = 0.5
    image_y = 48
    image_x = 70
    tt.enemy.gold = 30
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.armor = 0.8
    tt.health.hp_max = 400
    tt.health_bar.offset = vec_2(0, 36)
    tt.info.i18n_key = "ENEMY_ORC_ARMORED"
    tt.info.enc_icon = 36
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0060" or "info_portraits_sc_0059"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 40
    tt.melee.attacks[1].damage_min = 20
    tt.melee.attacks[1].hit_time = fts(6)
    tt.motion.max_speed = 0.8 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_orc_armored"
    tt.sound_events.death = "DeathOrc"
    tt.ui.click_rect.size.y = 28
    tt.ui.click_rect.pos.y = 3
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset.y = 2
    tt.unit.mod_offset = vec_2(adx(34), ady(21))
    tt.accelerated = false
    tt.health.on_damage = function(this, store, damage)
        if this.health.hp <= this.health.hp_max * 0.5 and not this.accelerated then
            this.motion.max_speed = 1.0 * FPS
            this.melee.attacks[1].mod = "mod_orc_blood"
            this.accelerated = true
        end
        return true
    end
    tt = RT("mod_orc_blood", "mod_blood")
    tt.dps.damage_max = 5
    tt.dps.damage_min = 5
    tt.dps.damage_every = 0.5
    tt = RT("enemy_orc_armored_mad", "enemy_orc_armored")
    tt.motion.max_speed = 1.1 * FPS
    tt.melee.attacks[1].mod = "mod_orc_blood"
    tt.strengthened = false
    tt.health.on_damage = function(this, store, damage)
        if this.health.hp <= this.health.hp_max * 0.5 and not this.strengthened then
            this.motion.max_speed = 0.6 * FPS
            this.health.damage_factor = 0.3
            this.strengthened = true
        end
        return true
    end

    tt = RT("enemy_orc_rider", "enemy")
    AC(tt, "melee", "death_spawns")
    anchor_y = 0.14
    anchor_x = 0.5
    image_y = 62
    image_x = 62
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.name = "enemy_orc_armored_mad"
    tt.enemy.gold = 25
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(30, 0)
    tt.health.hp_max = 400
    tt.health.magic_armor = 0.8
    tt.health_bar.offset = vec_2(0, 48)
    tt.info.i18n_key = "ENEMY_ORC_RIDER"
    tt.info.enc_icon = 37
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0060" or "info_portraits_sc_0059"
    tt.melee.attacks[1].cooldown = 1 + fts(14)
    tt.melee.attacks[1].damage_max = 40
    tt.melee.attacks[1].damage_min = 20
    tt.melee.attacks[1].hit_time = fts(9)
    tt.melee.attacks[1].sound = "WolfAttack"
    tt.motion.max_speed = 1.4 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_orc_rider"
    tt.sound_events.death = "DeathPuff"
    tt.ui.click_rect.size = vec_2(32, 38)
    tt.ui.click_rect.pos = vec_2(-16, 2)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 23)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(adx(31), ady(29))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_SKELETON)

    tt = RT("enemy_troll_axe_thrower", "enemy")
    AC(tt, "melee", "ranged", "auras")
    anchor_y = 0.2
    anchor_x = 0.5
    image_y = 50
    image_x = 60
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].cooldown = 0
    tt.auras.list[1].name = "aura_troll_axe_thrower_regen"
    tt.enemy.gold = 50
    tt.enemy.lives_cost = 3
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 750
    tt.health_bar.offset = vec_2(0, 43)
    tt.info.i18n_key = "ENEMY_TROLL_AXE_THROWER"
    tt.info.enc_icon = 18
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0030" or "info_portraits_sc_0030"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 50
    tt.melee.attacks[1].damage_min = 30
    tt.melee.attacks[1].hit_time = fts(8)
    tt.motion.max_speed = 0.8 * FPS
    tt.ranged.attacks[1].bullet = "axe_troll_axe_thrower"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(4, 15)}
    tt.ranged.attacks[1].cooldown = 1 + fts(15)
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].max_range = 145
    tt.ranged.attacks[1].min_range = 55
    tt.ranged.attacks[1].shoot_time = fts(7)
    tt.ranged.attacks[1].requires_magic = true
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_troll_axe_thrower"
    tt.sound_events.death = "DeathTroll"
    tt.ui.click_rect.size = vec_2(30, 40)
    tt.ui.click_rect.pos.x = -15
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(adx(29), ady(21))
    tt.unit.size = UNIT_SIZE_MEDIUM

    tt = RT("enemy_raider", "enemy")
    AC(tt, "melee", "ranged")
    anchor_y = 0.23
    anchor_x = 0.5
    image_y = 68
    image_x = 88
    tt.enemy.gold = 50
    tt.enemy.melee_slot = vec_2(23, 0)
    tt.health.armor = 0.95
    tt.health.hp_max = 1250
    tt.health_bar.offset = vec_2(0, 49)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.i18n_key = "ENEMY_RAIDER"
    tt.info.enc_icon = 46
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0070" or "info_portraits_sc_0070"
    tt.melee.attacks[1].cooldown = 3
    tt.melee.attacks[1].damage_max = 80
    tt.melee.attacks[1].damage_min = 40
    tt.melee.attacks[1].hit_time = fts(6)
    tt.ranged.attacks[1].bullet = "ball_raider"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(0, 24)}
    tt.ranged.attacks[1].cooldown = 1.5 + fts(15)
    tt.ranged.attacks[1].hold_advance = false
    tt.ranged.attacks[1].max_range = 165
    tt.ranged.attacks[1].min_range = 55
    tt.ranged.attacks[1].shoot_time = fts(15)
    tt.ranged.attacks[1].requires_magic = true
    tt.motion.max_speed = 0.8 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_raider"
    tt.sound_events.death = "DeathHuman"
    tt.ui.click_rect.size = vec_2(32, 44)
    tt.ui.click_rect.pos.x = -16
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 20)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(adx(43), ady(34))
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt = RT("enemy_pillager", "enemy")

    AC(tt, "melee")

    anchor_y = 0.23
    anchor_x = 0.5
    image_y = 118
    image_x = 154
    tt.enemy.gold = 100
    tt.enemy.lives_cost = 5
    tt.enemy.melee_slot = vec_2(33, 0)
    tt.health.hp_max = 2800
    tt.health.magic_armor = 0.9
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.health_bar.offset = vec_2(0, 61)
    tt.info.i18n_key = "ENEMY_PILLAGER"
    tt.info.enc_icon = 47
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0071" or "info_portraits_sc_0071"
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].damage_max = 80
    tt.melee.attacks[1].damage_min = 40
    tt.melee.attacks[1].damage_radius = 50
    tt.melee.attacks[1].damage_type = DAMAGE_MAGICAL
    tt.melee.attacks[1].hit_offset = vec_2(30, 0)
    tt.melee.attacks[1].hit_time = fts(14)
    tt.motion.max_speed = 0.7 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_pillager"
    tt.sound_events.death = "DeathBig"
    tt.ui.click_rect.size = vec_2(44, 58)
    tt.ui.click_rect.pos.x = -22
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 30)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(adx(75), ady(47))
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt = RT("enemy_troll_brute", "enemy")

    AC(tt, "melee", "auras")

    anchor_y = 0.2125
    anchor_x = 0.5
    image_y = 80
    image_x = 104
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "aura_troll_brute_regen"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 160
    tt.enemy.lives_cost = 3
    tt.enemy.melee_slot = vec_2(35, 0)
    tt.health.armor = 0.6
    tt.health.hp_max = 2800
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.health_bar.offset = vec_2(0, 54)
    tt.info.i18n_key = "ENEMY_TROLL_BRUTE"
    tt.info.enc_icon = 51
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0074" or "info_portraits_sc_0074"
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].count = 3
    tt.melee.attacks[1].damage_max = 165
    tt.melee.attacks[1].damage_min = 95
    tt.melee.attacks[1].damage_radius = 44
    tt.melee.attacks[1].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[1].hit_decal = "decal_ground_hit"
    tt.melee.attacks[1].hit_fx = "fx_ground_hit"
    tt.melee.attacks[1].hit_offset = vec_2(30, 0)
    tt.melee.attacks[1].hit_time = fts(15)
    tt.melee.attacks[1].sound_hit = "AreaAttack"
    tt.motion.max_speed = 0.6 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_troll_brute"
    tt.sound_events.death = "DeathBig"
    tt.ui.click_rect.size = vec_2(30, 40)
    tt.ui.click_rect.pos.x = -15
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 14)
    tt.unit.size = UNIT_SIZE_MEDIUM

    tt = RT("enemy_troll_chieftain", "enemy")
    AC(tt, "melee", "auras", "timed_attacks")
    anchor_y = 0.2
    anchor_x = 0.5
    image_y = 58
    image_x = 78
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "aura_troll_chieftain_regen"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 75
    tt.enemy.lives_cost = 6
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 1200
    tt.health_bar.offset = vec_2(0, 46)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.i18n_key = "ENEMY_TROLL_CHIEFTAIN"
    tt.info.enc_icon = 19
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0031" or "info_portraits_sc_0031"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_troll_chieftain.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 30
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(16)
    tt.timed_attacks.list[1] = E:clone_c("mod_attack")
    tt.timed_attacks.list[1].animation = "special"
    tt.timed_attacks.list[1].cooldown = 6
    tt.timed_attacks.list[1].cast_sound = "EnemyChieftain"
    tt.timed_attacks.list[1].cast_time = fts(8)
    tt.timed_attacks.list[1].loops = 3
    tt.timed_attacks.list[1].max_count = 3
    tt.timed_attacks.list[1].max_range = 180
    tt.timed_attacks.list[1].mods = {"mod_troll_rage", "mod_troll_heal"}
    tt.timed_attacks.list[1].exclude_with_mods = {"mod_troll_rage"}
    tt.timed_attacks.list[1].allowed_templates = {"enemy_troll", "enemy_troll_axe_thrower", "enemy_troll_skater",
                                                  "enemy_troll_chieftain", "enemy_troll_brute"}
    tt.timed_attacks.list[1].vis_flags = bor(F_MOD)
    tt.motion.max_speed = 0.6 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_troll_chieftain"
    tt.sound_events.death = "DeathBig"
    tt.ui.click_rect.size = vec_2(32, 40)
    tt.ui.click_rect.pos.x = -16
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 20)
    tt.unit.mod_offset = vec_2(adx(37), ady(18))
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt = RT("enemy_golem_head", "enemy")

    AC(tt, "melee")

    anchor_y = 0.20588235294117646
    anchor_x = 0.5
    image_y = 34
    image_x = 40
    tt.enemy.gold = 10
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.health.hp_max = 90
    tt.health.armor = 0.5
    tt.health_bar.offset = vec_2(0, 23)
    tt.info.i18n_key = "ENEMY_GOLEM_HEAD"
    tt.info.enc_icon = 15
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0028" or "info_portraits_sc_0028"
    tt.melee.attacks[1].cooldown = 1 + fts(20)
    tt.melee.attacks[1].damage_max = 20
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(8)
    tt.motion.max_speed = 0.7 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_golem_head"
    tt.sound_events.death = "DeathPuff"
    tt.unit.blood_color = BLOOD_GRAY
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 8)
    tt.unit.mod_offset = vec_2(adx(22), ady(15))
    tt.unit.show_blood_pool = false

    tt = RT("enemy_goblin_zapper", "enemy")
    AC(tt, "melee", "ranged", "death_spawns")
    anchor_y = 0.22
    anchor_x = 0.5
    image_y = 58
    image_x = 52
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.name = "aura_goblin_zapper_death"
    tt.unit.explode_when_silenced_death = true
    tt.death_spawns.delay = 0.11
    tt.enemy.gold = 10
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 140
    tt.health_bar.offset = vec_2(0, 34)
    tt.info.i18n_key = "ENEMY_GOBLIN_ZAPPER"
    tt.info.enc_icon = 38
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0061" or "info_portraits_sc_0061"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 20
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(8)
    tt.motion.max_speed = 1.2 * FPS
    tt.ranged.attacks[1].bullet = "bomb_goblin_zapper"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(4, 12.5)}
    tt.ranged.attacks[1].cooldown = 1 + fts(12)
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].ignore_hit_offset = true
    tt.ranged.attacks[1].max_range = 165
    tt.ranged.attacks[1].min_range = 60
    tt.ranged.attacks[1].shoot_time = fts(7)
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_goblin_zapper"
    tt.sound_events.death = "BombExplosionSound"
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 13)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(adx(26), ady(22))
    tt.unit.show_blood_pool = false

    tt = RT("enemy_demon", "enemy")
    AC(tt, "melee", "death_spawns")
    anchor_y = 0.2
    anchor_x = 0.5
    image_y = 38
    image_x = 44
    tt.death_spawns.concurrent_with_death = true
    tt.unit.disintegrate_when_silenced_death = true
    tt.death_spawns.name = "aura_demon_death"
    tt.death_spawns.delay = 0.11
    tt.enemy.gold = 20
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 250
    tt.health.magic_armor = 0.6
    tt.health_bar.offset = vec_2(0, 29)
    tt.info.i18n_key = "ENEMY_DEMON"
    tt.info.enc_icon = 23
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0048" or "info_portraits_sc_0048"
    tt.main_script.insert = scripts.enemy_base_portal.insert
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 30
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(7)
    tt.motion.max_speed = 0.8 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_demon"
    tt.sound_events.death = "DeathPuff"
    tt.unit.blood_color = BLOOD_RED
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.mod_offset = vec_2(adx(22), ady(19))
    tt.unit.show_blood_pool = false
    tt.is_demon = true

    tt = RT("enemy_demon_mage", "enemy")
    AC(tt, "melee", "death_spawns", "timed_attacks")
    anchor_y = 0.15
    anchor_x = 0.5
    image_y = 56
    image_x = 58
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.name = "aura_demon_mage_death"
    tt.unit.disintegrate_when_silenced_death = true
    tt.death_spawns.delay = 0.11
    tt.enemy.gold = 60
    tt.enemy.lives_cost = 5
    tt.enemy.melee_slot = vec_2(24, 0)
    tt.health.hp_max = 1000
    tt.health.magic_armor = 0.6
    tt.health_bar.offset = vec_2(0, 43)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.i18n_key = "ENEMY_DEMON_MAGE"
    tt.info.enc_icon = 24
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0049" or "info_portraits_sc_0049"
    tt.main_script.insert = scripts.enemy_base_portal.insert
    tt.main_script.update = scripts.enemy_demon_mage.update
    tt.melee.attacks[1].cooldown = 1 + fts(20)
    tt.melee.attacks[1].damage_max = 75
    tt.melee.attacks[1].damage_min = 15
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 0.6 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_demon_mage"
    tt.sound_events.death = "DeathPuff"
    tt.timed_attacks.list[1] = E:clone_c("mod_attack")
    tt.timed_attacks.list[1].animation = "special"
    tt.timed_attacks.list[1].cast_time = fts(15)
    tt.timed_attacks.list[1].cooldown = 6
    tt.timed_attacks.list[1].max_count = 4
    tt.timed_attacks.list[1].max_range = 180
    tt.timed_attacks.list[1].mod = "mod_demon_shield"
    tt.timed_attacks.list[1].sound = "EnemyHealing"
    tt.timed_attacks.list[1].vis_flags = bor(F_MOD)
    tt.timed_attacks.list[1].allowed_templates = {"enemy_demon", "enemy_demon_cerberus", "enemy_demon_flareon",
                                                  "enemy_demon_gulaemon", "enemy_demon_legion", "enemy_demon_wolf"}
    tt.ui.click_rect.size = vec_2(32, 40)
    tt.ui.click_rect.pos.x = -16
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 20)
    tt.unit.mod_offset = vec_2(adx(30), ady(20))
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.is_demon = true

    tt = RT("enemy_demon_wolf", "enemy")
    AC(tt, "melee", "death_spawns", "dodge")
    anchor_y = 0.15
    anchor_x = 0.5
    image_y = 40
    image_x = 58
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.name = "aura_demon_wolf_death"
    tt.unit.disintegrate_when_silenced_death = true
    tt.death_spawns.delay = 0.11
    tt.dodge.chance = 0.5
    tt.dodge.silent = true
    tt.enemy.gold = 25
    tt.enemy.melee_slot = vec_2(24, 0)
    tt.health.hp_max = 350
    tt.health.magic_armor = 0.6
    tt.health_bar.offset = vec_2(0, 31)
    tt.info.i18n_key = "ENEMY_DEMON_WOLF"
    tt.info.enc_icon = 25
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0050" or "info_portraits_sc_0050"
    tt.main_script.insert = scripts.enemy_base_portal.insert
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 40
    tt.melee.attacks[1].damage_min = 20
    tt.melee.attacks[1].hit_time = fts(9)
    tt.melee.attacks[1].sound = "WolfAttack"
    tt.motion.max_speed = 1.5 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_demon_wolf"
    tt.sound_events.death = "DeathPuff"
    tt.sound_events.death_by_explosion = "DeathPuff"
    tt.ui.click_rect.size.x = 32
    tt.ui.click_rect.pos = vec_2(-16, 0.5)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 13)
    tt.unit.mod_offset = vec_2(adx(30), ady(20))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_SKELETON)
    tt.is_demon = true
    tt = RT("enemy_demon_imp", "enemy")
    anchor_y = 0
    anchor_x = 0.5
    image_y = 96
    image_x = 78
    tt.enemy.gold = 25
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 350
    tt.health_bar.offset = vec_2(0, 72)
    tt.info.i18n_key = "ENEMY_DEMON_IMP"
    tt.info.enc_icon = 26
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0051" or "info_portraits_sc_0051"
    tt.main_script.insert = scripts.enemy_base_portal.insert
    tt.main_script.update = scripts.enemy_passive.update
    tt.motion.max_speed = 1 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_demon_imp"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].offset = vec_2(0, 0)
    tt.sound_events.death = "DeathPuff"
    tt.ui.click_rect = r(-14, 35, 30, 32)
    tt.unit.can_explode = false
    tt.unit.can_disintegrate = true
    tt.unit.disintegrate_fx = "fx_enemy_desintegrate_air"
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 58)
    tt.unit.mod_offset = vec_2(adx(38), ady(50))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_BLOCK, F_THORN, F_SKELETON)
    tt.vis.flags = bor(F_ENEMY, F_FLYING)
    tt.is_demon = true
    tt = RT("enemy_lava_elemental", "enemy")

    AC(tt, "melee")

    anchor_y = 0.19
    anchor_x = 0.5
    image_y = 84
    image_x = 108
    tt.enemy.gold = 100
    tt.enemy.lives_cost = 5
    tt.enemy.melee_slot = vec_2(25, 0)
    tt.health.hp_max = 2500
    tt.health.armor = 0.4
    tt.health.magic_armor = 0.2
    tt.health.damage_factor_electrical = 0.6
    tt.health_bar.offset = vec_2(0, 62)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0055" or "info_portraits_sc_0055"
    tt.info.i18n_key = "ENEMY_LAVA_ELEMENTAL"
    tt.info.enc_icon = 30
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 2.5
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].damage_max = 150
    tt.melee.attacks[1].damage_min = 50
    tt.melee.attacks[1].damage_radius = 50
    tt.melee.attacks[1].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[1].hit_decal = "decal_ground_hit"
    tt.melee.attacks[1].hit_fx = "fx_ground_hit"
    tt.melee.attacks[1].hit_offset = vec_2(30, 0)
    tt.melee.attacks[1].hit_time = fts(15)
    tt.melee.attacks[1].sound_hit = "AreaAttack"
    tt.motion.max_speed = 0.5 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_lava_elemental"
    tt.sound_events.death = "RockElementalDeath"
    tt.ui.click_rect.size = vec_2(50, 56)
    tt.ui.click_rect.pos.x = -25
    tt.unit.blood_color = BLOOD_GRAY
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 24)
    tt.unit.mod_offset = vec_2(adx(53), ady(38))
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_POISON, F_BURN)

    tt = RT("enemy_sarelgaz_small", "enemy")
    AC(tt, "melee")
    anchor_y = 0.19
    anchor_x = 0.5
    image_y = 68
    image_x = 96
    tt.enemy.gold = 80
    tt.enemy.melee_slot = vec_2(35, 0)
    tt.health.armor = 0.65
    tt.health.hp_max = 1500
    tt.health.magic_armor = 0.65
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.health_bar.offset = vec_2(0, 51)
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0058" or "info_portraits_sc_0058"
    tt.info.i18n_key = "ENEMY_SARELGAZ_SMALL"
    tt.info.enc_icon = 31
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 100
    tt.melee.attacks[1].damage_min = 50
    tt.melee.attacks[1].hit_time = fts(11)
    tt.melee.attacks[1].sound = "SpiderAttack"
    tt.motion.max_speed = 0.8 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.19)
    tt.render.sprites[1].prefix = "enemy_sarelgaz_small"
    tt.sound_events.death = "DeathEplosion"
    tt.ui.click_rect.size = vec_2(54, 50)
    tt.ui.click_rect.pos.x = -27
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 23)
    tt.unit.mod_offset = vec_2(adx(45), ady(35))
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_POISON, F_SKELETON)

    tt = RT("enemy_rotten_lesser", "enemy")

    AC(tt, "melee", "death_spawns")

    anchor_y = 0.21621621621621623
    anchor_x = 0.5
    image_y = 74
    image_x = 90
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.name = "aura_rotten_lesser_death"
    tt.unit.disintegrate_when_silenced_death = true
    tt.enemy.gold = 20
    tt.enemy.melee_slot = vec_2(26, 0)
    tt.health.hp_max = 500
    tt.info.i18n_key = "ENEMY_ROTTEN_LESSER"
    tt.info.enc_icon = 58
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0081" or "info_portraits_sc_0081"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 18
    tt.melee.attacks[1].damage_min = 12
    tt.melee.attacks[1].hit_time = fts(9)
    tt.motion.max_speed = 1 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.21621621621621623)
    tt.render.sprites[1].prefix = "enemy_rotten_lesser"
    tt.sound_events.death = "EnemyMushroomDeath"
    tt.ui.click_rect = r(-15, -5, 30, 30)
    tt.unit.blood_color = BLOOD_VIOLET
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 16)
    tt.unit.show_blood_pool = false

    tt = RT("enemy_swamp_thing", "enemy")
    AC(tt, "melee", "ranged", "auras")
    anchor_y = 0.24
    anchor_x = 0.5
    image_y = 87
    image_x = 108
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "aura_swamp_thing_regen"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 200
    tt.enemy.lives_cost = 5
    tt.enemy.melee_slot = vec_2(40, 0)
    tt.health.hp_max = 3000
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.health_bar.offset = vec_2(0, 69)
    tt.info.i18n_key = "ENEMY_SWAMP_THING"
    tt.info.enc_icon = 44
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0068" or "info_portraits_sc_0068"
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 2.5
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].damage_max = 100
    tt.melee.attacks[1].damage_min = 40
    tt.melee.attacks[1].damage_radius = 50
    tt.melee.attacks[1].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[1].hit_decal = "decal_ground_hit"
    tt.melee.attacks[1].hit_fx = "fx_ground_hit"
    tt.melee.attacks[1].hit_offset = vec_2(30, 0)
    tt.melee.attacks[1].hit_time = fts(15)
    tt.melee.attacks[1].sound_hit = "AreaAttack"
    tt.motion.max_speed = 0.6 * FPS
    tt.ranged.attacks[1].bullet = "bomb_swamp_thing"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(adx(66), ady(86))}
    tt.ranged.attacks[1].cooldown = 1 + fts(32)
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].ignore_hit_offset = true
    tt.ranged.attacks[1].max_range = 165
    tt.ranged.attacks[1].min_range = 110
    tt.ranged.attacks[1].shoot_time = fts(13)
    tt.ranged.attacks[1].requires_magic = true
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_swamp_thing"
    tt.sound_events.death = "DeathBig"
    tt.ui.click_rect.size = vec_2(50, 54)
    tt.ui.click_rect.pos.x = -25
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 30)
    tt.unit.mod_offset = vec_2(0, 24)
    tt.unit.size = UNIT_SIZE_LARGE

    tt = RT("enemy_spider_rotten", "enemy")
    AC(tt, "melee", "timed_attacks")
    anchor_y = 0.20967741935483872
    anchor_x = 0.5
    image_y = 62
    image_x = 82
    tt.enemy.gold = 40
    tt.enemy.lives_cost = 3
    tt.enemy.melee_slot = vec_2(34, 0)
    tt.health.hp_max = 1000
    tt.health.magic_armor = 0.6
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.health_bar.offset = vec_2(0, 47)
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0065" or "info_portraits_sc_0065"
    tt.info.i18n_key = "ENEMY_SPIDER_ROTTEN"
    tt.info.enc_icon = 42
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_spider_big.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 40
    tt.melee.attacks[1].damage_min = 20
    tt.melee.attacks[1].hit_time = fts(12)
    tt.melee.attacks[1].sound_hit = "SpiderAttack"
    tt.motion.max_speed = 0.6 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_spider_rotten"
    tt.sound_events.death = "DeathEplosion"
    tt.timed_attacks.list[1] = E:clone_c("bullet_attack")
    tt.timed_attacks.list[1].bullet = "enemy_spider_rotten_egg"
    tt.timed_attacks.list[1].max_cooldown = 10
    tt.timed_attacks.list[1].max_count = 6
    tt.timed_attacks.list[1].min_cooldown = 5
    tt.ui.click_rect.size = vec_2(44, 40)
    tt.ui.click_rect.pos = vec_2(-22, -1)
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.explode_fx = "fx_spider_explode"
    tt.unit.hit_offset = vec_2(0, 15)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(adx(40), ady(28))
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_POISON, F_SKELETON)

    tt = RT("enemy_spider_rotten_tiny", "enemy")
    AC(tt, "melee")
    anchor_y = 0.1875
    anchor_x = 0.5
    image_y = 32
    image_x = 42
    tt.enemy.gold = 0
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.health.hp_max = 100
    tt.health.magic_armor = 0.25
    tt.health_bar.offset = vec_2(0, 20)
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0066" or "info_portraits_sc_0066"
    tt.info.i18n_key = "ENEMY_SPIDERTINY_ROTTEN"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 20
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(12)
    tt.melee.attacks[1].sound_hit = "SpiderAttack"
    tt.motion.max_speed = 1.0 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_spider_rotten_tiny"
    tt.sound_events.death = "DeathEplosionShortA"
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.explode_fx = "fx_spider_explode"
    tt.unit.hit_offset = vec_2(0, 12)
    tt.unit.marker_offset = vec_2(0, ady(5))
    tt.unit.mod_offset = vec_2(adx(1), ady(14))
    tt.unit.mod_offset = vec_2(adx(18), ady(13))
    tt.vis.bans = bor(F_POISON, F_SKELETON)

    tt = RT("enemy_rotten_tree", "enemy")
    AC(tt, "melee")
    anchor_y = 0.18421052631578946
    anchor_x = 0.5
    image_y = 76
    image_x = 82
    tt.enemy.gold = 60
    tt.enemy.melee_slot = vec_2(25, 0)
    tt.health.armor = 0.8
    tt.health.hp_max = 1000
    tt.health_bar.offset = vec_2(0, 57)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.i18n_key = "ENEMY_ROTTEN_TREE"
    tt.info.enc_icon = 43
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0067" or "info_portraits_sc_0067"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 40
    tt.melee.attacks[1].damage_min = 20
    tt.melee.attacks[1].hit_time = fts(11)
    tt.motion.max_speed = 0.6 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_rotten_tree"
    tt.sound_events.death = "DeathSkeleton"
    tt.ui.click_rect.size = vec_2(44, 40)
    tt.ui.click_rect.pos = vec_2(-22, -1)
    tt.unit.blood_color = BLOOD_GRAY
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 16)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 16)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.unit.show_blood_pool = false

    tt = RT("enemy_giant_rat", "enemy")
    AC(tt, "melee")
    anchor_y = 0.275
    anchor_x = 0.5
    image_y = 40
    image_x = 64
    tt.enemy.gold = 10
    tt.enemy.melee_slot = vec_2(26, 0)
    tt.health.hp_max = 100
    tt.health_bar.offset = vec_2(0, 26)
    tt.info.i18n_key = "ENEMY_GIANT_RAT"
    tt.info.enc_icon = 61
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0084" or "info_portraits_sc_0084"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 12
    tt.melee.attacks[1].damage_min = 8
    tt.melee.attacks[1].hit_time = fts(11)
    tt.melee.attacks[1].mod = "mod_poison_giant_rat"
    tt.melee.attacks[1].sound_hit = "EnemyBlackburnGiantRat"
    tt.melee.attacks[1].sound_hit_args = {
        chance = 0.1
    }
    tt.motion.max_speed = 1.3950892857142858 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_giant_rat"
    tt.sound_events.death = nil
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 13)
    tt.vis.bans = F_SKELETON

    tt = RT("enemy_wererat", "enemy")
    AC(tt, "melee")
    anchor_y = 0.17647058823529413
    anchor_x = 0.5
    image_y = 68
    image_x = 94
    tt.enemy.gold = 25
    tt.enemy.melee_slot = vec_2(26, 0)
    tt.health.armor = 0.2
    tt.health.magic_armor = 0.2
    tt.health.hp_max = 450
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.health_bar.offset = vec_2(0, 47)
    tt.info.i18n_key = "ENEMY_WERERAT"
    tt.info.enc_icon = 62
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0085" or "info_portraits_sc_0085"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 35
    tt.melee.attacks[1].damage_min = 25
    tt.melee.attacks[1].hit_time = fts(10)
    tt.melee.attacks[1].mod = "mod_wererat_poison"
    tt.motion.max_speed = 1.6622340425531914 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_wererat"
    tt.sound_events.death = nil
    tt.ui.click_rect.size = vec_2(32, 40)
    tt.ui.click_rect.pos = vec_2(-16, -1)
    tt.unit.hit_offset = vec_2(0, 20)
    tt.unit.marker_offset = vec_2(0, 2)
    tt.unit.mod_offset = vec_2(0, 22)
    tt.unit.size = UNIT_SIZE_MEDIUM

    tt = RT("enemy_skeleton", "enemy")
    AC(tt, "melee")
    anchor_y = 0.2
    anchor_x = 0.5
    image_y = 38
    image_x = 50
    tt.enemy.gold = 2
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 120
    tt.health_bar.offset = vec_2(0, 30)
    tt.info.i18n_key = "ENEMY_SKELETON"
    tt.info.enc_icon = 27
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0052" or "info_portraits_sc_0052"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 20
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 0.6 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_skeleton"
    tt.sound_events.death = "DeathSkeleton"
    tt.unit.blood_color = BLOOD_GRAY
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.mod_offset = vec_2(adx(25), ady(17))
    tt.vis.bans = bor(F_SKELETON, F_POISON, F_POLYMORPH, F_BLOOD)
    tt.unit.show_blood_pool = false

    tt = RT("enemy_skeleton_big", "enemy")
    AC(tt, "melee", "auras")
    anchor_y = 0.2
    anchor_x = 0.5
    image_y = 50
    image_x = 58
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "aura_skeleton_big"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 10
    tt.enemy.melee_slot = vec_2(23, 0)
    tt.health.armor = 0.3
    tt.health.hp_max = 400
    tt.health_bar.offset = vec_2(0, 39)
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0053" or "info_portraits_sc_0053"
    tt.info.i18n_key = "ENEMY_SKELETON_BIG"
    tt.info.enc_icon = 28
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 40
    tt.melee.attacks[1].damage_min = 20
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 0.6 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_skeleton_big"
    tt.sound_events.death = "DeathSkeleton"
    tt.unit.blood_color = BLOOD_GRAY
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.mod_offset = vec_2(adx(30), ady(22))
    tt.vis.bans = bor(F_SKELETON, F_POISON, F_POLYMORPH, F_BLOOD)
    tt.unit.show_blood_pool = false

    tt = RT("aura_skeleton_big", "aura")
    AC(tt, "render", "tween")
    tt.aura.active = false
    tt.aura.allowed_templates = {"enemy_skeleton", "enemy_skeleton_blackburn"}
    tt.aura.cooldown = 0
    tt.aura.delay = fts(30)
    tt.aura.duration = -1
    tt.aura.mod = "mod_skeleton_big"
    tt.aura.requires_magic = true
    tt.aura.radius = 100
    tt.aura.track_source = true
    tt.aura.use_mod_offset = false
    tt.main_script.insert = scripts.aura_apply_mod.insert
    tt.main_script.update = scripts.aura_skeleton_big.update
    tt.render.sprites[1].alpha = 0
    tt.render.sprites[1].anchor = vec_2(0.5, 0.28125)
    tt.render.sprites[1].animated = false
    tt.render.sprites[1].name = "CB_DeathKnight_aura_0001"
    tt.render.sprites[1].offset = vec_2(0, -8)
    tt.render.sprites[1].z = Z_DECALS
    tt.render.sprites[1].scale = vec_2(0.5, 0.5)
    tt.render.sprites[2] = table.deepclone(tt.render.sprites[1])
    tt.render.sprites[2].alpha = 0
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "spectral_knight_aura"
    tt.tween.disabled = true
    tt.tween.props[1].keys = {{0, 0}, {fts(20), 255}}
    tt.tween.props[1].name = "alpha"
    tt.tween.props[2] = table.deepclone(tt.tween.props[1])
    tt.tween.props[2].sprite_id = 2
    tt.tween.remove = false

    tt = RT("mod_skeleton_big", "modifier")
    AC(tt, "render")
    tt.main_script.insert = scripts.mod_skeleton_big.insert
    tt.main_script.remove = scripts.mod_skeleton_big.remove
    tt.main_script.update = scripts.mod_track_target.update
    tt.max_times_applied = 1
    tt.modifier.duration = 1
    tt.modifier.use_mod_offset = false
    tt.modifier.vis_flags = bor(F_MOD)
    tt.render.sprites[1] = CC("sprite")
    tt.render.sprites[1].animated = false
    tt.render.sprites[1].name = "CB_DeathKnight_buffed"
    tt.render.sprites[1].scale = vec_2(0.5, 0.5)
    tt.health_damage_factor_dec = 0.15

    tt = RT("enemy_zombie", "enemy")
    AC(tt, "melee")
    anchor_y = 0.22
    anchor_x = 0.5
    image_y = 48
    image_x = 42
    tt.enemy.gold = 10
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.armor = 0.4
    tt.health.hp_max = 320
    tt.health_bar.offset = vec_2(0, 35)
    tt.info.i18n_key = "ENEMY_ZOMBIE"
    tt.info.enc_icon = 41
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0064" or "info_portraits_sc_0064"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 15
    tt.melee.attacks[1].damage_min = 5
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 0.4 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_zombie"
    tt.render.sprites[1].name = "raise"
    tt.sound_events.death = "DeathSkeleton"
    tt.unit.blood_color = BLOOD_GRAY
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(adx(23), ady(20))
    tt.vis.bans = bor(F_SKELETON, F_POISON, F_POLYMORPH)
    tt.unit.show_blood_pool = false

    tt = RT("enemy_demon_flareon", "enemy")
    AC(tt, "melee", "ranged", "death_spawns")
    anchor_y = 0.16666666666666666
    anchor_x = 0.5
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.name = "aura_flareon_death"
    tt.enemy.gold = 20
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 250
    tt.health.magic_armor = 0.8
    tt.health_bar.offset.y = 34
    tt.info.i18n_key = "ENEMY_DEMON_FLAREON"
    tt.info.enc_icon = 54
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0076" or "info_portraits_sc_0076"
    tt.main_script.insert = scripts.enemy_base_portal.insert
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 25
    tt.melee.attacks[1].damage_min = 15
    tt.melee.attacks[1].hit_time = fts(9)
    tt.motion.max_speed = 1.2 * FPS
    tt.ranged.attacks[1].bullet = "flare_flareon"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(0, 25)}
    tt.ranged.attacks[1].cooldown = 3 + fts(36)
    tt.ranged.attacks[1].hold_advance = false
    tt.ranged.attacks[1].max_range = 150
    tt.ranged.attacks[1].min_range = 50
    tt.ranged.attacks[1].shoot_time = fts(9)
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_demon_flareon"
    tt.render.sprites[1].offset.y = 1
    tt.sound_events.death = "DeathPuff"
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 12)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 12)
    tt.unit.show_blood_pool = false
    tt.unit.disintegrate_when_silenced_death = true
    tt.is_demon = true

    tt = RT("enemy_demon_legion", "enemy")
    AC(tt, "melee", "timed_attacks", "death_spawns")
    image_y = 86
    image_x = 106
    anchor_y = 0.1511627906976744
    anchor_x = 0.5
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.name = "aura_demon_death"
    tt.unit.disintegrate_when_silenced_death = true
    tt.enemy.gold = 60
    tt.enemy.melee_slot = vec_2(23, 0)
    tt.health.armor = 0.8
    tt.health.hp_max = 666
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.health_bar.offset.y = 42
    tt.info.i18n_key = "ENEMY_DEMON_LEGION"
    tt.info.enc_icon = 56
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0077" or "info_portraits_sc_0077"
    tt.main_script.insert = scripts.enemy_base_portal.insert
    tt.main_script.update = scripts.enemy_demon_legion.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 30
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(11)
    tt.melee.attacks[1].damage_type = DAMAGE_TRUE
    tt.motion.max_speed = 0.6 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_demon_legion"
    tt.sound_events.death = "DeathPuff"
    tt.timed_attacks.list[1] = E:clone_c("spawn_attack")
    tt.timed_attacks.list[1].spawn_time = fts(5)
    tt.timed_attacks.list[1].clone_time = fts(31)
    tt.timed_attacks.list[1].generation = 2
    tt.timed_attacks.list[1].animation = "summon"
    tt.timed_attacks.list[1].spawn_animation = "spawn"
    tt.timed_attacks.list[1].entity = "enemy_demon_legion"
    tt.timed_attacks.list[1].cooldown = 15
    tt.timed_attacks.list[1].cooldown_after = 10
    tt.timed_attacks.list[1].spawn_offset_nodes = {5, 10}
    tt.timed_attacks.list[1].nodes_limit = 20
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 12)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 12)
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.is_demon = true
    tt = RT("enemy_demon_gulaemon", "enemy")

    AC(tt, "melee", "timed_actions", "death_spawns")

    anchor_y = 0.21296296296296297
    anchor_x = 0.5
    image_y = 108
    image_x = 108
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.name = "aura_gulaemon_death"
    tt.unit.disintegrate_when_silenced_death = true
    tt.enemy.gold = 80
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(28, 0)
    tt.health.hp_max = 2500
    tt.health.magic_armor = 0.6
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.health_bar.offset.y = 68
    tt.info.i18n_key = "ENEMY_DEMON_GULAEMON"
    tt.info.enc_icon = 53
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0078" or "info_portraits_sc_0078"
    tt.main_script.insert = scripts.enemy_base_portal.insert
    tt.main_script.update = scripts.enemy_demon_gulaemon.update
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_max = 80
    tt.melee.attacks[1].damage_min = 40
    tt.melee.attacks[1].hit_time = fts(9)
    tt.motion.max_speed = 0.6 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix_ground = "enemy_demon_gulaemon"
    tt.render.sprites[1].prefix_air = "enemy_demon_gulaemon_fly"
    tt.render.sprites[1].prefix = tt.render.sprites[1].prefix_ground
    tt.render.sprites[1].angles.takeoff = {"initFlyRightLeft", "initFlyUp", "initFlyDown"}
    tt.render.sprites[1].angles.land = {"endFlyRightLeft", "endFlyUp", "endFlyDown"}
    tt.render.sprites[2] = CC("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "Inferno_FatDemon_0178"
    tt.render.sprites[2].offset = vec_2(0.5, 30)
    tt.render.sprites[2].z = Z_DECALS
    tt.sound_events.death = "DeathPuff"
    tt.timed_actions.list[1] = CC("mod_attack")
    tt.timed_actions.list[1].cooldown = 15
    tt.timed_actions.list[1].charge_time = fts(3)
    tt.timed_actions.list[1].mod = "mod_gulaemon_fly"
    tt.timed_actions.list[1].nodes_limit_start = 20
    tt.timed_actions.list[1].off_health_bar_y = 17
    tt.timed_actions.list[1].off_click_rect_y = 24
    tt.timed_actions.list[1].off_mod_offset_y = 23
    tt.timed_actions.list[1].off_hit_offset_y = 23
    tt.timed_actions.list[1].flags_air = bor(F_FLYING)
    tt.timed_actions.list[1].bans_air = bor(F_BLOCK, F_THORN)
    tt.ui.click_rect = r(-20, 0, 40, 56)
    tt.unit.can_explode = false
    tt.unit.can_disintegrate = true
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 30)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 20)
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.is_demon = true
    tt = RT("enemy_necromancer", "enemy")

    AC(tt, "melee", "ranged", "timed_actions")

    anchor_y = 0.2
    anchor_x = 0.5
    image_y = 38
    image_x = 44
    tt.enemy.gold = 60
    tt.enemy.lives_cost = 3
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 850
    tt.health.magic_armor = 0.5
    tt.health_bar.offset = vec_2(0, 30)
    tt.info.i18n_key = "ENEMY_NECROMANCER"
    tt.info.enc_icon = 29
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0054" or "info_portraits_sc_0054"
    tt.main_script.update = scripts.enemy_necromancer.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 40
    tt.melee.attacks[1].damage_min = 20
    tt.melee.attacks[1].hit_time = fts(10)
    tt.melee.attacks[1].damage_type = DAMAGE_MAGICAL
    tt.motion.max_speed = 0.5 * FPS
    tt.ranged.attacks[1] = E:clone_c("bullet_attack")
    tt.ranged.attacks[1].bullet = "bolt_necromancer"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(-8, 22)}
    tt.ranged.attacks[1].cooldown = 1 + fts(23)
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].max_range = 145
    tt.ranged.attacks[1].min_range = 60
    tt.ranged.attacks[1].shoot_time = fts(9)
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_necromancer"
    tt.ranged.attacks[1].requires_magic = true
    tt.sound_events.death = "DeathPuff"
    tt.timed_actions.list[1] = E:clone_c("spawn_attack")
    tt.timed_actions.list[1].cooldown = 8
    tt.timed_actions.list[1].spawn_time = fts(12)
    tt.timed_actions.list[1].spawn_delay = fts(4)
    tt.timed_actions.list[1].entity_chances = {0.06, 1}
    tt.timed_actions.list[1].entity_names = {"enemy_skeleton_big", "enemy_skeleton"}
    tt.timed_actions.list[1].animation = "summon"
    tt.timed_actions.list[1].spawn_animation = "raise"
    tt.timed_actions.list[1].max_count = 5
    tt.timed_actions.list[1].count_group_name = "necromancer_skeletons"
    tt.timed_actions.list[1].count_group_type = COUNT_GROUP_CONCURRENT
    tt.timed_actions.list[1].count_group_max = 35
    tt.timed_actions.list[1].summon_offsets = {{2, 0, 0}, {3, 0, 0}, {1, 3, 8}, {2, 3, 8}, {3, 3, 8}, {1, -3, -8},
                                               {2, -3, -8}, {3, -3, -8}}
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 15)
    tt.unit.mod_offset = vec_2(adx(23), ady(17))
    tt = RT("enemy_skeleton_blackburn", "enemy_skeleton")
    tt = RT("enemy_zombie_blackburn", "enemy_halloween_zombie")
    tt = RT("enemy_skeleton_warrior", "enemy_skeleton_big")

    tt = RT("enemy_demon_cerberus", "enemy")
    AC(tt, "melee", "death_spawns")
    anchor_y = 0.14285714285714285
    anchor_x = 0.5
    image_y = 70
    image_x = 128
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.name = "aura_demon_cerberus_death"
    tt.death_spawns.delay = 0.11
    tt.unit.disintegrate_when_silenced_death = true
    tt.enemy.gold = 350
    tt.enemy.lives_cost = 5
    tt.enemy.melee_slot = vec_2(41, 0)
    tt.health.armor = 0.8
    tt.health.hp_max = 6000
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.health_bar.offset = vec_2(0, 57)
    tt.info.i18n_key = "ENEMY_DEMON_CERBERUS"
    tt.info.enc_icon = 55
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0079" or "info_portraits_sc_0079"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_demon_cerberus.update
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 90
    tt.melee.attacks[1].damage_min = 70
    tt.melee.attacks[1].damage_radius = 57.6
    tt.melee.attacks[1].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[1].dodge_time = fts(7)
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].hit_time = fts(11)
    tt.melee.attacks[1].hit_offset = vec_2(20, 0)
    tt.motion.max_speed = 1.3 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_demon_cerberus"
    tt.sound_events.death = "DeathPuff"
    tt.sound_events.death_by_explosion = "DeathPuff"
    tt.ui.click_rect.size = vec_2(45, 43)
    tt.ui.click_rect.pos = vec_2(-22.5, 2)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 25)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 16)
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_STUN, F_TELEPORT, F_THORN, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.is_demon = true

    tt = RT("enemy_witch", "enemy")
    AC(tt, "ranged")
    anchor_y = 0.05319148936170213
    anchor_x = 0.5
    image_y = 94
    image_x = 88
    tt.enemy.gold = 80
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(26, 0)
    tt.health.hp_max = 600
    tt.health.magic_armor = 0.9
    tt.health_bar.offset = vec_2(0, 72)
    tt.info.i18n_key = "ENEMY_WITCH"
    tt.info.enc_icon = 66
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0090" or "info_portraits_sc_0090"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.motion.max_speed = 1.4960106382978726 * FPS
    tt.ranged.attacks[1].bullet = "bolt_witch"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(13, 45)}
    tt.ranged.attacks[1].cooldown = fts(60) + fts(34)
    tt.ranged.attacks[1].requires_magic = true
    tt.ranged.attacks[1].hold_advance = false
    tt.ranged.attacks[1].max_range = 319.1489361702128
    tt.ranged.attacks[1].min_range = 35.46099290780142
    tt.ranged.attacks[1].shoot_time = fts(23)
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_witch"
    tt.sound_events.death = "EnemyBlackburnWitchDeath"
    tt.sound_events.insert = "EnemyBlackburnWitch"
    tt.ui.click_rect = r(-14, 30, 30, 32)
    tt.unit.can_explode = false
    tt.unit.can_disintegrate = true
    tt.unit.disintegrate_fx = "fx_enemy_desintegrate_air"
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 45)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 47)
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_BLOCK, F_THORN)
    tt.vis.flags = bor(F_ENEMY, F_FLYING)

    tt = RT("enemy_spectral_knight", "enemy")
    AC(tt, "melee", "auras")
    image_y = 94
    image_x = 128
    anchor_y = 0.1595744680851064
    anchor_x = 0.5
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].cooldown = 0
    tt.auras.list[1].name = "aura_spectral_knight"
    tt.enemy.gold = 40
    tt.enemy.melee_slot = vec_2(26, 0)
    tt.health.armor = 1
    tt.health.hp_max = 400
    tt.health.immune_to = bor(DAMAGE_PHYSICAL, DAMAGE_EXPLOSION, DAMAGE_ELECTRICAL, DAMAGE_SHOT, DAMAGE_RUDE)
    tt.health_bar.offset = vec_2(0, 61)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.i18n_key = "ENEMY_SPECTRAL_KNIGHT"
    tt.info.enc_icon = 64
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0088" or "info_portraits_sc_0088"
    tt.main_script.insert = scripts.enemy_spectral_knight.insert
    tt.main_script.update = scripts.enemy_spectral_knight.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 76
    tt.melee.attacks[1].damage_min = 24
    tt.melee.attacks[1].hit_time = fts(9)
    tt.motion.max_speed = 0.775709219858156 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_spectral_knight"
    tt.sound_events.death = nil
    tt.sound_events.insert = "CBSpectralKnight"
    tt.sound_events.insert_args = {
        delay = 0.5
    }
    tt.ui.click_rect = r(-20, 0, 40, 45)
    tt.unit.blood_color = BLOOD_NONE
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 20)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 21)
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_THORN)
    tt.vis.flags = bor(F_ENEMY)

    tt = RT("aura_spectral_knight", "aura")
    AC(tt, "render", "tween")
    tt.aura.active = false
    tt.aura.allowed_templates = {"enemy_fallen_knight", "enemy_skeleton", "enemy_skeleton_warrior",
                                 "enemy_skeleton_big", "enemy_skeleton_blackburn"}
    tt.aura.cooldown = 0
    tt.aura.delay = fts(30)
    tt.aura.duration = -1
    tt.aura.mod = "mod_spectral_knight"
    tt.aura.radius = 106.38297872340426
    tt.aura.requires_magic = true
    tt.aura.track_source = true
    tt.aura.use_mod_offset = false
    tt.main_script.insert = scripts.aura_apply_mod.insert
    tt.main_script.update = scripts.aura_spectral_knight.update
    tt.render.sprites[1].alpha = 0
    tt.render.sprites[1].anchor = vec_2(0.5, 0.28125)
    tt.render.sprites[1].animated = false
    tt.render.sprites[1].name = "CB_DeathKnight_aura_0001"
    tt.render.sprites[1].offset = vec_2(0, -16)
    tt.render.sprites[1].z = Z_DECALS
    tt.render.sprites[2] = table.deepclone(tt.render.sprites[1])
    tt.render.sprites[2].alpha = 0
    tt.render.sprites[2].animated = true
    tt.render.sprites[2].name = "spectral_knight_aura"
    tt.tween.disabled = true
    tt.tween.props[1].keys = {{0, 0}, {fts(20), 255}}
    tt.tween.props[1].name = "alpha"
    tt.tween.props[2] = table.deepclone(tt.tween.props[1])
    tt.tween.props[2].sprite_id = 2
    tt.tween.remove = false

    tt = RT("mod_spectral_knight", "modifier")
    AC(tt, "render")
    tt.damage_factor_increase = 1.2
    tt.main_script.insert = scripts.mod_spectral_knight.insert
    tt.main_script.remove = scripts.mod_spectral_knight.remove
    tt.main_script.update = scripts.mod_track_target.update
    tt.max_times_applied = 1
    tt.modifier.duration = 6
    tt.modifier.use_mod_offset = false
    tt.modifier.vis_flags = bor(F_MOD)
    tt.render.sprites[1].name = "mod_spectral_knight_fx"
    tt.render.sprites[1].offset = vec_2(0, 32)
    tt.render.sprites[1].z = Z_DECALS
    tt.render.sprites[1].z = Z_DECALS
    tt.render.sprites[2] = CC("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "CB_DeathKnight_buffed"

    tt = RT("enemy_spectral_knight_spawn", "enemy_spectral_knight")
    tt.enemy.gold = 0

    tt = RT("enemy_fallen_knight", "enemy")
    AC(tt, "melee", "death_spawns")
    anchor_y = 0.1595744680851064
    anchor_x = 0.5
    image_y = 94
    image_x = 128
    tt.death_spawns.name = "enemy_spectral_knight_spawn"
    tt.death_spawns.spawn_animation = "raise"
    tt.death_spawns.delay = fts(11)
    tt.unit.disintegrate_when_silenced_death = true
    tt.enemy.gold = 40
    tt.enemy.melee_slot = vec_2(26, 0)
    tt.health.dead_lifetime = 1
    tt.health.hp_max = 1000
    tt.health.magic_armor = 0.9
    tt.health_bar.offset = vec_2(0, 56)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.i18n_key = "ENEMY_FALLEN_KNIGHT"
    tt.info.enc_icon = 63
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0087" or "info_portraits_sc_0087"
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 76
    tt.melee.attacks[1].damage_min = 24
    tt.melee.attacks[1].hit_time = fts(13)
    tt.motion.max_speed = 0.44326241134751776 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_fallen_knight"
    tt.sound_events.death = nil
    tt.sound_events.death_by_explosion = nil
    tt.ui.click_rect = r(-15, 0, 30, 45)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 20)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 19)
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_MEDIUM

    tt = RT("enemy_troll_skater", "enemy")
    AC(tt, "melee", "auras")
    anchor_y = 0.18
    anchor_x = 0.5
    image_y = 50
    image_x = 82
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "aura_troll_skater_regen"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 30
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 300
    tt.health.armor = 0.15
    tt.info.i18n_key = "ENEMY_TROLL_SKATER"
    tt.info.enc_icon = 50
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0073" or "info_portraits_sc_0073"
    tt.main_script.update = scripts.enemy_troll_skater.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 70
    tt.melee.attacks[1].damage_min = 30
    tt.melee.attacks[1].hit_time = fts(9)
    tt.motion.max_speed = 1.2 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_troll_skater"
    tt.sound_events.death = "DeathTroll"
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 13)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 13)
    tt.skate = {
        mod = "mod_troll_skater",
        vis_bans_extra = bor(F_BLOCK),
        prefix = "enemy_troll",
        walk_angles = {"skateRightLeft", "skateUp", "skateDown"}
    }

    -- unknown
    tt = RT("enemy_hobgoblin", "enemy")
    AC(tt, "melee", "death_spawns")
    anchor_y = 0.17532467532467533
    anchor_x = 0.5
    image_y = 154
    image_x = 224
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.name = "fx_coin_shower"
    tt.death_spawns.offset = vec_2(0, 60)
    tt.enemy.gold = 250
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(40, 0)
    tt.health.hp_max = 2000
    tt.health_bar.offset = vec_2(0, 82)
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.info.i18n_key = "ENEMY_ENDLESS_MINIBOSS_ORC"
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0094" or "info_portraits_sc_0094"
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].damage_max = 90
    tt.melee.attacks[1].damage_min = 40
    tt.melee.attacks[1].damage_radius = 45
    tt.melee.attacks[1].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[1].hit_decal = "decal_hobgoblin_ground_hit"
    tt.melee.attacks[1].hit_fx = "fx_hobgoblin_ground_hit"
    tt.melee.attacks[1].hit_offset = vec_2(72, -9)
    tt.melee.attacks[1].hit_time = fts(24)
    tt.melee.attacks[1].sound = "AreaAttack"
    tt.melee.attacks[1].sound_args = {
        delay = fts(24)
    }
    tt.motion.max_speed = 0.7 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "enemy_hobgoblin"
    tt.sound_events.death = "DeathJuggernaut"
    tt.ui.click_rect = r(-30, 0, 60, 70)
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 34)
    tt.unit.mod_offset = vec_2(0, 34)
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_TELEPORT, F_THORN, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)

    tt = RT("hero_boss", "enemy")
    tt.render.sprites[1].angles = {}
    tt.render.sprites[1].angles.walk = {"running"}
    tt.render.sprites[1].name = "idle"
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.health_bar.offset = vec_2(0, ady(60))
    tt.vis.bans = bor(F_TELEPORT, F_THORN, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)

    -- boss:alleria
    tt = RT("eb_alleria", "hero_boss")
    AC(tt, "melee", "ranged")
    anchor_y = 0.14
    anchor_x = 0.5
    image_y = 76
    image_x = 60
    tt.health.hp_max = 4500
    tt.info.i18n_key = "HERO_ARCHER"
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_hero_0004" or "info_portraits_hero_0001"
    tt.sound_events.death = "HeroArcherDeath"
    tt.sound_events.insert = "HeroArcherTaunt"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.motion.max_speed = 2 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.14)
    tt.render.sprites[1].prefix = "hero_alleria"
    tt.enemy.melee_slot_offset = vec_2(4, 0)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 15)
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].hit_time = fts(8)
    tt.melee.attacks[1].sound = "MeleeSword"
    tt.melee.attacks[1].damage_max = 170
    tt.melee.attacks[1].damage_min = 105
    tt.ranged.range_while_blocking = true
    tt.ranged.attacks[1] = E:clone_c("bullet_attack")
    tt.ranged.attacks[1].bullet = "arrow_hero_boss_alleria"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(0, 12)}
    tt.ranged.attacks[1].max_range = 185
    tt.ranged.attacks[1].min_range = 40
    tt.ranged.attacks[1].shoot_time = fts(5)
    tt.ranged.attacks[1].cooldown = 0.4
    -- tt.ranged.attacks[2] = E:clone_c("bullet_attack")
    -- tt.ranged.attacks[2].cooldown = 3 + fts(29)
    -- tt.ranged.attacks[2].bullet = "arrow_multishot_hero_boss_alleria"
    -- tt.ranged.attacks[2].bullet_start_offset = {vec_2(0, 12)}
    -- tt.ranged.attacks[2].max_range = 200
    -- tt.ranged.attacks[2].min_range = 40
    -- tt.ranged.attacks[2].node_prediction = fts(10)
    -- tt.ranged.attacks[2].shoot_time = fts(12)
    -- tt.ranged.attacks[2].sound = "HeroArcherShoot"
    -- tt.ranged.attacks[2].multi_num = 3

    tt = RT("arrow_hero_boss_alleria", "arrow")
    tt.bullet.flight_time = fts(15)
    tt.bullet.damage_max = 250
    tt.bullet.damage_min = 50

    -- tt = RT("arrow_multishot_hero_boss_alleria", "arrow")
    -- tt.bullet.particles_name = "ps_arrow_multishot_hero_alleria"
    -- tt.bullet.damage_min = 75
    -- tt.bullet.damage_max = 250
    -- tt.bullet.damage_type = DAMAGE_TRUE
    -- tt.bullet.prediction_error = false
    -- tt.render.sprites[1].name = "hero_archer_arrow"
    -- tt.bullet.flight_time = fts(5)

    -- boss:elora
    tt = RT("eb_elora", "hero_boss")
    AC(tt, "melee", "ranged")
    anchor_y = 0.17
    anchor_x = 0.5
    tt.health.armor = 0.5
    tt.health.hp_max = 4500
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.sound_events.death = "HeroFrostDeath"
    tt.sound_events.insert = "HeroFrostTaunt"
    tt.melee.range = 45
    tt.melee.attacks[1].cooldown = 1.5
    tt.melee.attacks[1].damage_max = 105
    tt.melee.attacks[1].damage_min = 75
    tt.melee.attacks[1].hit_time = fts(14)
    tt.melee.attacks[1].sound = "MeleeSword"
    tt.melee.attacks[1].damage_type = DAMAGE_MAGICAL
    tt.info.i18n_key = "HERO_FROST_SORCERER"
    tt.info.fn = scripts.hero_basic.get_info
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_hero_0009" or "info_portraits_hero_0009"
    tt.motion.max_speed = 1.75 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.17)
    tt.render.sprites[1].prefix = "hero_elora"
    tt.render.sprites[2] = CC("sprite")
    tt.render.sprites[2].name = "hero_elora_frostEffect"
    tt.render.sprites[2].anchor = vec_2(0.5, 0.1)
    tt.render.sprites[2].hidden = true
    tt.render.sprites[2].loop = true
    tt.render.sprites[2].ignore_start = true
    tt.run_particles_name = "ps_elora_run"
    tt.enemy.melee_slot_offset = vec_2(12, 0)
    tt.ui.click_rect = r(-15, -5, 30, 40)
    tt.unit.mod_offset = vec_2(0, 15)
    tt.ranged.attacks[1] = E:clone_c("bullet_attack")
    tt.ranged.attacks[1].cooldown = fts(40)
    tt.ranged.attacks[1].bullet = "bolt_elora_boss_freeze"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(18, 36)}
    tt.ranged.attacks[1].chance = 0.2
    tt.ranged.attacks[1].filter_fn = scripts.hero_elora.freeze_filter_fn
    tt.ranged.attacks[1].min_range = 23.04
    tt.ranged.attacks[1].max_range = 166.4
    tt.ranged.attacks[1].shoot_time = fts(19)
    tt.ranged.attacks[1].shared_cooldown = true
    tt.ranged.attacks[1].vis_flags = bor(F_RANGED)
    tt.ranged.attacks[2] = table.deepclone(tt.ranged.attacks[1])
    tt.ranged.attacks[2].bullet = "bolt_elora_boss_slow"
    tt.ranged.attacks[2].chance = 1
    tt.ranged.attacks[2].filter_fn = nil

    tt = RT("bolt_elora_boss_freeze", "bolt")
    tt.bullet.vis_flags = F_RANGED
    tt.bullet.vis_bans = 0
    tt.render.sprites[1].prefix = "bolt_elora"
    tt.bullet.hit_fx = "fx_bolt_elora_hit"
    tt.bullet.pop = nil
    tt.bullet.pop_conds = nil
    tt.bullet.mod = "mod_elora_bolt_freeze"
    tt.bullet.damage_min = 190
    tt.bullet.damage_max = 505
    tt.bullet.xp_gain_factor = 2
    tt = RT("bolt_elora_boss_slow", "bolt_elora_boss_freeze")
    tt.bullet.mod = "mod_elora_bolt_slow"

    -- 毁灭者
    tt = RT("eb_juggernaut", "boss")
    AC(tt, "melee", "timed_attacks")
    anchor_y = 0.08
    anchor_x = 0.5
    image_y = 128
    image_x = 144
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(40, 0)
    tt.health.dead_lifetime = 10
    tt.health.hp_max = 10000
    tt.health.armor = 0.5
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.health_bar.offset = vec_2(0, ady(120))
    tt.info.fn = scripts.eb_juggernaut.get_info
    tt.info.i18n_key = "ENEMY_JUGGERNAUT"
    tt.info.enc_icon = 32
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0027" or "info_portraits_sc_0027"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.eb_juggernaut.update
    tt.motion.max_speed = 0.4 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.08)
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].angles_stickiness = {
        walk = 10
    }
    tt.render.sprites[1].angles = {
        walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    }
    tt.render.sprites[1].prefix = "eb_juggernaut"
    tt.sound_events.death = "DeathJuggernaut"
    tt.sound_events.insert = "MusicBossFight"
    tt.ui.click_rect = r(-35, 0, 70, 80)
    tt.unit.blood_color = BLOOD_GRAY
    tt.unit.hit_offset = vec_2(0, ady(50))
    tt.unit.mod_offset = vec_2(adx(70), ady(50))
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_TELEPORT, F_THORN, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_max = 175
    tt.melee.attacks[1].damage_min = 100
    tt.melee.attacks[1].damage_radius = 45
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].hit_time = fts(15)
    tt.melee.attacks[1].hit_offset = tt.enemy.melee_slot
    tt.melee.attacks[1].hit_fx = "fx_juggernaut_smoke"
    tt.melee.attacks[1].sound_hit = "juggernaut_punch"
    tt.timed_attacks.list[1] = E:clone_c("custom_attack")
    tt.timed_attacks.list[1].animation = "shoot"
    tt.timed_attacks.list[1].bullet = "missile_juggernaut"
    tt.timed_attacks.list[1].bullet_start_offset = vec_2(-30, 82)
    tt.timed_attacks.list[1].cooldown = 11
    tt.timed_attacks.list[1].launch_vector = vec_2(12, 170)
    tt.timed_attacks.list[1].max_range = 99999
    tt.timed_attacks.list[1].min_range = 100
    tt.timed_attacks.list[1].shoot_time = fts(24)
    tt.timed_attacks.list[1].vis_flags = F_RANGED
    tt.timed_attacks.list[2] = table.deepclone(tt.timed_attacks.list[1])
    tt.timed_attacks.list[2].bullet = "bomb_juggernaut"
    tt.timed_attacks.list[2].cooldown = 4

    -- 大雪怪
    tt = RT("eb_jt", "boss")
    AC(tt, "melee", "timed_attacks", "auras")
    anchor_y = 0.19
    anchor_x = 0.5
    image_y = 200
    image_x = 260
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "jt_spawner_aura"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(55, 0)
    tt.health.dead_lifetime = 100
    tt.health.hp_max = 12000
    tt.health.on_damage = scripts.eb_jt.on_damage
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.health_bar.offset = vec_2(0, ady(172))
    tt.info.fn = scripts.eb_jt.get_info
    tt.info.i18n_key = "ENEMY_YETI_BOSS"
    tt.info.enc_icon = 33
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0047" or "info_portraits_sc_0047"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.eb_jt.update
    tt.motion.max_speed = 0.3 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.08)
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].angles_stickiness = {
        walk = 10
    }
    tt.render.sprites[1].angles = {
        walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    }
    tt.render.sprites[1].prefix = "eb_jt"
    tt.tap_decal = "decal_jt_tap"
    tt.tap_timeout = 1.5
    tt.sound_events.death = "JtDeath"
    tt.sound_events.death_explode = "JtExplode"
    tt.sound_events.insert = "MusicBossFight"
    tt.ui.click_rect = r(-38, 0, 76, 95)
    tt.unit.hit_offset = vec_2(0, 60)
    tt.unit.marker_hidden = true
    tt.unit.mod_offset = vec_2(adx(130), ady(90))
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_TELEPORT, F_THORN, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].count = 5
    tt.melee.attacks[1].damage_max = 200
    tt.melee.attacks[1].damage_min = 150
    tt.melee.attacks[1].damage_radius = 45
    tt.melee.attacks[1].damage_type = DAMAGE_EAT
    tt.melee.attacks[1].hit_offset = tt.enemy.melee_slot
    tt.melee.attacks[1].hit_time = fts(15)
    tt.melee.attacks[1].sound = "JtEat"
    tt.melee.attacks[1].sound_args = {
        delay = fts(6)
    }
    tt.melee.attacks[1].side_effect = function(this, store, attack, target)
        scripts.heal(this, 100)
    end
    tt.timed_attacks.list[1] = CC("custom_attack")
    tt.timed_attacks.list[1].cooldown = 10 + fts(29)
    tt.timed_attacks.list[1].count = 4
    tt.timed_attacks.list[1].exhausted_duration = 2.5
    tt.timed_attacks.list[1].exhausted_sound = "JtRest"
    tt.timed_attacks.list[1].exhausted_sound_args = {
        delay = fts(34)
    }
    tt.timed_attacks.list[1].hit_decal = "decal_jt_ground_hit"
    tt.timed_attacks.list[1].hit_offset = vec_2(80, -10)
    tt.timed_attacks.list[1].hit_time = fts(16)
    tt.timed_attacks.list[1].max_range = 192
    tt.timed_attacks.list[1].min_range = 0
    tt.timed_attacks.list[1].mod = "mod_jt_tower"
    tt.timed_attacks.list[1].sound = "JtAttack"
    tt.timed_attacks.list[1].sound_args = {
        delay = fts(6)
    }

    -- 卫兹南
    tt = RT("eb_veznan", "boss")
    AC(tt, "melee", "timed_attacks", "taunts")
    anchor_y = 0.17010309278350516
    anchor_x = 0.5
    image_y = 194
    image_x = 214
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.health.hp_max = {6666, 7999, 9666, 11666}
    tt.health.on_damage = scripts.eb_veznan.on_damage
    tt.health.ignore_damage = true
    tt.health_bar.hidden = true
    tt.health_bar.offset = vec_2(0, 43)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM_MEDIUM
    tt.health.magic_armor = 0.35
    tt.info.i18n_key = "ENEMY_VEZNAN"
    tt.info.enc_icon = 34
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0056" or "info_portraits_sc_0056"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.eb_veznan.update
    tt.motion.max_speed = 0.35 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "eb_veznan"
    tt.render.sprites[1].name = "idleDown"
    tt.render.sprites[1].angles_stickiness = {
        walk = 10
    }
    tt.render.sprites[1].angles = {
        walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    }
    tt.sound_events.death = "VeznanDeath"
    tt.ui.click_rect = r(-11, -2, 22, 38)
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.mod_offset = vec_2(0, 12)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.vis.bans = bor(F_TELEPORT, F_THORN, F_POLYMORPH, F_ALL)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.pos_castle = vec_2(518, 677)
    tt.souls_aura = "veznan_souls_aura"
    tt.white_circle = "decal_eb_veznan_white_circle"
    tt.taunts.animation = "laught"
    tt.taunts.delay_min = fts(400)
    tt.taunts.delay_max = fts(700)
    tt.taunts.duration = 4
    tt.taunts.decal_name = "decal_s12_shoutbox"
    tt.taunts.offset = vec_2(0, 0)
    tt.taunts.pos = vec_2(525, 608)
    tt.taunts.sets.welcome = CC("taunt_set")
    tt.taunts.sets.welcome.format = "VEZNAN_TAUNT_%04d"
    tt.taunts.sets.welcome.end_idx = 5
    tt.taunts.sets.welcome.delays = {fts(60), fts(140), fts(450), fts(250)}
    tt.taunts.sets.castle = CC("taunt_set")
    tt.taunts.sets.castle.format = "VEZNAN_TAUNT_%04d"
    tt.taunts.sets.castle.start_idx = 6
    tt.taunts.sets.castle.end_idx = 25
    tt.taunts.sets.damage = CC("taunt_set")
    tt.taunts.sets.damage.format = "VEZNAN_TAUNT_%04d"
    tt.taunts.sets.damage.start_idx = 26
    tt.taunts.sets.damage.end_idx = 29
    tt.taunts.sets.pre_battle = CC("taunt_set")
    tt.taunts.sets.pre_battle.format = "VEZNAN_TAUNT_%04d"
    tt.taunts.sets.pre_battle.start_idx = 30
    tt.taunts.sets.pre_battle.end_idx = 30
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].count = 8
    tt.melee.attacks[1].damage_min = 666
    tt.melee.attacks[1].damage_max = 999
    tt.melee.attacks[1].damage_radius = 75
    tt.melee.attacks[1].damage_type = DAMAGE_MAGICAL
    tt.melee.attacks[1].hit_offset = vec_2(-10, -2)
    tt.melee.attacks[1].hit_time = fts(17)
    tt.melee.attacks[1].hit_decal = "decal_veznan_strike"
    tt.melee.attacks[1].sound_hit = "VeznanAttack"
    tt.melee.attacks[2] = table.deepclone(tt.melee.attacks[1])
    tt.melee.attacks[2].cooldown = 2.5
    tt.melee.attacks[2].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[2].disabled = true
    tt.melee.attacks[2].hit_decal = nil
    tt.melee.attacks[2].hit_fx = "fx_veznan_demon_fire"
    tt.melee.attacks[2].hit_fx_offset = vec_2(20, 9)
    tt.melee.attacks[2].hit_fx_once = true
    tt.melee.attacks[2].hit_fx_flip = true
    tt.melee.attacks[2].hit_times = {fts(20), fts(24), fts(28), fts(32), fts(36), fts(38), fts(42), fts(44)}
    tt.melee.attacks[2].hit_offset = vec_2(40, 0)
    tt.melee.attacks[2].sound_hit = nil
    tt.melee.attacks[2].sound = "VeznanDemonFire"
    tt.timed_attacks.list[1] = CC("custom_attack")
    tt.timed_attacks.list[1].cooldown = 13
    tt.timed_attacks.list[1].animation = "spellDown"
    tt.timed_attacks.list[1].hit_time = fts(14)
    tt.timed_attacks.list[1].mod = "mod_veznan_tower"
    tt.timed_attacks.list[1].sound = "VeznanHoldCast"
    tt.timed_attacks.list[1].attack_duration = fts(44)
    tt.timed_attacks.list[1].data = {
        [9] = {13, 2},
        [10] = {13, 3},
        [11] = {14, 4},
        [12] = {14, 5},
        [13] = {16, 6},
        [14] = {16, 7},
        [15] = {18, 8}
    }
    tt.timed_attacks.list[2] = CC("custom_attack")
    tt.timed_attacks.list[2].animation = "spellDown"
    tt.timed_attacks.list[2].cooldown = 15
    tt.timed_attacks.list[2].hit_time = fts(14)
    tt.timed_attacks.list[2].portal_name = "veznan_portal"
    tt.timed_attacks.list[2].sound = "VeznanPortalSummon"
    tt.timed_attacks.list[2].attack_duration = fts(44)
    tt.timed_attacks.list[2].data = {
        [6] = {15, 3, {1, 0, 0}},
        [7] = {10, 2, {1, 0, 0}},
        [8] = {20, 3, {0, 1, 0}},
        [9] = {15, 3, {1, 0, 0}},
        [10] = {20, 3, {1, 1, 0}},
        [11] = {15, 3, {1, 1, 0}},
        [12] = {15, 3, {1, 1, 0}},
        [13] = {15, 3, {0, 0, 1}},
        [14] = {15, 3, {1, 1, 1}},
        [15] = {15, 3, {1, 1, 1}}
    }
    tt.battle = {
        ba_animation = "spell",
        pa_animation = "spell",
        pa_cooldown = 10,
        pa_max_count = 40
    }
    tt.demon = {
        health_bar_offset = vec_2(0, 118),
        health_bar_scale = 1.8,
        melee_slot = vec_2(50, 0),
        speed = 0.6 * FPS,
        sprites_prefix = "eb_veznan_demon",
        transform_sound = "VeznanToDemon",
        ui_click_rect = r(-25, -5, 50, 110),
        unit_hit_offset = vec_2(0, 55),
        unit_mod_offset = vec_2(0, 45),
        unit_size = UNIT_SIZE_LARGE,
        info_portrait = IS_PHONE_OR_TABLET and "portraits_sc_0056" or "info_portraits_sc_0093"
    }

    -- 萨雷格兹
    tt = RT("eb_sarelgaz", "boss")
    AC(tt, "melee", "timed_attacks")
    anchor_y = 0.1484375
    anchor_x = 0.5
    image_y = 128
    image_x = 220
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(80, 0)
    tt.health.dead_lifetime = 8
    tt.health.hp_max = 18000
    tt.health.magic_armor = 0.4
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.health_bar.offset = vec_2(0, 108)
    tt.info.i18n_key = "ENEMY_SARELGAZ"
    tt.info.enc_icon = 35
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0057" or "info_portraits_sc_0057"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_spider_big.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 500
    tt.melee.attacks[1].damage_min = 300
    tt.melee.attacks[1].hit_time = fts(15)
    tt.melee.attacks[1].damage_type = DAMAGE_EAT
    tt.melee.attacks[1].sound = "SpiderAttack"
    tt.timed_attacks.list[1] = E:clone_c("bullet_attack")
    tt.timed_attacks.list[1].bullet = "enemy_sarelgaz_egg"
    tt.timed_attacks.list[1].max_cooldown = 12
    tt.timed_attacks.list[1].max_count = 100
    tt.timed_attacks.list[1].min_cooldown = 10
    tt.motion.max_speed = 0.34 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "eb_sarelgaz"
    tt.render.sprites[1].angles_stickiness = {
        walk = 10
    }
    tt.render.sprites[1].angles = {
        walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    }
    tt.sound_events.death = "DeathEplosion"
    tt.sound_events.insert = "MusicBossFight"
    tt.ui.click_rect = r(-45, 0, 90, 80)
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.can_explode = false
    tt.unit.can_disintegrate = false
    tt.unit.fade_time_after_death = 2
    tt.unit.hit_offset = vec_2(0, 45)
    tt.unit.marker_hidden = true
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 45)
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_TELEPORT, F_THORN, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.health_judger = true

    tt = E:register_t("enemy_sarelgaz_egg", "decal_scripted")
    E:add_comps(tt, "render", "spawner", "tween")
    tt.main_script.update = scripts.enemies_spawner.update
    tt.render.sprites[1].anchor.y = 0.22
    tt.render.sprites[1].scale = vec_2(2, 2)
    tt.render.sprites[1].prefix = "enemy_spider_egg"
    tt.render.sprites[1].loop = false
    tt.spawner.count = 3
    tt.spawner.cycle_time = fts(6)
    tt.spawner.entity = "enemy_sarelgaz_small"
    tt.spawner.node_offset = 5
    tt.spawner.pos_offset = vec_2(0, 1)
    tt.spawner.allowed_subpaths = {1, 2, 3}
    tt.spawner.random_subpath = false
    tt.spawner.animation_start = "start"
    tt.tween.disabled = true
    tt.tween.props[1].keys = {{0, 255}, {4, 0}}
    tt.tween.remove = true

    -- 古拉克
    tt = RT("eb_gulthak", "boss")
    AC(tt, "melee", "timed_attacks")
    anchor_y = 0.11
    anchor_x = 0.5
    tt.enemy.gold = 0
    image_y = 196
    image_x = 340
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(60, 0)
    tt.health.dead_lifetime = 8
    tt.health.hp_max = 12000
    tt.health_bar.offset = vec_2(0, 95)
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.info.i18n_key = "ENEMY_BOSS_GOBLIN_CHIEFTAIN"
    tt.info.enc_icon = 40
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0063" or "info_portraits_sc_0063"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_shaman.update
    tt.melee.attacks[1].cooldown = 1 + fts(20)
    tt.melee.attacks[1].damage_max = 600
    tt.melee.attacks[1].damage_min = 200
    tt.melee.attacks[1].hit_time = fts(11)
    tt.motion.max_speed = 0.4 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "eb_gulthak"
    tt.render.sprites[1].angles_stickiness = {
        walk = 10
    }
    tt.render.sprites[1].angles_flip_vertical = {
        walk = true
    }
    tt.render.sprites[1].angles = {
        walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    }
    tt.sound_events.death = "DeathBig"
    tt.sound_events.insert = "MusicBossFight"
    tt.ui.click_rect = r(-50, 0, 90, 60)
    tt.unit.can_explode = false
    tt.unit.can_disintegrate = false
    tt.unit.fade_time_after_death = 2
    tt.unit.hit_offset = vec_2(0, 30)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 27)
    tt.unit.marker_hidden = true
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_TELEPORT, F_THORN, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.timed_attacks.list[1] = E:clone_c("mod_attack")
    tt.timed_attacks.list[1].animation = "heal"
    tt.timed_attacks.list[1].cast_time = fts(14)
    tt.timed_attacks.list[1].cooldown = 8
    tt.timed_attacks.list[1].max_count = 20
    tt.timed_attacks.list[1].max_range = 320
    tt.timed_attacks.list[1].mod = "mod_gulthak_heal"
    tt.timed_attacks.list[1].sound = "EnemyHealing"
    tt.timed_attacks.list[1].vis_flags = bor(F_MOD)

    -- 绿泥树怪
    tt = RT("eb_greenmuck", "boss")
    AC(tt, "melee", "timed_attacks")
    anchor_y = 0.1402439024390244
    anchor_x = 0.5
    image_y = 232
    image_x = 244
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(40, 0)
    tt.health.dead_lifetime = 8
    tt.health.hp_max = 8000
    tt.health.armor = 0.8
    tt.health_bar.offset = vec_2(0, 135)
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.info.fn = scripts.eb_greenmuck.get_info
    tt.info.i18n_key = "ENEMY_ROTTEN_TREE_BOSS"
    tt.info.enc_icon = 45
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0069" or "info_portraits_sc_0069"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.eb_greenmuck.update
    tt.motion.max_speed = 0.3 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "eb_greenmuck"
    tt.render.sprites[1].angles_stickiness = {
        walk = 10
    }
    tt.render.sprites[1].angles = {
        walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    }
    tt.sound_events.death = nil
    tt.sound_events.insert = "MusicBossFight"
    tt.ui.click_rect = r(-30, 0, 60, 110)
    tt.unit.blood_color = BLOOD_GRAY
    tt.unit.fade_time_after_death = 2
    tt.unit.hit_offset = vec_2(0, 37)
    tt.unit.marker_offset = vec_2(0, -10)
    tt.unit.marker_hidden = true
    tt.unit.mod_offset = vec_2(0, 37)
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_TELEPORT, F_THORN, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_max = 250
    tt.melee.attacks[1].damage_min = 150
    tt.melee.attacks[1].damage_radius = 60
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].hit_time = fts(10)
    tt.melee.attacks[1].hit_offset = tt.enemy.melee_slot
    tt.timed_attacks.list[1] = E:clone_c("custom_attack")
    tt.timed_attacks.list[1].animation = "shoot"
    tt.timed_attacks.list[1].bullet = "bomb_greenmuck"
    tt.timed_attacks.list[1].count = 7
    tt.timed_attacks.list[1].bullet_start_offset = vec_2(0, 120)
    tt.timed_attacks.list[1].cooldown = 6
    tt.timed_attacks.list[1].shoot_time = fts(13)
    tt.timed_attacks.list[1].vis_flags = F_RANGED
    tt.timed_attacks.list[1].vis_bans = F_ENEMY

    -- 金并
    tt = RT("eb_kingpin", "enemy")
    AC(tt, "melee", "timed_attacks", "auras")
    anchor_y = 0.13
    anchor_x = 0.5
    image_y = 204
    image_x = 218
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "kingpin_damage_aura"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(60, 0)
    tt.health.dead_lifetime = 12
    tt.health.hp_max = 10000
    tt.health_bar.offset = vec_2(0, 125)
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.info.fn = scripts.eb_kingpin.get_info
    tt.info.i18n_key = "ENEMY_BOSS_BANDIT"
    tt.info.enc_icon = 48
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0072" or "info_portraits_sc_0072"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.eb_kingpin.update
    tt.motion.max_speed = 0.35 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.13)
    tt.render.sprites[1].prefix = "eb_kingpin"
    tt.render.sprites[1].angles_stickiness = {
        walk = 10
    }
    tt.render.sprites[1].angles = {
        walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    }
    tt.sound_events.death = "DeathJuggernaut"
    tt.sound_events.insert = "MusicBossFight"
    tt.stop_time = 5
    tt.stop_cooldown = 5
    tt.stop_wait = fts(25)
    tt.ui.click_rect = r(-50, 0, 100, 75)
    tt.unit.fade_time_after_death = 2
    tt.unit.hit_offset = vec_2(0, 80)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 82)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_TELEPORT, F_THORN, F_POLYMORPH, F_BLOCK)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 1 + fts(20)
    tt.melee.attacks[1].damage_max = 100
    tt.melee.attacks[1].damage_min = 100
    tt.melee.attacks[1].damage_radius = 65
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].hit_time = fts(15)
    tt.melee.attacks[1].hit_offset = tt.enemy.melee_slot
    tt.melee.attacks[1].hit_fx = "fx_juggernaut_smoke"
    tt.timed_attacks.list[1] = E:clone_c("mod_attack")
    tt.timed_attacks.list[1].animation = "eat"
    tt.timed_attacks.list[1].cast_time = fts(14)
    tt.timed_attacks.list[1].cooldown = 5
    tt.timed_attacks.list[1].max_count = 1
    tt.timed_attacks.list[1].max_range = 320
    tt.timed_attacks.list[1].mod = "mod_kingpin_heal_self"
    tt.timed_attacks.list[1].sound = "EnemyHealing"
    tt.timed_attacks.list[1].vis_flags = bor(F_MOD)
    tt.timed_attacks.list[2] = table.deepclone(tt.timed_attacks.list[1])
    tt.timed_attacks.list[2].animation = "heal"
    tt.timed_attacks.list[2].max_count = 9999
    tt.timed_attacks.list[2].max_range = 100
    tt.timed_attacks.list[2].mod = "mod_kingpin_heal_others"

    -- 阿古克汗
    tt = RT("eb_ulgukhai", "boss")

    AC(tt, "melee", "auras")

    anchor_y = 0.1792452830188679
    anchor_x = 0.5
    image_y = 150
    image_x = 240
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "aura_ulgukhai_regen"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(40, 0)
    tt.health.dead_lifetime = 12
    tt.health.hp_max = 9000
    tt.health.armor = 0.3
    tt.health_bar.offset = vec_2(0, 90)
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.info.fn = scripts.eb_ulgukhai.get_info
    tt.info.i18n_key = "ENEMY_TROLL_BOSS"
    tt.info.enc_icon = 52
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0075" or "info_portraits_sc_0075"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.eb_ulgukhai.update
    tt.motion.max_speed = 0.3 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "eb_ulgukhai"
    tt.render.sprites[1].angles_stickiness = {
        walk = 10
    }
    tt.render.sprites[1].angles = {
        walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    }
    tt.sound_events.death = "DeathBig"
    tt.sound_events.insert = "MusicBossFight"
    tt.unit.blood_color = BLOOD_GRAY
    tt.ui.click_rect = r(-25, 5, 50, 65)
    tt.unit.fade_time_after_death = 2
    tt.unit.hit_offset = vec_2(0, 30)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 26)
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_TELEPORT, F_THORN, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.shielded_extra_vis_bans = bor(F_MOD, F_POISON)
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 3
    tt.melee.attacks[1].damage_max = 350
    tt.melee.attacks[1].damage_min = 150
    tt.melee.attacks[1].damage_radius = 57.6
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].hit_time = fts(16)
    tt.melee.attacks[1].hit_offset = vec_2(60, 0)
    tt.melee.attacks[1].hit_decal = "decal_ground_hit"
    tt.melee.attacks[1].hit_fx = "fx_ground_hit"
    tt.melee.attacks[1].sound_hit = "AreaAttack"

    -- 摩洛克
    tt = RT("eb_moloch", "boss")
    AC(tt, "melee", "timed_attacks")
    anchor_y = 0.105
    anchor_x = 0.5
    image_y = 282
    image_x = 282
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(33, 0)
    tt.health.dead_lifetime = 100
    tt.health.ignore_damage = true
    tt.health.hp_max = {11111, 13333, 15555}
    tt.health.magic_armor = 0.5
    tt.health_bar.offset = vec_2(0, 125)
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.info.i18n_key = "ENEMY_DEMON_MOLOCH"
    tt.info.enc_icon = 57
    tt.info.fn = scripts.eb_moloch.get_info
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0080" or "info_portraits_sc_0080"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.eb_moloch.update
    tt.motion.max_speed = 0.6 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "eb_moloch"
    tt.render.sprites[1].angles_stickiness = {
        walk = 10
    }
    tt.render.sprites[1].angles = {
        walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    }
    tt.sound_events.death = "EnemyInfernoBossDeath"
    tt.ui.click_rect = r(-25, 0, 50, 100)
    tt.unit.hit_offset = vec_2(0, 60)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 45)
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_ALL)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.stand_up_wait_time = fts(14)
    tt.stand_up_sound = "MusicBossFight"
    tt.pos_sitting = vec_2(526, 614)
    tt.nav_path.pi = 2
    tt.nav_path.spi = 1
    tt.nav_path.ni = 1
    tt.wave_active = 16
    tt.active_vis_bans = bor(F_TELEPORT, F_THORN, F_POLYMORPH)
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 1.5 + fts(25)
    tt.melee.attacks[1].damage_max = 120
    tt.melee.attacks[1].damage_min = 80
    tt.melee.attacks[1].damage_radius = 40
    tt.melee.attacks[1].count = nil
    tt.melee.attacks[1].hit_time = fts(15)
    tt.melee.attacks[1].hit_offset = tt.enemy.melee_slot
    tt.melee.attacks[1].hit_fx = "fx_moloch_ring"
    tt.melee.attacks[1].sound_hit = "EnemyInfernoStomp"
    tt.timed_attacks.list[1] = CC("area_attack")
    tt.timed_attacks.list[1].cooldown = 7
    tt.timed_attacks.list[1].animation = "horn_attack"
    tt.timed_attacks.list[1].damage_radius = 100
    tt.timed_attacks.list[1].damage_type = DAMAGE_INSTAKILL
    tt.timed_attacks.list[1].hit_time = fts(15)
    tt.timed_attacks.list[1].min_targets = 2
    tt.timed_attacks.list[1].fx_list = {{"fx_moloch_rocks",
                                         {{36, -30}, {1, -10}, {90, -23}, {87, 5}, {49, -3}, {54, 17}}},
                                        {"fx_moloch_ring", {{45, 0}}}}
    tt.timed_attacks.list[1].hit_offset = vec_2(20, 0)
    tt.timed_attacks.list[1].sound = "EnemyInfernoHorns"
    tt.timed_attacks.list[1].sound_args = {
        delay = fts(5)
    }
    tt.is_demon = true

    -- 蘑菇人
    tt = RT("eb_myconid", "boss")
    AC(tt, "melee", "timed_attacks")
    anchor_y = 0.16428571428571428
    anchor_x = 0.5
    image_y = 140
    image_x = 174
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(40, 0)
    tt.health.dead_lifetime = 12
    tt.health.hp_max = 4500
    tt.health_bar.offset = vec_2(0, 100)
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.info.fn = scripts.eb_myconid.get_info
    tt.info.i18n_key = "ENEMY_ROTTEN_MYCONID"
    tt.info.enc_icon = 59
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0082" or "info_portraits_sc_0082"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.eb_myconid.update
    tt.motion.max_speed = 0.6 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "eb_myconid"
    tt.render.sprites[1].angles_stickiness = {
        walk = 10
    }
    tt.render.sprites[1].angles = {
        walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    }
    tt.sound_events.death = "EnemyMushroomBossDeath"
    tt.sound_events.insert = "MusicBossFight"
    tt.ui.click_rect = r(-25, 0, 50, 80)
    tt.unit.fade_time_after_death = 4
    tt.unit.blood_color = BLOOD_VIOLET
    tt.unit.hit_offset = vec_2(0, 33)
    tt.unit.mod_offset = vec_2(0, 33)
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_TELEPORT, F_THORN, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.spawner_entity = "myconid_spawner"
    tt.on_death_spawn_count = 12
    tt.on_death_spawn_wait = fts(40)
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_max = 350
    tt.melee.attacks[1].damage_min = 150
    tt.melee.attacks[1].hit_time = fts(9)
    tt.timed_attacks.list[1] = E:clone_c("custom_attack")
    tt.timed_attacks.list[1].animation = "spores"
    tt.timed_attacks.list[1].cooldown = 5
    tt.timed_attacks.list[1].final_wait = fts(20)
    tt.timed_attacks.list[1].fx = "fx_myconid_spores"
    tt.timed_attacks.list[1].fx_offset = vec_2(0, 40)
    tt.timed_attacks.list[1].min_nodes = 25
    tt.timed_attacks.list[1].mod = "mod_myconid_poison"
    tt.timed_attacks.list[1].radius = 110
    tt.timed_attacks.list[1].sound = "EnemyMushroomGas"
    tt.timed_attacks.list[1].summon_counts = {2, 3, 3, 4, 4, 4, 3, 2}
    tt.timed_attacks.list[1].vis_bans = F_ENEMY
    tt.timed_attacks.list[1].vis_flags = bor(F_MOD, F_POISON)
    tt.timed_attacks.list[1].wait_times = {fts(15), fts(3), fts(6)}

    -- 布莱克本
    tt = RT("eb_blackburn", "boss")
    AC(tt, "melee", "timed_attacks", "auras")
    anchor_y = 0.16993464052287582
    anchor_x = 0.5
    image_y = 308
    image_x = 314
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(40, 0)
    tt.health.dead_lifetime = 100
    tt.health.armor = 0.75
    tt.health.hp_max = 11000
    tt.health_bar.offset = vec_2(0, 125)
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.info.fn = scripts.eb_blackburn.get_info
    tt.info.i18n_key = "ENEMY_BOSS_BLACKBURN"
    tt.info.enc_icon = 69
    tt.info.portrait = IS_PHONE_OR_TABLET and "portraits_sc_0093" or "info_portraits_sc_0092"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.eb_blackburn.update
    tt.motion.max_speed = 0.5 * FPS
    tt.render.sprites[1].anchor = vec_2(anchor_x, anchor_y)
    tt.render.sprites[1].prefix = "eb_blackburn"
    tt.render.sprites[1].angles_stickiness = {
        walk = 10
    }
    tt.render.sprites[1].angles = {
        walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    }
    tt.sound_events.death = "EnemyBlackburnBossDeath"
    tt.sound_events.insert = "MusicBossFight"
    tt.ui.click_rect.pos.y = 9
    tt.unit.hit_offset = vec_2(adx(150), ady(115))
    tt.unit.marker_offset = vec_2(0, 11)
    tt.unit.mod_offset = vec_2(0, ady(115))
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_TELEPORT, F_THORN, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "blackburn_aura"
    tt.auras.list[1].cooldown = 0
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 1.3 + fts(40)
    tt.melee.attacks[1].damage_max = 200
    tt.melee.attacks[1].damage_min = 100
    tt.melee.attacks[1].damage_radius = 63.829787234042556
    tt.melee.attacks[1].dodge_time = fts(13)
    tt.melee.attacks[1].hit_time = fts(15)
    tt.melee.attacks[1].sound_hit = "EnemyBlackburnBossSwing"
    tt.melee.attacks[1].vis_bans = bor(F_STUN)
    tt.timed_attacks.list[1] = CC("custom_attack")
    tt.timed_attacks.list[1].after_hit_wait = fts(20)
    tt.timed_attacks.list[1].animation = "smash"
    tt.timed_attacks.list[1].aura_shake = "aura_screen_shake"
    tt.timed_attacks.list[1].cooldown = fts(300)
    tt.timed_attacks.list[1].after_cooldown = fts(150)
    tt.timed_attacks.list[1].damage_max = 5
    tt.timed_attacks.list[1].damage_min = 1
    tt.timed_attacks.list[1].damage_type = DAMAGE_TRUE
    tt.timed_attacks.list[1].damage_radius = 106.38297872340426
    tt.timed_attacks.list[1].fx = "fx_blackburn_smash"
    tt.timed_attacks.list[1].fx_offset = vec_2(26, 7)
    tt.timed_attacks.list[1].hit_decal = "decal_blackburn_smash_ground"
    tt.timed_attacks.list[1].hit_time = fts(24)
    tt.timed_attacks.list[1].min_range = 0
    tt.timed_attacks.list[1].max_range = 283.68794326241135
    tt.timed_attacks.list[1].mod = "mod_blackburn_stun"
    tt.timed_attacks.list[1].mod_towers = "mod_blackburn_tower"
    tt.timed_attacks.list[1].sound = "EnemyBlackburnBossSpecialStomp"
    tt.timed_attacks.list[1].sound_args = {
        delay = fts(13)
    }
    tt.timed_attacks.list[1].vis_flags = bor(F_MOD)

    -- unknown
    tt = E:register_t("eb_elder_shaman", "decal_scripted")
    E:add_comps(tt, "attacks")
    tt.attacks.animation = "cast"
    tt.attacks.delay = {0.6, 0.9}
    tt.attacks.list[1] = E:clone_c("aura_attack")
    tt.attacks.list[1].aura = "aura_elder_shaman_healing"
    tt.attacks.list[1].node_offset = {10, 30}
    tt.attacks.list[1].path_margins = {40, 10}
    tt.attacks.list[1].power_name = "healing"
    tt.attacks.list[1].vis_bans = bor(F_FLYING, F_BOSS, F_FRIEND)
    tt.attacks.list[1].vis_flags = bor(F_MOD)
    tt.attacks.list[2] = E:clone_c("aura_attack")
    tt.attacks.list[2].aura = "aura_elder_shaman_damage"
    tt.attacks.list[2].power_name = "damage"
    tt.attacks.list[2].vis_bans = bor(F_FLYING, F_BOSS, F_ENEMY)
    tt.attacks.list[2].vis_flags = bor(F_MOD)
    tt.attacks.list[2].enemy_vis_bans = bor(F_FLYING, F_BOSS)
    tt.attacks.list[2].enemy_vis_flags = bor(F_MOD)
    tt.attacks.list[3] = E:clone_c("aura_attack")
    tt.attacks.list[3].aura = "aura_elder_shaman_speed"
    tt.attacks.list[3].node_offset = {10, 30}
    tt.attacks.list[3].path_margins = {25, 40}
    tt.attacks.list[3].power_name = "speed"
    tt.attacks.list[3].vis_bans = bor(F_FLYING, F_BOSS, F_FRIEND)
    tt.attacks.list[3].vis_flags = bor(F_MOD)
    tt.main_script.update = scripts.eb_elder_shaman.update
    tt.render.sprites[1].prefix = "eb_elder_shaman"
    tt.render.sprites[1].name = "idle"
    tt.render.sprites[1].anchor.y = 0.09259259259259259
    tt.taunt = {
        delay_min = 15,
        delay_max = 20,
        duration = 4,
        sets = {
            welcome = {},
            prebattle = {},
            battle = {},
            life_lost = {},
            totem = {}
        }
    }
    tt.taunt.sets.welcome.format = "ENDLESS_BOSS_ORC_TAUNT_WELCOME_%04d"
    tt.taunt.sets.welcome.start_idx = 1
    tt.taunt.sets.welcome.end_idx = 2
    tt.taunt.sets.prebattle.format = "ENDLESS_BOSS_ORC_TAUNT_PREBATTLE_%04d"
    tt.taunt.sets.prebattle.start_idx = 1
    tt.taunt.sets.prebattle.end_idx = 4
    tt.taunt.sets.battle.format = "ENDLESS_BOSS_ORC_TAUNT_GENERIC_%04d"
    tt.taunt.sets.battle.start_idx = 1
    tt.taunt.sets.battle.end_idx = 9
    tt.taunt.sets.life_lost.format = "ENDLESS_BOSS_ORC_TAUNT_LIFE_LOST_%04d"
    tt.taunt.sets.life_lost.start_idx = 1
    tt.taunt.sets.life_lost.end_idx = 1
    tt.taunt.sets.totem.format = "ENDLESS_BOSS_ORC_TAUNT_TOTEM_%04d"
    tt.taunt.sets.totem.start_idx = 1
    tt.taunt.sets.totem.end_idx = 1
    tt.taunt.offset = vec_2(0, -75)
    tt.taunt.ts = 0
    tt.taunt.next_ts = 0
    tt = RT("decal_elder_shaman_shoutbox", "decal_tween")

    AC(tt, "texts")

    tt.render.sprites[1].name = "HalloweenBoss_tauntBox"
    tt.render.sprites[1].animated = false
    tt.render.sprites[1].z = Z_BULLETS
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].z = Z_BULLETS
    tt.render.sprites[2].offset = vec_2(0, -9)
    tt.texts.list[1].text = "Hello world"
    tt.texts.list[1].size = vec_2(172, 62)
    tt.texts.list[1].font_name = "body_bold"
    tt.texts.list[1].font_size = 20
    tt.texts.list[1].color = {255, 114, 114}
    tt.texts.list[1].line_height = 0.8
    tt.texts.list[1].sprite_id = 2
    tt.texts.list[1].fit_height = true
    tt.tween.props[1].name = "scale"
    tt.tween.props[1].keys = {{0, vec_2(1.01, 1.01)}, {0.4, vec_2(0.99, 0.99)}, {0.8, vec_2(1.01, 1.01)}}
    tt.tween.props[1].sprite_id = 1
    tt.tween.props[1].loop = true
    tt.tween.props[2] = table.deepclone(tt.tween.props[1])
    tt.tween.props[2].sprite_id = 2
    tt.tween.props[3] = E:clone_c("tween_prop")
    tt.tween.props[3].keys = {{0, 0}, {0.25, 255}}
    tt.tween.props[3].sprite_id = 1
    tt.tween.props[4] = table.deepclone(tt.tween.props[3])
    tt.tween.props[4].sprite_id = 2
    tt.tween.remove = false

    -- kr2

    tt = E:register_t("enemy_bouncer", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.22
    image_y = 36
    tt.enemy.gold = 5
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.armor = 0
    tt.health.hp_max = {40, 50, 60}
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(38))
    tt.info.portrait = IS_PHONE and "portraits_sc_0027" or "kr2_info_portraits_enemies_0001"
    tt.info.enc_icon = 1
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 6
    tt.melee.attacks[1].damage_min = 2
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 0.96 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_desertthug"
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, ady(8))
    tt.unit.mod_offset = vec_2(0, ady(20))

    tt = E:register_t("enemy_desert_raider", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.21
    image_y = 38
    tt.enemy.gold = 16
    tt.enemy.melee_slot = vec_2(21, 0)
    tt.health.armor = 0.3
    tt.health.hp_max = 200
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(39))
    tt.info.portrait = IS_PHONE and "portraits_sc_0028" or "kr2_info_portraits_enemies_0002"
    tt.info.enc_icon = 2
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1.2
    tt.melee.attacks[1].damage_max = 10
    tt.melee.attacks[1].damage_min = 6
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 1.07 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_desertraider"
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, ady(9))
    tt.unit.mod_offset = vec_2(0, ady(21))

    tt = E:register_t("enemy_desert_wolf_small", "enemy")
    E:add_comps(tt, "melee", "dodge")
    anchor_y = 0.21
    image_y = 28
    tt.dodge.chance = 0.3
    tt.dodge.silent = true
    tt.enemy.gold = 5
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.armor = 0
    tt.health.hp_max = 25
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(32))
    tt.info.portrait = IS_PHONE and "portraits_sc_0033" or "kr2_info_portraits_enemies_0008"
    tt.info.enc_icon = 8
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 3
    tt.melee.attacks[1].damage_min = 1
    tt.melee.attacks[1].hit_time = fts(14)
    tt.melee.attacks[1].sound_hit = "WolfAttack"
    tt.motion.max_speed = 2.67 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_wulf"
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 11)
    tt.unit.marker_offset = vec_2(0, ady(5))
    tt.unit.mod_offset = vec_2(0, ady(14))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_SKELETON)
    tt.sound_events.death = "DeathPuff"
    tt.sound_events.death_by_explosion = "DeathPuff"

    tt = E:register_t("enemy_desert_wolf", "enemy")
    E:add_comps(tt, "melee", "dodge")
    anchor_y = 0.28
    image_y = 52
    tt.dodge.chance = 0.5
    tt.dodge.silent = true
    tt.enemy.gold = 10
    tt.enemy.melee_slot = vec_2(27, 0)
    tt.health.hp_max = 120
    tt.health.magic_armor = 0.5
    tt.health_bar.offset = vec_2(0, ady(45))
    tt.info.portrait = IS_PHONE and "portraits_sc_0034" or "kr2_info_portraits_enemies_0009"
    tt.info.enc_icon = 9
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1 + fts(14)
    tt.melee.attacks[1].damage_max = 18
    tt.melee.attacks[1].damage_min = 12
    tt.melee.attacks[1].hit_time = fts(8)
    tt.melee.attacks[1].sound_hit = "WolfAttack"
    tt.motion.max_speed = 2.13 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_desertwolf"
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 10)
    tt.unit.marker_offset = vec_2(0, ady(16))
    tt.unit.mod_offset = vec_2(0, ady(28))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_SKELETON)
    tt.sound_events.death = "DeathPuff"
    tt.sound_events.death_by_explosion = "DeathPuff"

    tt = E:register_t("enemy_immortal", "enemy")
    E:add_comps(tt, "melee", "death_spawns")
    anchor_y = 0.2
    image_y = 50
    tt.death_spawns.name = "enemy_fallen"
    tt.death_spawns.concurrent_with_death = true
    tt.enemy.gold = 24
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.health.armor = 0.6
    tt.health.hp_max = 360
    tt.health_bar.offset = vec_2(0, ady(51))
    tt.info.portrait = IS_PHONE and "portraits_sc_0029" or "kr2_info_portraits_enemies_0003"
    tt.info.enc_icon = 3
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 28
    tt.melee.attacks[1].damage_min = 12
    tt.melee.attacks[1].hit_time = fts(22)
    tt.motion.max_speed = 0.854 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_immortal"
    tt.sound_events.death = "DeathPuff"
    tt.ui.click_rect = r(-20, -5, 40, 50)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.marker_offset = vec_2(0, ady(10))
    tt.unit.mod_offset = vec_2(0, ady(28))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_SKELETON)

    tt = E:register_t("enemy_fallen", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.17
    image_y = 40
    tt.enemy.gold = 0
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.armor = 0
    tt.health.dead_lifetime = 3
    tt.health.hp_max = 120
    tt.health_bar.offset = vec_2(0, ady(42))
    tt.info.portrait = IS_PHONE and "portraits_sc_0032" or "kr2_info_portraits_enemies_0007"
    tt.info.enc_icon = 7
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.remove = scripts.enemy_basic.remove
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 28
    tt.melee.attacks[1].damage_min = 12
    tt.melee.attacks[1].hit_time = fts(20)
    tt.motion.max_speed = 0.747 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].name = "idle"
    tt.render.sprites[1].prefix = "enemy_fallen"
    tt.sound_events.death = "DeathSkeleton"
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, ady(8))
    tt.unit.mod_offset = vec_2(0, ady(21))
    tt.unit.show_blood_pool = false
    tt.unit.blood_color = BLOOD_GRAY
    tt.vis.bans = bor(F_SKELETON, F_POLYMORPH)

    tt = E:register_t("enemy_desert_archer", "enemy")
    E:add_comps(tt, "melee", "ranged")
    anchor_y = 0.2
    image_y = 36
    tt.info.portrait = IS_PHONE and "portraits_sc_0030" or "kr2_info_portraits_enemies_0004"
    tt.info.enc_icon = 4
    tt.unit.hit_offset = vec_2(0, 15)
    tt.unit.marker_offset = vec_2(0, ady(8))
    tt.unit.mod_offset = vec_2(0, ady(20))
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.health.hp_max = 180
    tt.health.armor = 0
    tt.health.magic_armor = 0.3
    tt.health_bar.offset = vec_2(0, ady(39))
    tt.render.sprites[1].prefix = "enemy_desertarcher"
    tt.render.sprites[1].anchor.y = anchor_y
    tt.motion.max_speed = 1.28 * FPS
    tt.enemy.gold = 12
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.melee.attacks[1].hit_time = fts(6)
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].damage_max = 20
    tt.ranged.attacks[1].bullet = "arrow_desert_archer"
    tt.ranged.attacks[1].requires_magic = true
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].shoot_time = fts(5)
    tt.ranged.attacks[1].cooldown = 1 + fts(12)
    tt.ranged.attacks[1].max_range = 147.20000000000002
    tt.ranged.attacks[1].min_range = 25.6
    tt.ranged.attacks[1].animation = "rangedAttack"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(4, 12)}

    tt = E:register_t("arrow_desert_archer", "arrow")
    E:add_comps(tt, "endless")
    tt.bullet.damage_min = 20
    tt.bullet.damage_max = 30
    tt.bullet.pop = nil
    tt.bullet.predict_target_pos = false
    tt.bullet.prediction_error = false
    tt.endless.factor_map = {{"enemy_desert_archer.rangedDamage", "bullet.damage_min", true},
                             {"enemy_desert_archer.rangedDamage", "bullet.damage_max", true}}

    tt = E:register_t("enemy_scorpion", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.16
    image_y = 50
    tt.enemy.gold = 28
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(38, 0)
    tt.health.armor = 0.85
    tt.health.hp_max = 500
    tt.health_bar.offset = vec_2(0, ady(48))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0036" or "kr2_info_portraits_enemies_0011"
    tt.info.enc_icon = 11
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 28
    tt.melee.attacks[1].damage_min = 12
    tt.melee.attacks[1].hit_time = fts(20)
    tt.melee.attacks[2] = E:clone_c("melee_attack")
    tt.melee.attacks[2].animation = "poison"
    tt.melee.attacks[2].cooldown = 10
    tt.melee.attacks[2].damage_max = nil
    tt.melee.attacks[2].damage_min = nil
    tt.melee.attacks[2].hit_time = fts(20)
    tt.melee.attacks[2].mod = "mod_poison"
    tt.melee.attacks[2].vis_flags = bor(F_POISON)
    tt.motion.max_speed = 0.854 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_scorpion"
    tt.sound_events.death = "DeathEplosion"
    tt.ui.click_rect = IS_PHONE and r(-25, -5, 50, 50) or r(-20, -5, 40, 25)
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.hit_offset = vec_2(0, 12)
    tt.unit.marker_offset = vec_2(0, ady(8))
    tt.unit.mod_offset = vec_2(0, ady(20))
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_SKELETON)

    tt = E:register_t("enemy_tremor", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.42
    image_y = 52
    tt.enemy.gold = 10
    tt.enemy.melee_slot = vec_2(24, 0)
    tt.health.hp_max = 120
    tt.health_bar.offset = vec_2(0, ady(44))
    tt.info.portrait = IS_PHONE and "portraits_sc_0035" or "kr2_info_portraits_enemies_0010"
    tt.info.enc_icon = 10
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_tremor.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 8
    tt.melee.attacks[1].damage_min = 4
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 1.6 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_tremor"
    tt.sound_events.death = "DeathEplosion"
    tt.ui.click_rect = IS_PHONE and r(-20, -10, 40, 40) or r(-15, -5, 30, 30)
    tt.unit.hit_offset = vec_2(0, 8)
    tt.unit.marker_offset = vec_2(0, -2)
    tt.unit.mod_offset = vec_2(1, ady(30))
    tt.vis.bans_above_surface = bor(F_SKELETON)
    tt.vis.bans_below_surface = bor(F_RANGED, F_SKELETON, F_MOD, F_AREA, F_POLYMORPH)
    tt.vis.bans = tt.vis.bans_below_surface

    tt = E:register_t("enemy_wasp", "enemy")
    anchor_y = 0
    image_y = 66
    tt.enemy.gold = 8
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 80
    tt.health_bar.offset = vec_2(0, ady(67))
    tt.info.portrait = IS_PHONE and "portraits_sc_0037" or "kr2_info_portraits_enemies_0012"
    tt.info.enc_icon = 12
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_passive.update
    tt.motion.max_speed = 1.387 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_wasp"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].offset = vec_2(0, 0)
    tt.sound_events.new_node = "WaspTaunt"
    tt.sound_events.new_node_args = {
        gain = {0.3, 0.6}
    }
    tt.sound_events.death = "DeathPuff"
    tt.ui.click_rect = IS_PHONE and r(-20, 25, 40, 50) or r(-10, 34, 20, 20)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 52)
    tt.unit.mod_offset = vec_2(0, ady(47))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_BLOCK, F_SKELETON, F_EAT)
    tt.vis.flags = bor(F_ENEMY, F_FLYING)

    tt = E:register_t("enemy_wasp_queen", "enemy")
    E:add_comps(tt, "death_spawns")
    anchor_y = 0
    image_y = 94
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.name = "enemy_wasp"
    tt.death_spawns.quantity = 5
    tt.death_spawns.spread_nodes = 3
    tt.enemy.gold = 40
    tt.enemy.lives_cost = 5
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 400
    tt.health_bar.offset = vec_2(0, ady(85))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0038" or "kr2_info_portraits_enemies_0013"
    tt.info.enc_icon = 13
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_passive.update
    tt.motion.max_speed = 1.07 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_wasp_queen"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].offset = vec_2(0, 0)
    tt.sound_events.new_node = "WaspTaunt"
    tt.sound_events.new_node_args = {
        gain = {0.3, 0.6}
    }
    tt.sound_events.death = "DeathPuff"
    tt.ui.click_rect = IS_PHONE and r(-25, 30, 50, 60) or r(-15, 38, 30, 40)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 58)
    tt.unit.mod_offset = vec_2(0, ady(60))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_BLOCK, F_SKELETON, F_EAT)
    tt.vis.flags = bor(F_ENEMY, F_FLYING)

    tt = E:register_t("enemy_executioner", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.19
    image_y = 90
    tt.enemy.gold = 130
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(29, 0)
    tt.health.dead_lifetime = 3
    tt.health.hp_max = 2000
    tt.health_bar.offset = vec_2(0, ady(87))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0031" or "kr2_info_portraits_enemies_0005"
    tt.info.enc_icon = 5
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].damage_max = 60
    tt.melee.attacks[1].damage_min = 30
    tt.melee.attacks[1].dodge_time = fts(11)
    tt.melee.attacks[1].hit_decal = "decal_ground_hit"
    tt.melee.attacks[1].hit_fx = "fx_ground_hit"
    tt.melee.attacks[1].hit_offset = vec_2(30, 0)
    tt.melee.attacks[1].hit_time = fts(15)
    tt.melee.attacks[1].instakill = true
    tt.melee.attacks[1].shared_cooldown = true
    tt.melee.attacks[1].sound_hit = "AreaAttack"
    tt.melee.attacks[1].vis_bans = F_HERO
    tt.melee.attacks[2] = table.deepclone(tt.melee.attacks[1])
    tt.melee.attacks[2].instakill = nil
    tt.melee.attacks[2].vis_bans = 0
    tt.melee.cooldown = 1.5
    tt.motion.max_speed = 0.64 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_executioner"
    tt.sound_events.death = "DeathBig"
    tt.ui.click_rect = r(-25, -5, 50, 65)
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 25)
    tt.unit.pop_offset = vec_2(0, 20)
    tt.unit.marker_offset = vec_2(0, ady(16))
    tt.unit.mod_offset = vec_2(0, ady(39))
    tt.unit.size = UNIT_SIZE_MEDIUM

    tt = E:register_t("enemy_munra", "enemy")
    E:add_comps(tt, "melee", "ranged", "timed_attacks", "count_group")
    anchor_y = 0.17
    image_y = 44
    tt.count_group.name = "enemy_munra"
    tt.count_group.type = COUNT_GROUP_CONCURRENT
    tt.enemy.gold = 100
    tt.enemy.melee_slot = vec_2(19, 0)
    tt.health.hp_max = 1000
    tt.health_bar.offset = vec_2(0, ady(39))
    tt.info.portrait = IS_PHONE and "portraits_sc_0032" or "kr2_info_portraits_enemies_0006"
    tt.info.enc_icon = 6
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_munra.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 60
    tt.melee.attacks[1].damage_min = 30
    tt.melee.attacks[1].hit_time = fts(13)
    tt.motion.max_speed = 0.427 * FPS
    tt.ranged.attacks[1].animation = "ranged_attack"
    tt.ranged.attacks[1].bullet = "bolt_munra"
    tt.ranged.attacks[1].requires_magic = true
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(-9, ady(37))}
    tt.ranged.attacks[1].cooldown = 1.3
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].max_range = 115.2
    tt.ranged.attacks[1].min_range = 25.6
    tt.ranged.attacks[1].shoot_time = fts(11)
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_munra"
    tt.sound_events.death = "DeathPuff"
    tt.timed_attacks.list[1] = E:clone_c("spawn_attack")
    tt.timed_attacks.list[1].animation = "summon"
    tt.timed_attacks.list[1].cooldown = 8
    tt.timed_attacks.list[1].entity = "munra_sarcophagus"
    tt.timed_attacks.list[1].node_random_max = 40
    tt.timed_attacks.list[1].node_random_min = 20
    tt.timed_attacks.list[1].nodes_limit = 50
    tt.timed_attacks.list[1].sound = "SandwraithCoffin"
    tt.timed_attacks.list[1].spawn_time = fts(12)
    tt.timed_attacks.list[1].count_group_name = "munra_sarcophagus"
    tt.timed_attacks.list[1].count_group_type = COUNT_GROUP_CONCURRENT
    tt.timed_attacks.list[1].count_group_max = 35
    tt.timed_attacks.list[2] = E:clone_c("mod_attack")
    tt.timed_attacks.list[2].animation = "heal"
    tt.timed_attacks.list[2].cooldown = 8
    tt.timed_attacks.list[2].max_per_cast = 3
    tt.timed_attacks.list[2].mod = "mod_munra_heal"
    tt.timed_attacks.list[2].range = 96
    tt.timed_attacks.list[2].shoot_time = fts(13)
    tt.timed_attacks.list[2].sound = "EnemyHealing"
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 9)
    tt.unit.marker_offset = vec_2(0, ady(5))
    tt.unit.mod_offset = vec_2(0, ady(20))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_SKELETON)
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)

    tt = E:register_t("mod_munra_heal", "modifier")
    E:add_comps(tt, "hps", "render", "endless")
    tt.modifier.duration = fts(24)
    tt.hps.heal_min = 100
    tt.hps.heal_max = 100
    tt.hps.heal_every = 9e+99
    tt.render.sprites[1].prefix = "healing"
    tt.render.sprites[1].size_names = {"small", "medium", "large"}
    tt.render.sprites[1].name = "small"
    tt.main_script.insert = scripts.mod_hps.insert
    tt.main_script.update = scripts.mod_hps.update
    tt.endless.factor_map = {{"enemy_munra.healPoints", "hps.heal_min", true},
                             {"enemy_munra.healPoints", "hps.heal_max", true}}

    tt = E:register_t("bolt_munra", "bolt_enemy")
    E:add_comps(tt, "endless")
    tt.render.sprites[1].prefix = "bolt_munra"
    tt.bullet.align_with_trajectory = true
    tt.bullet.damage_max = 40
    tt.bullet.damage_min = 20
    tt.bullet.max_speed = 390
    tt.bullet.hit_fx = "fx_bolt_munra_hit"
    tt.bullet.max_track_distance = 50
    tt.endless.factor_map = {{"enemy_munra.rangedDamage", "bullet.damage_min", true},
                             {"enemy_munra.rangedDamage", "bullet.damage_max", true}}

    tt = E:register_t("fx_bolt_munra_hit", "fx")
    tt.render.sprites[1].name = "bolt_munra_hit"

    tt = E:register_t("munra_sarcophagus", "decal_scripted")
    E:add_comps(tt, "render", "spawner")
    tt.main_script.update = scripts.enemies_spawner.update
    tt.render.sprites[1].anchor.y = 0.25
    tt.render.sprites[1].flip_x = true
    tt.render.sprites[1].prefix = "munra_sarcophagus"
    tt.spawner.allowed_subpaths = {1, 3}
    tt.spawner.animation_start = "start"
    tt.spawner.animation_end = "end"
    tt.spawner.count = 4
    tt.spawner.cycle_time = fts(75)
    tt.spawner.entity = "enemy_fallen"
    tt.spawner.forced_waypoint_offset = vec_2(-25, 1)
    tt.spawner.node_offset = 5
    tt.spawner.pos_offset = vec_2(0, 1)
    tt.spawner.random_subpath = false

    tt = E:register_t("enemy_efreeti_small", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.11
    image_y = 64
    tt.enemy.gold = 20
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(24, 0)
    tt.health.armor = 0
    tt.health.hp_max = 250
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(62))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0039" or "kr2_info_portraits_enemies_0014"
    tt.info.enc_icon = 15
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_max = 60
    tt.melee.attacks[1].damage_min = 30
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 1.07 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].name = "idle"
    tt.render.sprites[1].prefix = "enemy_efreeti_small"
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.marker_offset = vec_2(0, ady(6))
    tt.unit.mod_offset = vec_2(0, ady(24))
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.sound_events.death = "DeathPuff"

    tt = E:register_t("enemy_cannibal", "enemy")
    E:add_comps(tt, "melee", "water")
    anchor_y = 0.21428571428571427
    image_y = 42
    tt.cannibalize = {}
    tt.cannibalize.extra_hp = 50
    tt.cannibalize.hps = 3 * FPS
    tt.cannibalize.max_hp = 600
    tt.enemy.gold = 15
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.armor = 0
    tt.health.hp_max = 250
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(44))
    tt.info.portrait = IS_PHONE and "portraits_sc_0044" or "kr2_info_portraits_enemies_0019"
    tt.info.enc_icon = 18
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_cannibal.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 20
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 0.96 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_cannibal"
    tt.sound_events.cannibalize = "CanibalEating"
    tt.sound_events.water_splash = "SpecialMermaid"
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, ady(10))
    tt.unit.mod_offset = vec_2(0, ady(23))
    tt.water.hit_offset = vec_2(0, 5)
    tt.water.mod_offset = vec_2(0, 5)
    tt.water.health_bar_hidden = true

    tt = E:register_t("enemy_hunter", "enemy")
    E:add_comps(tt, "melee", "ranged", "water")
    anchor_y = 0.25
    image_y = 44
    tt.enemy.gold = 15
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.armor = 0
    tt.health.hp_max = 150
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(46))
    tt.info.portrait = IS_PHONE and "portraits_sc_0045" or "kr2_info_portraits_enemies_0020"
    tt.info.enc_icon = 19
    tt.main_script.insert = scripts.enemy_hunter.insert
    tt.main_script.update = scripts.enemy_mixed_water.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 20
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 1.387 * FPS
    tt.ranged.attacks[1].bullet = "dart"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(5, 25)}
    tt.ranged.attacks[1].cooldown = fts(22)
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].max_range = 147.2
    tt.ranged.attacks[1].min_range = 40
    tt.ranged.attacks[1].shoot_time = fts(11)
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_hunter"
    tt.sound_events.water_splash = "SpecialMermaid"
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, ady(11))
    tt.unit.mod_offset = vec_2(0, ady(24))
    tt.water.hit_offset = vec_2(0, 5)
    tt.water.mod_offset = vec_2(0, 5)
    tt.water.health_bar_hidden = true

    tt = E:register_t("dart", "arrow")
    tt.bullet.miss_decal = "DartDecal"
    tt.bullet.flight_time = fts(17)
    tt.bullet.mod = "mod_dart_poison"
    tt.bullet.damage_max = 20
    tt.bullet.damage_min = 10
    tt.bullet.predict_target_pos = false
    tt.bullet.prediction_error = false
    tt.render.sprites[1].name = "Dart"
    tt.render.sprites[1].animated = false
    tt.pop = nil

    tt = E:register_t("mod_dart_poison", "mod_poison")
    tt.modifier.duration = 4
    tt.dps.damage_min = 3
    tt.dps.damage_max = 3

    tt = E:register_t("enemy_shaman_priest", "enemy")
    E:add_comps(tt, "melee", "auras")
    anchor_y = 0.18
    image_y = 62
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "shaman_priest_aura"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 50
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.health.armor = 0
    tt.health.hp_max = 700
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(50))
    tt.info.portrait = IS_PHONE and "portraits_sc_0046" or "kr2_info_portraits_enemies_0021"
    tt.info.enc_icon = 20
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 26
    tt.melee.attacks[1].damage_min = 14
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 0.96 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_shaman_priest"
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, ady(11))
    tt.unit.mod_offset = vec_2(0, ady(26))
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)

    tt = E:register_t("shaman_priest_aura", "aura")
    E:add_comps(tt, "render")
    tt.aura.mod = "mod_shaman_priest_heal"
    tt.aura.cycle_time = 4
    tt.aura.duration = -1
    tt.aura.radius = 128
    tt.aura.requires_magic = true
    tt.aura.track_source = true
    tt.aura.targets_per_cycle = 10
    tt.aura.vis_bans = bor(F_FRIEND, F_HERO, F_BOSS)
    tt.aura.vis_flags = F_MOD
    tt.aura.hide_source_fx = true
    tt.main_script.insert = scripts.aura_apply_mod.insert
    tt.main_script.update = scripts.aura_apply_mod.update
    tt.render.sprites[1].name = "shaman_priest_healing"
    tt.render.sprites[1].loop = true

    tt = E:register_t("mod_shaman_priest_heal", "modifier")
    E:add_comps(tt, "hps", "render")
    tt.modifier.duration = fts(24)
    tt.hps.heal_min = 50
    tt.hps.heal_max = 50
    tt.hps.heal_every = 9e+99
    tt.render.sprites[1].prefix = "healing"
    tt.render.sprites[1].size_names = {"small", "medium", "large"}
    tt.render.sprites[1].name = "small"
    tt.render.sprites[1].loop = false
    tt.main_script.insert = scripts.mod_hps.insert
    tt.main_script.update = scripts.mod_hps.update

    tt = E:register_t("enemy_shaman_magic", "enemy")
    E:add_comps(tt, "melee", "auras")
    anchor_y = 0.18
    image_y = 62
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].cooldown = 0
    tt.auras.list[1].name = "shaman_magic_aura"
    tt.enemy.gold = 50
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.health.armor = 0
    tt.health.hp_max = 700
    tt.health.magic_armor = 0.9
    tt.health_bar.offset = vec_2(0, ady(50))
    tt.info.portrait = IS_PHONE and "portraits_sc_0048" or "kr2_info_portraits_enemies_0023"
    tt.info.enc_icon = 22
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 26
    tt.melee.attacks[1].damage_min = 14
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 0.96 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_shaman_magic"
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, ady(11))
    tt.unit.mod_offset = vec_2(0, ady(26))
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)

    tt = E:register_t("shaman_magic_aura", "aura")
    E:add_comps(tt, "render")
    tt.aura.allowed_templates = {"enemy_hunter", "enemy_cannibal", "enemy_shaman_priest", "enemy_shaman_shield",
                                 "enemy_shaman_necro"}
    tt.aura.cycle_time = 1
    tt.aura.duration = -1
    tt.aura.mod = "mod_shaman_magic_armor"
    tt.aura.radius = 115.2
    tt.aura.requires_magic = true
    tt.aura.targets_per_cycle = 10
    tt.aura.track_source = true
    tt.aura.vis_bans = bor(F_FRIEND, F_HERO, F_BOSS)
    tt.aura.vis_flags = F_MOD
    tt.main_script.insert = scripts.aura_apply_mod.insert
    tt.main_script.update = scripts.aura_apply_mod.update
    tt.render.sprites[1].loop = true
    tt.render.sprites[1].name = "shaman_magic_aura"

    tt = E:register_t("mod_shaman_magic_armor", "modifier")
    E:add_comps(tt, "render", "armor_buff")
    tt.armor_buff.cycle_time = 1
    tt.armor_buff.magic = true
    tt.armor_buff.max_factor = 0.8
    tt.armor_buff.step_factor = 0.03
    tt.main_script.insert = scripts.mod_armor_buff.insert
    tt.main_script.remove = scripts.mod_armor_buff.remove
    tt.main_script.update = scripts.mod_armor_buff.update
    tt.modifier.duration = 1.5
    tt.render.sprites[1].name = "shaman_magic_mod"

    tt = E:register_t("enemy_shaman_shield", "enemy")
    E:add_comps(tt, "melee", "auras")
    anchor_y = 0.16
    image_y = 62
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "shaman_shield_aura"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 50
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.health.armor = 0.8
    tt.health.hp_max = 700
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(47))
    tt.info.portrait = IS_PHONE and "portraits_sc_0047" or "kr2_info_portraits_enemies_0022"
    tt.info.enc_icon = 21
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 26
    tt.melee.attacks[1].damage_min = 14
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 0.96 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_shaman_shield"
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, ady(10))
    tt.unit.mod_offset = vec_2(0, ady(26))
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)

    tt = E:register_t("shaman_shield_aura", "aura")
    E:add_comps(tt, "render")
    tt.aura.mod = "mod_shaman_armor"
    tt.aura.cycle_time = 1
    tt.aura.duration = -1
    tt.aura.radius = 115.2
    tt.aura.track_source = true
    tt.aura.targets_per_cycle = 10
    tt.aura.vis_bans = bor(F_FRIEND, F_HERO, F_BOSS)
    tt.aura.vis_flags = F_MOD
    tt.aura.allowed_templates = {"enemy_hunter", "enemy_cannibal", "enemy_shaman_priest", "enemy_shaman_magic",
                                 "enemy_shaman_necro"}
    tt.aura.requires_magic = true
    tt.main_script.insert = scripts.aura_apply_mod.insert
    tt.main_script.update = scripts.aura_apply_mod.update
    tt.render.sprites[1].name = "shaman_shield_aura"
    tt.render.sprites[1].loop = true

    tt = E:register_t("mod_shaman_armor", "modifier")
    E:add_comps(tt, "render", "armor_buff")
    tt.modifier.duration = 1.5
    tt.modifier.use_mod_offset = false
    tt.armor_buff.magic = false
    tt.armor_buff.max_factor = 0.8
    tt.armor_buff.step_factor = 0.03
    tt.armor_buff.cycle_time = 1
    tt.render.sprites[1].name = "buff_armor"
    tt.render.sprites[1].animated = false
    tt.render.sprites[1].anchor.y = 0.15625
    tt.main_script.insert = scripts.mod_armor_buff.insert
    tt.main_script.remove = scripts.mod_armor_buff.remove
    tt.main_script.update = scripts.mod_armor_buff.update

    tt = E:register_t("enemy_shaman_necro", "enemy")
    E:add_comps(tt, "melee", "ranged", "timed_attacks")
    anchor_y = 0.22
    image_y = 58
    tt.enemy.gold = 50
    tt.enemy.melee_slot = vec_2(21, 0)
    tt.health.armor = 0
    tt.health.hp_max = 900
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(51))
    tt.info.portrait = IS_PHONE and "portraits_sc_0049" or "kr2_info_portraits_enemies_0024"
    tt.info.enc_icon = 23
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_shaman_necro.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 30
    tt.melee.attacks[1].damage_min = 15
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 0.96 * FPS
    tt.ranged.attacks[1].bullet = "bolt_shaman_necro"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(-8, 32)}
    tt.ranged.attacks[1].cooldown = 1 + fts(28)
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].max_range = 147.2
    tt.ranged.attacks[1].min_range = 25.6
    tt.ranged.attacks[1].shoot_time = fts(11)
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_shaman_necro"
    tt.timed_attacks.list[1] = E:clone_c("custom_attack")
    tt.timed_attacks.list[1].allowed_templates = {"enemy_cannibal", "enemy_hunter", "enemy_shaman_shield",
                                                  "enemy_shaman_magic", "enemy_shaman_priest"}
    tt.timed_attacks.list[1].animation = "necromancer"
    tt.timed_attacks.list[1].cast_time = fts(16)
    tt.timed_attacks.list[1].cooldown = 1
    tt.timed_attacks.list[1].max_range = 179.2
    tt.timed_attacks.list[1].sound = "CanibalNecromancer"
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, ady(12))
    tt.unit.mod_offset = vec_2(0, ady(26))
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)

    tt = E:register_t("bolt_shaman_necro", "bolt_enemy")
    tt.render.sprites[1].prefix = "bolt_shaman_necro"
    tt.render.sprites[1].anchor = vec_2(0.625, 0.5)
    tt.bullet.align_with_trajectory = true
    tt.bullet.damage_max = 50
    tt.bullet.damage_min = 30
    tt.bullet.max_speed = 450
    tt.bullet.max_track_distance = 50
    tt.bullet.damage_type = DAMAGE_TRUE
    tt.bullet.hit_fx = "fx_bolt_shaman_necro_hit"

    tt = E:register_t("fx_bolt_shaman_necro_hit", "fx")
    tt.render.sprites[1].name = "bolt_shaman_necro_hit"

    tt = E:register_t("enemy_cannibal_zombie", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.2
    image_y = 48
    tt.enemy.gold = 0
    tt.enemy.melee_slot = vec_2(17, 0)
    tt.health.armor = 0
    tt.health.hp_max = 500
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(42))
    tt.info.portrait = IS_PHONE and "portraits_sc_0056" or "kr2_info_portraits_enemies_0028"
    tt.info.enc_icon = 24
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 50
    tt.melee.attacks[1].damage_min = 30
    tt.melee.attacks[1].hit_time = fts(12)
    tt.melee.attacks[1].sound = "CanibalZombie"
    tt.motion.max_speed = 0.64 * FPS
    tt.render.sprites[1].prefix = "enemy_cannibal_zombie"
    tt.render.sprites[1].anchor.y = anchor_y
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, ady(10))
    tt.unit.mod_offset = vec_2(0, ady(21))
    tt.sound_events.insert = "CanibalZombie"
    tt.vis.bans = F_POLYMORPH

    tt = E:register_t("enemy_jungle_spider_tiny", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.17
    image_y = 32
    tt.enemy.gold = 0
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.health.armor = 0
    tt.health.hp_max = {15, 20, 25}
    tt.health.magic_armor = 0.5
    tt.health_bar.offset = vec_2(0, ady(24))
    tt.info.portrait = IS_PHONE and "portraits_sc_0043" or "kr2_info_portraits_enemies_0018"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 5
    tt.melee.attacks[1].damage_min = 1
    tt.melee.attacks[1].hit_time = fts(12)
    tt.melee.attacks[1].sound_hit = "SpiderAttack"
    tt.motion.max_speed = 3.2 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_jungle_spider_tiny"
    tt.ui.click_rect = IS_PHONE and r(-20, -5, 40, 40) or r(-10, -5, 20, 20)
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.hit_offset = vec_2(0, 10)
    tt.unit.marker_offset = vec_2(0, ady(5))
    tt.unit.mod_offset = vec_2(0, ady(17))
    tt.unit.explode_fx = "fx_spider_explode"
    tt.sound_events.death = "DeathEplosion"
    tt.sound_events.death_args = {
        gain = 0.2
    }
    tt.vis.bans = bor(F_SKELETON, F_POISON)

    tt = E:register_t("enemy_jungle_spider_small", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.17
    image_y = 34
    tt.enemy.gold = 8
    tt.enemy.melee_slot = vec_2(22, 0)
    tt.health.armor = 0
    tt.health.hp_max = 100
    tt.health.magic_armor = 0.65
    tt.health_bar.offset = vec_2(0, ady(35))
    tt.info.portrait = IS_PHONE and "portraits_sc_0041" or "kr2_info_portraits_enemies_0016"
    tt.info.enc_icon = 16
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 20
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(12)
    tt.melee.attacks[1].sound_hit = "SpiderAttack"
    tt.motion.max_speed = 1.6 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_jungle_spider_small"
    tt.ui.click_rect = IS_PHONE and r(-20, -5, 40, 40) or r(-15, -5, 30, 30)
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.hit_offset = vec_2(0, 12)
    tt.unit.marker_offset = vec_2(0, ady(5))
    tt.unit.mod_offset = vec_2(0, ady(17))
    tt.unit.explode_fx = "fx_spider_explode"
    tt.sound_events.death = "DeathEplosion"
    tt.sound_events.death_args = {
        gain = 0.3
    }
    tt.vis.bans = bor(F_SKELETON, F_POISON)

    tt = E:register_t("enemy_jungle_spider_big", "enemy")
    E:add_comps(tt, "melee", "timed_attacks")
    anchor_y = 0.19
    image_y = 50
    tt.enemy.gold = 40
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(24, 0)
    tt.health.armor = 0
    tt.health.hp_max = 500
    tt.health.magic_armor = 0.8
    tt.health_bar.offset = vec_2(0, ady(49))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0042" or "kr2_info_portraits_enemies_0017"
    tt.info.enc_icon = 17
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_spider_big.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 40
    tt.melee.attacks[1].damage_min = 20
    tt.melee.attacks[1].hit_time = fts(12)
    tt.melee.attacks[1].sound_hit = "SpiderAttack"
    tt.motion.max_speed = 1.6 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_jungle_spider_big"
    tt.sound_events.death = "DeathEplosion"
    tt.timed_attacks.list[1] = E:clone_c("bullet_attack")
    tt.timed_attacks.list[1].bullet = "jungle_spider_egg"
    tt.timed_attacks.list[1].max_cooldown = 6
    tt.timed_attacks.list[1].max_count = 3
    tt.timed_attacks.list[1].min_cooldown = 2
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.explode_fx = "fx_spider_explode"
    tt.unit.hit_offset = vec_2(0, 12)
    tt.unit.marker_offset = vec_2(0, ady(6))
    tt.unit.mod_offset = vec_2(0, ady(17))
    tt.vis.bans = bor(F_SKELETON, F_POISON)

    tt = E:register_t("jungle_spider_egg", "decal_scripted")
    E:add_comps(tt, "render", "spawner", "tween")
    tt.main_script.update = scripts.enemies_spawner.update
    tt.render.sprites[1].anchor.y = 0.22
    tt.render.sprites[1].prefix = "jungle_spider_egg"
    tt.render.sprites[1].loop = false
    tt.spawner.count = 3
    tt.spawner.cycle_time = fts(6)
    tt.spawner.entity = "enemy_jungle_spider_tiny"
    tt.spawner.node_offset = 5
    tt.spawner.pos_offset = vec_2(0, 1)
    tt.spawner.allowed_subpaths = {1, 2, 3}
    tt.spawner.random_subpath = false
    tt.spawner.animation_start = "start"
    tt.tween.disabled = true
    tt.tween.props[1].keys = {{0, 255}, {4, 0}}
    tt.tween.remove = true

    tt = E:register_t("enemy_gorilla", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.12
    image_y = 108
    tt.enemy.gold = 160
    tt.enemy.lives_cost = 5
    tt.enemy.melee_slot = vec_2(29, 0)
    tt.health.armor = 0
    tt.health.hp_max = 2800
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(93))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0050" or "kr2_info_portraits_enemies_0025"
    tt.info.enc_icon = 25
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1] = E:clone_c("area_attack")
    tt.melee.attacks[1].cooldown = 2.5
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].damage_max = 80
    tt.melee.attacks[1].damage_min = 40
    tt.melee.attacks[1].damage_radius = 51.2
    tt.melee.attacks[1].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[1].hit_decal = "decal_ground_hit"
    tt.melee.attacks[1].hit_fx = "fx_ground_hit"
    tt.melee.attacks[1].hit_offset = vec_2(30, 0)
    tt.melee.attacks[1].hit_time = fts(15)
    tt.melee.attacks[1].sound_hit = "AreaAttack"
    tt.motion.max_speed = 0.854 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_gorilla"
    tt.sound_events.death = "DeathBig"
    tt.ui.click_rect = r(-25, -10, 50, 70)
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 24)
    tt.unit.marker_offset = vec_2(0, ady(13))
    tt.unit.mod_offset = vec_2(0, ady(36))
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_EAT)

    tt = E:register_t("alien_egg", "decal_scripted")
    E:add_comps(tt, "spawner", "sound_events")
    tt.main_script.update = scripts.alien_egg.update
    tt.render.sprites[1].prefix = "alien_egg"
    tt.sound_events.destroy = "SpecialAlienEggOpen"
    tt.sound_events.open = "SpecialAlienEggOpen"
    tt.spawner.count = 3
    tt.spawner.cycle_time = 0.25
    tt.spawner.entity = "enemy_alien_breeder"
    tt.spawner.random_subpath = true
    tt.spawner.eternal = true
    tt.spawner.ni = 1

    tt = E:register_t("enemy_alien_breeder", "enemy")
    E:add_comps(tt, "track_kills", "tween")
    anchor_y = 0.23
    image_y = 40
    tt.enemy.gold = 5
    tt.enemy.melee_slot = vec_2(17, 0)
    tt.health.armor = 0
    tt.health.hp_max = 140
    tt.health.magic_armor = 0.6
    tt.health_bar.offset = vec_2(0, ady(30))
    tt.info.portrait = IS_PHONE and "portraits_sc_0053" or "kr2_info_portraits_enemies_0053"
    tt.info.enc_icon = 27
    tt.info.fn = scripts.enemy_alien_breeder.get_info
    tt.main_script.insert = scripts.enemy_alien_breeder.insert
    tt.main_script.update = scripts.enemy_alien_breeder.update
    tt.motion.max_speed = 2.454 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_alien_breeder"
    tt.sound_events.death = "DeathEplosion"
    tt.spawn_bans = {"soldier_sand_warrior", "soldier_death_rider", "soldier_skeleton_knight", "soldier_skeleton",
                     "soldier_frankenstein", "soldier_dracolich_golem"}
    tt.tween.props[1].name = "offset"
    tt.tween.disabled = true
    tt.tween.remove = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 10)
    tt.unit.marker_offset = vec_2(0, ady(9))
    tt.unit.mod_offset = vec_2(0, ady(19))
    tt.vis.bans = bor(F_SKELETON)
    tt.facehug_offsets = {}
    tt.facehug_offsets.soldier_default = vec_2(2, -2)
    tt.facehug_offsets.soldier_templar = vec_2(2, 0)
    tt.facehug_offsets.soldier_assassin = vec_2(2, 0)
    tt.facehug_offsets.soldier_death_rider = vec_2(3, 16)
    tt.facehug_offsets.soldier_frankenstein = vec_2(0, 41)
    tt.facehug_offsets.hero_default = vec_2(0, 4)
    tt.facehug_offsets.hero_alien = vec_2(0, 10)
    tt.facehug_offsets.hero_beastmaster = vec_2(0, 8)
    tt.facehug_offsets.hero_giant = vec_2(0, 20)
    tt.facehug_offsets.hero_pirate = vec_2(0, 6)
    tt.facehug_offsets.hero_priest = vec_2(0, 7)
    tt.facehug_offsets.hero_wizard = vec_2(0, 6)
    tt.facehug_offsets.hero_voodoo_witch = vec_2(3, 4)
    tt.facehug_offsets.hero_crab = vec_2(6, 7)
    tt.facehug_offsets.hero_minotaur = vec_2(11, 14)
    tt.facehug_offsets.hero_monk = vec_2(0, 2)
    tt.facehug_offsets.hero_monkey_god = vec_2(10, 5)
    tt.facehug_offsets.hero_vampiress = vec_2(0, 20)
    tt.facehug_offsets.hero_van_helsing = vec_2(1, 5)

    tt = E:register_t("enemy_alien_reaper", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.13
    image_y = 50
    tt.enemy.gold = 10
    tt.enemy.melee_slot = vec_2(29, 0)
    tt.health.armor = 0
    tt.health.hp_max = 500
    tt.health.magic_armor = 0.6
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.health_bar.offset = vec_2(0, ady(50))
    tt.info.portrait = IS_PHONE and "portraits_sc_0054" or "kr2_info_portraits_enemies_0054"
    tt.info.enc_icon = 28
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 60
    tt.melee.attacks[1].damage_min = 30
    tt.melee.attacks[1].hit_time = fts(9)
    tt.motion.max_speed = 1.067 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_alien_reaper"
    tt.ui.click_rect = IS_PHONE and r(-25, -10, 50, 50) or r(-15, -5, 30, 40)
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 24)
    tt.unit.marker_offset = vec_2(0, ady(6))
    tt.unit.mod_offset = vec_2(0, ady(18))
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.sound_events.death = "DeathEplosion"
    tt.vis.bans = bor(F_SKELETON)

    tt = E:register_t("enemy_savage_bird", "enemy")
    anchor_y = 0
    image_y = 112
    tt.enemy.gold = 15
    tt.health.armor = 0
    tt.health.hp_max = 150
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(84))
    tt.info.portrait = IS_PHONE and "portraits_sc_0052" or "kr2_info_portraits_enemies_0057"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_passive.update
    tt.motion.max_speed = 2.134 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_savage_bird"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].offset = vec_2(0, 0)
    tt.sound_events.death = "DeathPuff"
    tt.ui.click_rect = r(-20, 42, 40, 45)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 58)
    tt.unit.marker_offset = vec_2(0, ady(1))
    tt.unit.mod_offset = vec_2(0, ady(60))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_BLOCK, F_SKELETON, F_EAT)
    tt.vis.flags = bor(F_ENEMY, F_FLYING)

    tt = E:register_t("enemy_savage_bird_rider", "enemy")
    E:add_comps(tt, "ranged", "death_spawns")
    anchor_y = 0
    image_y = 112
    tt.info.portrait = IS_PHONE and "portraits_sc_0051" or "kr2_info_portraits_enemies_0026"
    tt.info.enc_icon = 26
    tt.death_spawns.name = "enemy_savage_bird"
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.fx = "savage_bird_rider_drop_dead"
    tt.death_spawns.fx_flip_to_source = true
    tt.enemy.gold = 25
    tt.health.armor = 0
    tt.health.hp_max = 250
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(90))
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.motion.max_speed = 1.067 * FPS
    tt.ranged.attacks[1].bullet = "savage_bird_spear"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(4, 75)}
    tt.ranged.attacks[1].cooldown = fts(41)
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].max_range = 166.4
    tt.ranged.attacks[1].min_range = 32
    tt.ranged.attacks[1].shoot_time = fts(5)
    tt.ranged.attacks[1].sync_animation = true
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_savage_bird_rider"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].offset = vec_2(0, 0)
    tt.sound_events.death = nil
    tt.ui.click_rect = r(-20, 42, 40, 45)
    tt.unit.death_animation = nil
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 62)
    tt.unit.marker_offset = vec_2(0, ady(1))
    tt.unit.mod_offset = vec_2(0, ady(60))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_BLOCK, F_SKELETON, F_EAT)
    tt.vis.flags = bor(F_ENEMY, F_FLYING)

    tt = E:register_t("savage_bird_rider_drop_dead", "decal")
    E:add_comps(tt, "enemy", "health", "vis", "unit", "heading", "nav_path", "motion", "sound_events")
    tt.health.hp = 0
    tt.health.dead_lifetime = 2
    tt.render.sprites[1].name = "savage_bird_rider_drop_dead"
    tt.render.sprites[1].loop = false
    tt.render.sprites[1].anchor.y = 0
    tt.enemy.necromancer_offset = vec_2(-25, 14)
    tt.sound_events.insert = "DeathHuman"

    tt = E:register_t("savage_bird_spear", "arrow")
    tt.bullet.miss_decal = "decal_spear"
    tt.bullet.flight_time = fts(18)
    tt.bullet.damage_max = 80
    tt.bullet.damage_min = 40
    tt.bullet.predict_target_pos = false
    tt.bullet.prediction_error = false
    tt.render.sprites[1].name = "spear"
    tt.render.sprites[1].animated = false

    tt = E:register_t("enemy_broodguard", "enemy")
    E:add_comps(tt, "melee", "cliff", "auras")
    anchor_y = 0.19
    image_y = 42
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "aura_damage_sprint"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 20
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.armor = 0
    tt.health.hp_max = 300
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(44))
    tt.info.portrait = IS_PHONE and "portraits_sc_0057" or "kr2_info_portraits_enemies_0029"
    tt.info.enc_icon = 29
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed_cliff.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 22
    tt.melee.attacks[1].damage_min = 8
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 1.067 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_broodguard"
    tt.unit.blood_color = BLOOD_VIOLET
    tt.unit.hit_offset = vec_2(0, 16)
    tt.unit.marker_offset = vec_2(0, ady(9))
    tt.unit.mod_offset = vec_2(0, ady(20))
    tt.damage_sprint_factor = 0.78125
    tt.vis.bans = F_POLYMORPH

    tt = E:register_t("aura_damage_sprint", "aura")
    tt.aura.duration = -1
    tt.aura.track_source = true
    tt.main_script.update = scripts.aura_damage_sprint.update
    tt.main_script.insert = scripts.aura_damage_sprint.insert
    tt.main_script.remove = scripts.aura_damage_sprint.remove

    tt = E:register_t("enemy_blazefang", "enemy")
    E:add_comps(tt, "melee", "ranged", "death_spawns")
    anchor_y = 0.2
    image_y = 58
    tt.death_spawns.name = "blazefang_explosion"
    tt.death_spawns.quantity = 1
    tt.death_spawns.concurrent_with_death = true
    tt.unit.explode_when_silenced_death = true
    tt.enemy.gold = 40
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(25, 0)
    tt.health.armor = 0
    tt.health.hp_max = 600
    tt.health.magic_armor = 0.7
    tt.health_bar.offset = vec_2(0, ady(60))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0060" or "kr2_info_portraits_enemies_0032"
    tt.info.enc_icon = 30
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 22
    tt.melee.attacks[1].damage_min = 18
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 0.854 * FPS
    tt.ranged.cooldown = 1 + fts(32)
    tt.ranged.attacks[1].bullet = "bolt_blazefang"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(25, 10), vec_2(12, 22), vec_2(6, 4)}
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].max_range = 147.20000000000002
    tt.ranged.attacks[1].min_range = 25.6
    tt.ranged.attacks[1].shoot_time = fts(24)
    tt.ranged.attacks[1].animation = "ranged"
    tt.ranged.attacks[1].shared_cooldown = true
    tt.ranged.attacks[2] = table.deepclone(tt.ranged.attacks[1])
    tt.ranged.attacks[2].bullet = "bolt_blazefang_instakill"
    tt.ranged.attacks[2].chance = 0.2
    tt.ranged.attacks[2].vis_flags = bor(F_DISINTEGRATED, F_RANGED)
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_blazefang"
    tt.render.sprites[1].angles.ranged = {"ranged_side", "ranged_up", "ranged_down"}
    tt.render.sprites[1].angles_flip_vertical = {
        ranged = true
    }
    tt.render.sprites[1].angles_custom = {
        ranged = {35, 145, 210, 335}
    }
    tt.sound_events.death = "SaurianBlazefangDeath"
    tt.ui.click_rect = r(-25, -10, 50, 55)
    tt.unit.blood_color = BLOOD_VIOLET
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.marker_offset = vec_2(0, ady(10))
    tt.unit.mod_offset = vec_2(0, ady(30))

    tt = E:register_t("blazefang_explosion", "bullet")
    tt.render = nil
    tt.sound_events = nil
    tt.main_script.update = scripts.blazefang_explosion.update
    tt.bullet.damage_min = 100
    tt.bullet.damage_max = 100
    tt.bullet.damage_radius = 76.8

    tt = E:register_t("bolt_blazefang", "bolt_enemy")
    tt.render.sprites[1].prefix = "bolt_blazefang"
    tt.render.sprites[1].anchor = vec_2(0.53, 0.58)
    tt.bullet.align_with_trajectory = true
    tt.bullet.damage_max = 100
    tt.bullet.damage_min = 60
    tt.bullet.max_speed = 1200
    tt.bullet.acceleration_factor = 0.3
    tt.bullet.damage_type = bor(DAMAGE_DISINTEGRATE, DAMAGE_TRUE)
    tt.bullet.hit_fx = "fx_bolt_blazefang_hit"
    tt.bullet.max_track_distance = 50
    tt.sound_events.insert = "SaurianBlazefangAttack"

    tt = E:register_t("bolt_blazefang_instakill", "bolt_blazefang")
    tt.bullet.damage_type = bor(DAMAGE_DISINTEGRATE, DAMAGE_INSTAKILL)

    tt = E:register_t("fx_bolt_blazefang_hit", "fx")
    tt.render.sprites[1].name = "bolt_blazefang_hit"

    tt = E:register_t("enemy_brute", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.16
    image_y = 88
    tt.enemy.gold = 200
    tt.enemy.lives_cost = 5
    tt.enemy.melee_slot = vec_2(29, 0)
    tt.health.armor = 0
    tt.health.hp_max = 4400
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(75))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0063" or "kr2_info_portraits_enemies_0035"
    tt.info.enc_icon = 32
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 120
    tt.melee.attacks[1].damage_min = 60
    tt.melee.attacks[1].damage_type = DAMAGE_TRUE
    tt.melee.attacks[1].dodge_time = fts(6)
    tt.melee.attacks[1].hit_time = fts(10)
    tt.melee.attacks[1].sound_hit = "SaurianBruteAttack"
    tt.melee.attacks[2] = E:clone_c("area_attack")
    tt.melee.attacks[2].animation = "area_attack"
    tt.melee.attacks[2].cooldown = 13.333333333333334
    tt.melee.attacks[2].damage_max = 120
    tt.melee.attacks[2].damage_min = 80
    tt.melee.attacks[2].damage_radius = 38.4
    tt.melee.attacks[2].damage_type = DAMAGE_TRUE
    tt.melee.attacks[2].hit_offset = vec_2(30, 0)
    tt.melee.attacks[2].hit_times = {fts(10), fts(20), fts(30)}
    tt.melee.attacks[2].sound_hit = "SaurianBruteAttack"
    tt.motion.max_speed = 0.64 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_brute"
    tt.sound_events.death = "DeathBig"
    tt.ui.click_rect = r(-25, -10, 50, 65)
    tt.unit.blood_color = BLOOD_VIOLET
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.marker_offset = vec_2(0, ady(15))
    tt.unit.mod_offset = vec_2(0, ady(30))
    tt.unit.size = UNIT_SIZE_MEDIUM

    tt = E:register_t("enemy_myrmidon", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.21
    image_y = 62
    tt.enemy.gold = 50
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(25, 0)
    tt.health.armor = 0.6
    tt.health.hp_max = 800
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(63))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0062" or "kr2_info_portraits_enemies_0034"
    tt.info.enc_icon = 33
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 34
    tt.melee.attacks[1].damage_min = 16
    tt.melee.attacks[1].hit_time = fts(12)
    tt.melee.attacks[2] = E:clone_c("melee_attack")
    tt.melee.attacks[2].animation = "bite_attack"
    tt.melee.attacks[2].cooldown = 12
    tt.melee.attacks[2].damage_max = 150
    tt.melee.attacks[2].damage_min = 75
    tt.melee.attacks[2].mod = "mod_myrmidon_lifesteal"
    tt.melee.attacks[2].sound_hit = "SaurianMyrmidonBite"
    tt.melee.attacks[2].hit_time = fts(5)
    tt.motion.max_speed = 0.854 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_myrmidon"
    tt.ui.click_rect = r(-25, -10, 50, 50)
    tt.unit.can_explode = false
    tt.unit.blood_color = BLOOD_VIOLET
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.marker_offset = vec_2(0, ady(12))
    tt.unit.mod_offset = vec_2(0, ady(30))

    tt = E:register_t("mod_myrmidon_lifesteal", "modifier")
    tt.heal_hp = 125
    tt.main_script.insert = scripts.mod_simple_lifesteal.insert

    tt = E:register_t("enemy_nightscale", "enemy")
    E:add_comps(tt, "melee", "cliff")
    anchor_y = 0.26
    image_y = 48
    tt.enemy.gold = 25
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.armor = 0
    tt.health.hp_max = 350
    tt.health.magic_armor = 0.5
    tt.health_bar.offset = vec_2(0, ady(48))
    tt.info.portrait = IS_PHONE and "portraits_sc_0059" or "kr2_info_portraits_enemies_0031"
    tt.info.enc_icon = 34
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_nightscale.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 42
    tt.melee.attacks[1].damage_min = 28
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 1.28 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_nightscale"
    tt.sound_events.hide = "SaurianNightscaleInvisible"
    tt.unit.blood_color = BLOOD_VIOLET
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, ady(12))
    tt.unit.mod_offset = vec_2(0, ady(22))
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)
    tt.hidden = {}
    tt.hidden.trigger_health_factor = 0.6
    tt.hidden.duration = 8
    tt.hidden.max_times = 1
    tt.hidden.nodeslimit = 25
    tt.hidden.ts = 0

    tt = E:register_t("enemy_darter", "enemy")
    E:add_comps(tt, "melee", "cliff")
    anchor_y = 0.19
    image_y = 36
    tt.enemy.gold = 20
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.armor = 0
    tt.health.hp_max = 250
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(39))
    tt.info.portrait = IS_PHONE and "portraits_sc_0058" or "kr2_info_portraits_enemies_0030"
    tt.info.enc_icon = 31
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_darter.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 22
    tt.melee.attacks[1].damage_min = 18
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 1.6 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_darter"
    tt.sound_events.blink = "SaurianDarterTeleporth"
    tt.unit.blood_color = BLOOD_VIOLET
    tt.unit.hit_offset = vec_2(0, 8)
    tt.unit.marker_offset = vec_2(0, ady(7))
    tt.unit.mod_offset = vec_2(0, ady(16))
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)
    tt.blink = {}
    tt.blink.cooldown = 4
    tt.blink.nodeslimit = 45
    tt.blink.nodeslimit_conn = 15
    tt.blink.nodes_offset_min = 15
    tt.blink.nodes_offset_max = 25
    tt.blink.travel_time = fts(11)
    tt.blink.fx = "fx_darter_blink"
    tt.blink.ts = 0

    tt = E:register_t("fx_darter_blink", "fx")
    tt.render.sprites[1].name = "darter_blink"
    tt.render.sprites[1].anchor.y = 0.22

    tt = E:register_t("enemy_savant", "enemy")
    E:add_comps(tt, "melee", "ranged", "timed_attacks")
    anchor_y = 0.26
    image_y = 42
    tt.enemy.gold = 100
    tt.enemy.melee_slot = vec_2(22, 0)
    tt.health.armor = 0
    tt.health.hp_max = 1000
    tt.health.magic_armor = 0.5
    tt.health_bar.offset = vec_2(0, ady(45))
    tt.info.portrait = IS_PHONE and "portraits_sc_0061" or "kr2_info_portraits_enemies_0033"
    tt.info.enc_icon = 37
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_savant.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 66
    tt.melee.attacks[1].damage_min = 34
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 0.64 * FPS
    tt.ranged.attacks[1].bullet = "savant_ray"
    tt.ranged.attacks[1].shoot_time = fts(18)
    tt.ranged.attacks[1].cooldown = 1.5
    tt.ranged.attacks[1].max_range = 147.20000000000002
    tt.ranged.attacks[1].min_range = 44.800000000000004
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(28, ady(28))}
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_savant"
    tt.timed_attacks.list[1] = E:clone_c("spawn_attack")
    tt.timed_attacks.list[1].animations = {"portal_start", "portal_loop", "portal_end"}
    tt.timed_attacks.list[1].min_cooldown = 5
    tt.timed_attacks.list[1].max_cooldown = 10
    tt.timed_attacks.list[1].entity = "savant_portal"
    tt.timed_attacks.list[1].nodes_limit = 20
    tt.timed_attacks.list[1].node_offset = 12
    tt.timed_attacks.list[1].count_group_name = "savant_portals"
    tt.timed_attacks.list[1].count_group_type = COUNT_GROUP_CONCURRENT
    tt.timed_attacks.list[1].count_group_max = 25
    tt.unit.blood_color = BLOOD_VIOLET
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, ady(9))
    tt.unit.mod_offset = vec_2(0, ady(22))
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)

    tt = E:register_t("savant_portal", "decal_scripted")
    E:add_comps(tt, "render", "spawner", "sound_events")
    tt.main_script.update = scripts.savant_portal.update
    tt.render.sprites[1].anchor.y = 0.5
    tt.render.sprites[1].flip_x = true
    tt.render.sprites[1].prefix = "savant_portal"
    tt.render.sprites[1].z = Z_DECALS
    tt.portal = {}
    tt.portal.entities = {{0.1, "enemy_darter"}, {0.3, "enemy_nightscale"}, {1, "enemy_broodguard"}}
    tt.portal.node_var = {-5, 5}
    tt.portal.cycle_time = 1
    tt.portal.duration = 6
    tt.portal.max_count = 20
    tt.portal.spawn_fx = "fx_darter_blink"
    tt.portal.pi = nil
    tt.portal.spi = nil
    tt.portal.ni = nil
    tt.portal.finished = false
    tt.sound_events.insert = "SaurianSavantOpenPortal"
    tt.sound_events.spawn = "SaurianSavantTeleporth"
    tt.sound_events.loop = "SaurianSavantPortalLoop"

    tt = E:register_t("savant_ray", "bullet")
    tt.image_width = 115
    tt.main_script.update = scripts.ray_enemy.update
    tt.render.sprites[1].name = "savant_ray"
    tt.render.sprites[1].loop = false
    tt.render.sprites[1].anchor = vec_2(0, 0.5)
    tt.bullet.damage_type = DAMAGE_TRUE
    tt.bullet.damage_min = 90
    tt.bullet.damage_max = 160
    tt.bullet.hit_time = fts(3)
    tt.bullet.max_track_distance = 50
    tt.sound_events.insert = "SaurianSavantAttack"

    tt = E:register_t("enemy_sniper", "enemy")
    E:add_comps(tt, "melee", "ranged")
    image_y = 42
    anchor_y = 0.16666666666666666
    tt.info.portrait = IS_PHONE and "portraits_sc_0095" or "kr2_info_portraits_enemies_0041"
    tt.info.enc_icon = 59
    tt.unit.blood_color = BLOOD_VIOLET
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 14)
    tt.main_script.insert = scripts.enemy_sniper.insert
    tt.main_script.update = scripts.enemy_sniper.update
    tt.health.hp_max = 500
    tt.health.armor = 0
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, 37)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.render.sprites[1].prefix = "enemy_sniper"
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].angles.ranged_start = {"ranged_start_side", "ranged_start_up", "ranged_start_down"}
    tt.render.sprites[1].angles.ranged_loop = {"ranged_loop_side", "ranged_loop_up", "ranged_loop_down"}
    tt.render.sprites[1].angles.ranged_end = {"ranged_end_side", "ranged_end_up", "ranged_end_down"}
    tt.render.sprites[1].angles_flip_vertical = {
        ranged_end = true,
        ranged_loop = true,
        ranged_start = true
    }
    tt.render.sprites[1].angles_custom = {
        ranged = {35, 145, 210, 335}
    }
    tt.motion.max_speed = 1.6 * FPS
    tt.enemy.gold = 40
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(25, 0)
    tt.melee.attacks[1].hit_time = fts(10)
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_min = 12
    tt.melee.attacks[1].damage_max = 22
    tt.ranged.attacks[1].bullet = "bolt_sniper"
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].shoot_time = fts(5)
    tt.ranged.attacks[1].cooldown = 2
    tt.ranged.attacks[1].max_range = 450
    tt.ranged.attacks[1].min_range = 51
    tt.ranged.attacks[1].range_var = 100
    tt.ranged.attacks[1].animations = {"ranged_start", "ranged_loop", "ranged_end"}
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(14, ady(21)), vec_2(10, ady(34)), vec_2(8, ady(10))}
    tt = E:register_t("bolt_sniper", "bolt_enemy")
    tt.render.sprites[1].prefix = "bolt_sniper"
    tt.bullet.align_with_trajectory = true
    tt.bullet.damage_max = 100
    tt.bullet.damage_min = 100
    tt.bullet.max_speed = 30 * FPS
    tt.bullet.damage_type = bor(DAMAGE_TRUE)
    tt.bullet.max_track_distance = 50
    tt.sound_events.insert = "SaurianSniperBullet"

    tt = E:register_t("enemy_razorwing", "enemy")
    E:add_comps(tt, "cliff")
    anchor_y = 0
    image_y = 88
    tt.cliff.hide_sprite_ids = {2}
    tt.enemy.gold = 10
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 100
    tt.health_bar.offset = vec_2(0, ady(79))
    tt.info.portrait = IS_PHONE and "portraits_sc_0064" or "kr2_info_portraits_enemies_0036"
    tt.info.enc_icon = 36
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_passive.update
    tt.motion.max_speed = 1.387 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_razorwing"
    tt.render.sprites[1].angles_flip_vertical = {
        walk = true
    }
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].offset = vec_2(0, 0)
    tt.sound_events.death = "DeathPuff"
    tt.ui.click_rect = r(-20, 44, 40, 50)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 64)
    tt.unit.marker_offset = vec_2(0, ady(1))
    tt.unit.mod_offset = vec_2(0, ady(56))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_BLOCK, F_SKELETON, F_EAT)
    tt.vis.flags = bor(F_ENEMY, F_FLYING)

    tt = E:register_t("enemy_quetzal", "enemy")
    E:add_comps(tt, "timed_attacks")
    anchor_y = 0
    image_y = 114
    tt.enemy.gold = 100
    tt.enemy.lives_cost = 3
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = 500
    tt.health_bar.offset = vec_2(0, ady(97))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0065" or "kr2_info_portraits_enemies_0037"
    tt.info.enc_icon = 35
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_quetzal.update
    tt.motion.max_speed = 2.134 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_quetzal"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].offset = vec_2(0, 0)
    tt.sound_events.death = "DeathPuff"
    tt.timed_attacks.list[1] = E:clone_c("bullet_attack")
    tt.timed_attacks.list[1].bullet = "quetzal_egg"
    tt.timed_attacks.list[1].max_cooldown = 1.5
    tt.timed_attacks.list[1].min_cooldown = 1.5
    tt.timed_attacks.list[1].max_count = 8
    tt.ui.click_rect = r(-20, 42, 40, 50)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 68)
    tt.unit.marker_offset = vec_2(0, ady(1))
    tt.unit.mod_offset = vec_2(0, ady(70))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_BLOCK, F_SKELETON, F_EAT)
    tt.vis.flags = bor(F_ENEMY, F_FLYING)

    tt = E:register_t("quetzal_egg", "decal_scripted")
    E:add_comps(tt, "render", "spawner", "tween")
    tt.main_script.update = scripts.enemies_spawner.update
    tt.render.sprites[1].anchor.y = 0.18
    tt.render.sprites[1].prefix = "quetzal_egg"
    tt.render.sprites[1].loop = false
    tt.spawner.count = 1
    tt.spawner.cycle_time = fts(6)
    tt.spawner.entity = "enemy_razorwing"
    tt.spawner.allowed_subpaths = nil
    tt.spawner.animation_start = "start"
    tt.spawner.initial_spawn_animation = "raise"
    tt.spawner.keep_gold = true
    tt.tween.disabled = true
    tt.tween.props[1].keys = {{0, 255}, {4, 0}}
    tt.tween.remove = true

    tt = E:register_t("enemy_redspine", "enemy")
    E:add_comps(tt, "melee", "ranged", "water")
    anchor_y = 0.22
    image_y = 64
    tt.enemy.gold = 40
    tt.enemy.melee_slot = vec_2(32, 0)
    tt.enemy.valid_terrains = bor(TERRAIN_LAND, TERRAIN_WATER)
    tt.health.armor = 0
    tt.health.hp_max = 1700
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, 49)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0073" or "kr2_info_portraits_enemies_0046"
    tt.info.enc_icon = 46
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed_water.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 35
    tt.melee.attacks[1].damage_min = 25
    tt.melee.attacks[1].hit_time = fts(20)
    tt.motion.max_speed = 32
    tt.ranged.attacks[1].animation = "rangedAttack"
    tt.ranged.attacks[1].bullet = "harpoon_redspine"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(0, 40)}
    tt.ranged.attacks[1].cooldown = 3
    tt.ranged.attacks[1].max_range = 125
    tt.ranged.attacks[1].min_range = 40
    tt.ranged.attacks[1].shoot_time = fts(8)
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_redspine"
    tt.sound_events.death_water = "RTWaterDead"
    tt.sound_events.water_splash = "SpecialMermaid"
    tt.ui.click_rect = r(-20, -5, 40, 60)
    tt.unit.hit_offset = vec_2(0, 17)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 18)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.water.health_bar_offset = vec_2(0, tt.health_bar.offset.y - 20)
    tt.water.hit_offset = vec_2(0, 5)
    tt.water.mod_offset = vec_2(0, 12)
    tt.water.speed_factor = 1.5

    tt = E:register_t("harpoon_redspine", "arrow")
    tt.render.sprites[1].name = "Redspine_spear"
    tt.render.sprites[1].animated = false
    tt.bullet.damage_min = 100
    tt.bullet.damage_max = 130
    tt.bullet.flight_time = fts(10)
    tt.bullet.miss_decal = "Redspine_spear_decal"
    tt.bullet.pop = nil

    tt = E:register_t("enemy_bluegale", "enemy")
    E:add_comps(tt, "melee", "ranged", "timed_attacks", "water")
    anchor_y = 0.20689655172413793
    image_y = 116
    tt.enemy.gold = 60
    tt.enemy.lives_cost = 3
    tt.enemy.melee_slot = vec_2(30, 0)
    tt.enemy.valid_terrains = bor(TERRAIN_LAND, TERRAIN_WATER)
    tt.health.armor = 0
    tt.health.hp_max = 2400
    tt.health.immune_to = bor(DAMAGE_MAGICAL, DAMAGE_MAGICAL_EXPLOSION)
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, 57)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0074" or "kr2_info_portraits_enemies_0045"
    tt.info.enc_icon = 43
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_bluegale.update
    tt.motion.max_speed = 25.6
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_bluegale"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].anchor.y = anchor_y
    tt.render.sprites[2].prefix = "bluegale_lightning"
    tt.sound_events.death_water = "RTWaterDead"
    tt.sound_events.water_splash = "SpecialMermaid"
    tt.ui.click_rect = r(-25, -10, 50, 60)
    tt.unit.hit_offset = vec_2(0, 20)
    tt.unit.mod_offset = vec_2(0, 20)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)
    tt.water.health_bar_offset = vec_2(0, tt.health_bar.offset.y - 30)
    tt.water.hit_offset = vec_2(0, 5)
    tt.water.mod_offset = vec_2(0, 12)
    tt.water.speed_factor = 1.625
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_max = 120
    tt.melee.attacks[1].damage_min = 60
    tt.melee.attacks[1].hit_time = fts(30)
    tt.ranged.attacks[1].animation = "rangedAttack"
    tt.ranged.attacks[1].bullet = "ray_bluegale"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(27, 70)}
    tt.ranged.attacks[1].cooldown = 0
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].max_range = 125
    tt.ranged.attacks[1].min_range = 40
    tt.ranged.attacks[1].shoot_time = fts(18)
    tt.timed_attacks.list[1] = E:clone_c("aura_attack")
    tt.timed_attacks.list[1].animation = "castStorm"
    tt.timed_attacks.list[1].bullet = "bluegale_clouds_aura"
    tt.timed_attacks.list[1].cooldown = 5
    tt.timed_attacks.list[1].node_random_max = 30
    tt.timed_attacks.list[1].node_random_min = 15
    tt.timed_attacks.list[1].nodes_limit = 40
    tt.timed_attacks.list[1].shoot_time = fts(14)

    tt = E:register_t("ray_bluegale", "bullet")
    tt.image_width = 120
    tt.main_script.update = scripts.ray_enemy.update
    tt.render.sprites[1].name = "ray_bluegale"
    tt.render.sprites[1].loop = false
    tt.render.sprites[1].anchor = vec_2(0, 0.5)
    tt.bullet.damage_type = DAMAGE_MAGICAL
    tt.bullet.damage_min = 25
    tt.bullet.damage_max = 45
    tt.bullet.max_track_distance = 50
    tt.bullet.hit_time = fts(5)
    tt.sound_events.insert = "SaurianSavantAttack"

    tt = E:register_t("bluegale_clouds_aura", "aura")

    E:add_comps(tt, "sound_events")

    tt.main_script.insert = scripts.bluegale_clouds.insert
    tt.main_script.update = scripts.bluegale_clouds.update
    tt.aura.duration = 10
    tt.clouds_min_radius = 35
    tt.clouds_max_radius = 55
    tt.clouds_count = 6
    tt.sound_events.insert = "RTBluegaleStormSummon"

    tt = E:register_t("decal_bluegale_cloud_dark", "decal_tween")
    E:add_comps(tt, "ui")

    tt.ui.click_rect = r(-58, -31, 116, 62)
    tt.ui.z = 999
    tt.tween.remove = true
    tt.tween.props[1].name = "alpha"
    tt.tween.props[2] = E:clone_c("tween_prop")
    tt.tween.props[2].keys = {{0, vec_2(0, 3)}, {1, vec_2(0, -3)}, {2, vec_2(0, 3)}}
    tt.tween.props[2].name = "offset"
    tt.tween.props[2].loop = true
    tt.render.sprites[1].name = "Bluegale_stormCloud_0002"
    tt.render.sprites[1].animated = false
    tt.render.sprites[1].z = Z_OBJECTS_SKY

    tt = E:register_t("decal_bluegale_cloud_bright", "decal_tween")
    tt.tween.remove = true
    tt.tween.props[1].name = "alpha"
    tt.tween.props[1].loop = true
    tt.tween.props[2] = E:clone_c("tween_prop")
    tt.tween.props[2].keys = {{0, vec_2(0, 3)}, {1, vec_2(0, -3)}, {2, vec_2(0, 3)}}
    tt.tween.props[2].name = "offset"
    tt.tween.props[2].loop = true
    tt.tween.props[3] = E:clone_c("tween_prop")
    tt.tween.props[3].name = "hidden"
    tt.render.sprites[1].name = "Bluegale_stormCloud_0001"
    tt.render.sprites[1].animated = false
    tt.render.sprites[1].z = Z_OBJECTS_SKY

    tt = E:register_t("decal_bluegale_cloud_shadow", "decal_tween")
    tt.tween.remove = true
    tt.tween.props[1].name = "alpha"
    tt.render.sprites[1].name = "atomicBomb_shadow"
    tt.render.sprites[1].animated = false
    tt.render.sprites[1].z = Z_OBJECTS_SKY

    tt = E:register_t("bluegale_heal_aura", "aura")
    tt.main_script.insert = scripts.aura_apply_mod.insert
    tt.main_script.update = scripts.aura_apply_mod.update
    tt.aura.mod = "mod_bluegale_heal"
    tt.aura.vis_bans = F_FRIEND
    tt.aura.vis_flags = F_MOD
    tt.aura.cycle_time = 1
    tt.aura.duration = 10
    tt.aura.radius = 50

    tt = E:register_t("bluegale_damage_aura", "aura")
    tt.main_script.insert = scripts.aura_apply_mod.insert
    tt.main_script.update = scripts.aura_apply_mod.update
    tt.aura.mod = "mod_bluegale_damage"
    tt.aura.vis_bans = F_ENEMY
    tt.aura.vis_flags = F_MOD
    tt.aura.cycle_time = 1
    tt.aura.duration = 10
    tt.aura.radius = 50

    local mod_bluegale_damage = E:register_t("mod_bluegale_damage", "modifier")

    E:add_comps(mod_bluegale_damage, "dps")
    mod_bluegale_damage.modifier.duration = 0.9
    mod_bluegale_damage.dps.damage_min = 15
    mod_bluegale_damage.dps.damage_max = 15
    mod_bluegale_damage.dps.damage_type = DAMAGE_TRUE
    mod_bluegale_damage.dps.damage_every = 1
    mod_bluegale_damage.main_script.insert = scripts.mod_dps.insert
    mod_bluegale_damage.main_script.update = scripts.mod_dps.update

    local mod_bluegale_heal = E:register_t("mod_bluegale_heal", "modifier")
    E:add_comps(mod_bluegale_heal, "hps")
    mod_bluegale_heal.modifier.duration = 0.9
    mod_bluegale_heal.hps.heal_min = 15
    mod_bluegale_heal.hps.heal_max = 15
    mod_bluegale_heal.hps.heal_every = 1
    mod_bluegale_heal.main_script.insert = scripts.mod_hps.insert
    mod_bluegale_heal.main_script.update = scripts.mod_hps.update

    tt = E:register_t("enemy_bloodshell", "enemy")
    E:add_comps(tt, "melee", "water")
    anchor_y = 0.26
    image_y = 72
    tt.enemy.gold = 75
    tt.enemy.lives_cost = 5
    tt.enemy.melee_slot = vec_2(34, 0)
    tt.enemy.valid_terrains = bor(TERRAIN_LAND, TERRAIN_WATER)
    tt.health.armor = 0.95
    tt.health.hp_max = 3200
    tt.health.immune_to = DAMAGE_EXPLOSION
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(76))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0076" or "kr2_info_portraits_enemies_0048"
    tt.info.enc_icon = 42
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed_water.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 120
    tt.melee.attacks[1].damage_min = 100
    tt.melee.attacks[1].hit_time = fts(16)
    tt.motion.max_speed = 22.4
    tt.render.sprites[1].anchor.y = 0.26
    tt.render.sprites[1].prefix = "enemy_bloodshell"
    tt.sound_events.death_water = "RTWaterDead"
    tt.sound_events.water_splash = "SpecialMermaid"
    tt.ui.click_rect = r(-30, -10, 60, 60)
    tt.unit.hit_offset = vec_2(0, 30)
    tt.unit.marker_offset = vec_2(0, ady(19))
    tt.unit.mod_offset = vec_2(0, ady(47))
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = F_DRILL
    tt.water.health_bar_offset = vec_2(0, tt.health_bar.offset.y - 28)
    tt.water.hit_offset = vec_2(0, 7)
    tt.water.mod_offset = vec_2(0, ady(33))
    tt.water.speed_factor = 1.43
    tt.water.vis_bans = bor(F_BLOCK, F_SKELETON, F_DRILL)

    tt = E:register_t("enemy_greenfin", "enemy")
    E:add_comps(tt, "melee", "water")
    anchor_y = 0.185
    image_y = 54
    tt.enemy.gold = 20
    tt.enemy.melee_slot = vec_2(26, 0)
    tt.enemy.valid_terrains = bor(TERRAIN_LAND, TERRAIN_WATER)
    tt.health.armor = 0
    tt.health.hp_max = 450
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(47))
    tt.info.portrait = IS_PHONE and "portraits_sc_0071" or "kr2_info_portraits_enemies_0043"
    tt.info.enc_icon = 44
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed_water.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 14
    tt.melee.attacks[1].damage_min = 6
    tt.melee.attacks[1].hit_time = fts(9)
    tt.melee.attacks[2] = E:clone_c("melee_attack")
    tt.melee.attacks[2].animation = "netAttack"
    tt.melee.attacks[2].cooldown = 8
    tt.melee.attacks[2].hit_time = fts(9)
    tt.melee.attacks[2].mod = "mod_greenfin_net"
    tt.melee.attacks[2].vis_flags = bor(F_STUN, F_NET)
    tt.motion.max_speed = 48
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_greenfin"
    tt.sound_events.death_water = "RTWaterDead"
    tt.sound_events.water_splash = "SpecialMermaid"
    tt.unit.hit_offset = vec_2(0, 20)
    tt.unit.marker_offset = vec_2(0, ady(9))
    tt.unit.mod_offset = vec_2(2, ady(23))
    tt.water.health_bar_offset = vec_2(0, tt.health_bar.offset.y - 15)
    tt.water.hit_offset = vec_2(0, 5)
    tt.water.mod_offset = vec_2(2, ady(20))
    tt.water.speed_factor = 1.2

    tt = E:register_t("mod_greenfin_net", "modifier")
    E:add_comps(tt, "render")
    tt.main_script.insert = scripts.mod_stun.insert
    tt.main_script.update = scripts.mod_stun.update
    tt.main_script.remove = scripts.mod_stun.remove
    tt.modifier.duration = 6
    tt.modifier.duration_heroes = 1
    tt.modifier.animation_phases = true
    tt.render.sprites[1].prefix = "greenfin_net"
    tt.render.sprites[1].size_names = {"small", "big", "big"}
    tt.render.sprites[1].name = "start"
    tt.render.sprites[1].size_anchors = {vec_2(0.5, 1), vec_2(0.5, 0.8409090909090909), vec_2(0.5, 0.8409090909090909)}
    tt.render.sprites[1].anchor = vec_2(0.5, 1)
    tt.modifier.custom_offsets = {}
    tt.modifier.custom_offsets.default = vec_2(0, 26)
    tt.modifier.custom_offsets.hero_alien = vec_2(0, 32)
    tt.modifier.custom_offsets.hero_alric = vec_2(0, 31)
    tt.modifier.custom_offsets.hero_beastmaster = vec_2(0, 32)
    tt.modifier.custom_offsets.hero_voodoo_witch = vec_2(0, 32)
    tt.modifier.custom_offsets.hero_crab = vec_2(0, 46)
    tt.modifier.custom_offsets.hero_giant = vec_2(-2, 50)
    tt.modifier.custom_offsets.hero_minotaur = vec_2(6, 46)
    tt.modifier.custom_offsets.hero_mirage = vec_2(0, 31)
    tt.modifier.custom_offsets.hero_monkey_god = vec_2(2, 37)
    tt.modifier.custom_offsets.hero_pirate = vec_2(0, 30)
    tt.modifier.custom_offsets.hero_priest = vec_2(0, 29)
    tt.modifier.custom_offsets.hero_van_helsing = vec_2(0, 36)
    tt.modifier.custom_offsets.hero_wizard = vec_2(0, 29)
    tt.modifier.custom_offsets.soldier_death_rider = vec_2(0, 38)
    tt.modifier.custom_offsets.soldier_pirate_anchor = vec_2(0, 34)
    tt.modifier.custom_offsets.soldier_frankenstein = vec_2(0, 41)

    tt = E:register_t("enemy_deviltide", "enemy_greenfin")
    tt.enemy.gold = 20
    tt.health.armor = 0.5
    tt.health.hp_max = 500
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0072" or "kr2_info_portraits_enemies_0044"
    tt.info.enc_icon = 47
    tt.melee.attacks[1].damage_max = 20
    tt.melee.attacks[1].damage_min = 10
    tt.motion.max_speed = 41.6
    tt.render.sprites[1].prefix = "enemy_deviltide"
    tt.sound_events.water_splash = "SpecialMermaid"
    tt.water.speed_factor = 1.15

    tt = E:register_t("enemy_deviltide_shark", "enemy")
    anchor_y = 0.19230769230769232
    image_y = 104
    tt.enemy.gold = 20
    tt.enemy.valid_terrains = TERRAIN_WATER
    tt.health.armor = 0.5
    tt.health.hp_max = 500
    tt.health_bar.offset = vec_2(0, 39)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.fn = scripts.enemy_deviltide_shark.get_info
    tt.info.portrait = IS_PHONE and "portraits_sc_0072" or "kr2_info_portraits_enemies_0058"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_deviltide_shark.update
    tt.motion.max_speed = 70.4
    tt.payload = "enemy_deviltide"
    tt.payload_time = fts(24)
    tt.render.sprites[1].anchor = vec_2(0.44660194174757284, 0.19230769230769232)
    tt.render.sprites[1].prefix = "enemy_deviltide_shark"
    tt.sound_events.death_water = "RTWaterDead"
    tt.sound_events.deploy = "RTWaterExplosion"
    tt.ui.click_rect = r(-30, -10, 60, 40)
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 15)
    tt.unit.mod_offset = vec_2(0, 15)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_BLOCK, F_SKELETON)
    tt.vis.flags = bor(tt.vis.flags, F_WATER)

    tt = E:register_t("enemy_blacksurge", "enemy")
    E:add_comps(tt, "melee", "timed_attacks", "water", "regen")
    anchor_y = 0.31
    image_y = 74
    tt.enemy.gold = 50
    tt.enemy.melee_slot = vec_2(35, 0)
    tt.enemy.valid_terrains = bor(TERRAIN_LAND, TERRAIN_WATER)
    tt.health.armor = 0.7
    tt.health.hp_max = 1200
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(72))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.hidden = {}
    tt.hidden.cooldown = 20
    tt.hidden.duration = 12
    tt.hidden.nodeslimit = 20
    tt.hidden.trigger_health_factor = 0.3
    tt.hidden.vis_bans = bor(F_BLOCK, F_STUN, F_BLOOD, F_TWISTER, F_LETHAL)
    tt.hidden.sprite_suffix = "_hidden"
    tt.hidden.ts = 0
    tt.info.portrait = IS_PHONE and "portraits_sc_0075" or "kr2_info_portraits_enemies_0047"
    tt.info.enc_icon = 45
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_blacksurge.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 50
    tt.melee.attacks[1].damage_min = 30
    tt.melee.attacks[1].hit_time = fts(28)
    tt.motion.max_speed = 16
    tt.regen.cooldown = 0.1
    tt.regen.duration = 3
    tt.regen.health = 20
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_blacksurge"
    tt.sound_events.death_water = "RTWaterDead"
    tt.sound_events.water_splash = "SpecialMermaid"
    tt.timed_attacks.list[1] = E:clone_c("mod_attack")
    tt.timed_attacks.list[1].animation = "curse"
    tt.timed_attacks.list[1].cooldown = 5
    tt.timed_attacks.list[1].max_count = 2
    tt.timed_attacks.list[1].mod = "mod_blacksurge"
    tt.timed_attacks.list[1].range = 200
    tt.timed_attacks.list[1].shoot_time = fts(26)
    tt.timed_attacks.list[1].sound = "RTBlacksurgeHoldTower"
    tt.ui.click_rect = r(-30, -10, 60, 55)
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 15)
    tt.unit.marker_offset = vec_2(0, ady(23))
    tt.unit.mod_offset = vec_2(0, ady(42))
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)
    tt.water.health_bar_offset = vec_2(0, tt.health_bar.offset.y - 8)
    tt.water.hit_offset = vec_2(0, 15)
    tt.water.mod_offset = vec_2(0, ady(37))
    tt.water.speed_factor = 2

    local mod_blacksurge = E:register_t("mod_blacksurge", "modifier")
    E:add_comps(mod_blacksurge, "render")
    mod_blacksurge.modifier.duration = 7
    mod_blacksurge.main_script.update = scripts.mod_tower_block.update
    mod_blacksurge.render.sprites[1].prefix = "blacksurge_curse"
    mod_blacksurge.render.sprites[1].name = "start"
    mod_blacksurge.render.sprites[1].anchor.y = 0.24
    mod_blacksurge.render.sprites[1].draw_order = 10

    tt = E:register_t("enemy_bat", "enemy")
    E:add_comps(tt, "moon", "auras")
    anchor_y = 0
    image_y = 108
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "moon_enemy_aura"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 10
    tt.enemy.melee_slot = vec_2(0, 0)
    tt.health.hp_max = 75
    tt.health_bar.offset = vec_2(0, ady(90))
    tt.info.portrait = IS_PHONE and "portraits_sc_0088" or "kr2_info_portraits_enemies_0052"
    tt.info.enc_icon = 49
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_passive.update
    tt.moon.speed_factor = 1.5
    tt.motion.max_speed = 2.56 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_bat"
    tt.render.sprites[1].angles_flip_vertical = {
        walk = true
    }
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].offset = vec_2(0, 0)
    tt.sound_events.death = "DeathPuff"
    tt.ui.click_rect = r(-20, 40, 40, 50)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 68)
    tt.unit.marker_offset = vec_2(0, ady(0))
    tt.unit.mod_offset = vec_2(0, ady(68))
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_BLOCK, F_SKELETON, F_EAT)
    tt.vis.flags = bor(F_ENEMY, F_FLYING)

    tt = E:register_t("enemy_ghost", "enemy")
    E:add_comps(tt, "auras")
    anchor_y = 0.08333333333333333
    image_y = 48
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "ghost_sound_aura"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 10
    tt.enemy.melee_slot = vec_2(24, 0)
    tt.health.armor = 0
    tt.health.hp_max = 100
    tt.health.immune_to = bor(DAMAGE_PHYSICAL, DAMAGE_EXPLOSION, DAMAGE_SHOT, DAMAGE_ELECTRICAL, DAMAGE_RUDE)
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, 37)
    tt.info.portrait = IS_PHONE and "portraits_sc_0080" or "kr2_info_portraits_enemies_0063"
    tt.info.enc_icon = 52
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_passive.update
    tt.motion.max_speed = 0.967 * FPS
    tt.render.sprites[1].prefix = "enemy_ghost"
    tt.render.sprites[1].anchor.y = anchor_y
    tt.unit.blood_color = BLOOD_NONE
    tt.unit.show_blood_pool = false
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 19)
    tt.unit.marker_offset = vec_2(0, ady(0))
    tt.unit.mod_offset = vec_2(0, 19)
    tt.sound_events.death = nil
    tt.sound_events.insert = "HWGhosts"
    tt.vis.bans = bor(F_SKELETON, F_BLOOD, F_DRILL, F_POISON, F_STUN, F_BLOCK, F_POLYMORPH)

    tt = E:register_t("ghost_sound_aura", "aura")
    tt.loop_delay = fts(70)
    tt.sound_name = "HWGhosts"
    tt.main_script.update = scripts.loop_sound_aura.update

    tt = E:register_t("enemy_ghoul", "enemy")
    E:add_comps(tt, "melee", "moon", "auras")
    anchor_y = 0.07894736842105263
    image_y = 60
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "moon_enemy_aura"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 20
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.cannibalize = {}
    tt.cannibalize.extra_hp = 50
    tt.cannibalize.hps = 3 * FPS
    tt.cannibalize.max_hp = 600
    tt.health.armor = 0.2
    tt.health.hp_max = 400
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, 33)
    tt.info.portrait = IS_PHONE and "portraits_sc_0082" or "kr2_info_portraits_enemies_0049"
    tt.info.enc_icon = 56
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_cannibal.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 25
    tt.melee.attacks[1].damage_min = 15
    tt.melee.attacks[1].hit_time = fts(12)
    tt.melee.attacks[1].sound = "HWZombieAmbient"
    tt.melee.attacks[1].pop = {"pop_sok", "pop_kapow"}
    tt.moon.damage_factor = 1.5
    tt.motion.max_speed = 1.92 * FPS
    tt.render.sprites[1].prefix = "enemy_ghoul"
    tt.render.sprites[1].anchor.y = anchor_y
    tt.unit.hit_offset = vec_2(0, 15)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 15)
    tt.sound_events.insert = "HWZombieAmbient"
    tt.sound_events.cannibalize = "CanibalEating"

    tt = E:register_t("enemy_phantom_warrior", "enemy")
    E:add_comps(tt, "melee", "auras")
    image_y = 88
    anchor_y = 10 / image_y
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "phantom_warrior_aura"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 90
    tt.enemy.melee_slot = vec_2(27, 0)
    tt.health.armor = 0
    tt.health.hp_max = 1000
    tt.health.immune_to = bor(DAMAGE_PHYSICAL, DAMAGE_EXPLOSION, DAMAGE_SHOT, DAMAGE_ELECTRICAL, DAMAGE_RUDE)
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, 56)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0083" or "kr2_info_portraits_enemies_0062"
    tt.info.enc_icon = 51
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_max = 90
    tt.melee.attacks[1].damage_min = 50
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 0.747 * FPS
    tt.render.sprites[1].prefix = "enemy_phantom_warrior"
    tt.render.sprites[1].anchor.y = anchor_y
    tt.sound_events.death = nil
    tt.ui.click_rect = r(-20, -5, 40, 55)
    tt.unit.blood_color = BLOOD_NONE
    tt.unit.show_blood_pool = false
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 21)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 21)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)
    tt.vis.bans = bor(F_SKELETON, F_BLOOD, F_DRILL, F_POISON)

    tt = E:register_t("phantom_warrior_aura", "aura")
    tt.aura.banned_templates = {"soldier_mecha", "soldier_death_rider", "soldier_skeleton", "soldier_skeleton_knight",
                                "hero_dracolich", "soldier_dracolich_golem", "hero_vampiress"}
    tt.aura.cycle_time = fts(3)
    tt.aura.duration = -1
    tt.aura.radius = 128
    tt.aura.vis_bans = bor(F_ENEMY, F_BOSS)
    tt.aura.vis_flags = F_MOD
    tt.aura.damage_min = 3
    tt.aura.damage_max = 3
    tt.aura.damage_type = DAMAGE_TRUE
    tt.aura.hero_damage_factor = 0.3333333333333333
    tt.main_script.update = scripts.phantom_warrior_aura.update

    tt = E:register_t("enemy_elvira", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.1
    image_y = 50
    tt.enemy.gold = 16
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.armor = 0
    tt.health.hp_max = 1200
    tt.health.magic_armor = 0.95
    tt.health_bar.offset = vec_2(0, 43)
    tt.info.portrait = IS_PHONE and "portraits_sc_0091" or "kr2_info_portraits_enemies_0066"
    tt.info.enc_icon = 58
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 40
    tt.melee.attacks[1].damage_min = 20
    tt.melee.attacks[1].hit_time = fts(12)
    tt.melee.attacks[2] = E:clone_c("melee_attack")
    tt.melee.attacks[2].cooldown = 8
    tt.melee.attacks[2].damage_max = 0
    tt.melee.attacks[2].damage_min = 0
    tt.melee.attacks[2].hit_time = fts(3)
    tt.melee.attacks[2].mod = "mod_elvira_lifesteal"
    tt.melee.attacks[2].animation = "lifesteal"
    tt.melee.attacks[2].health_trigger_factor = 0.7
    tt.melee.attacks[2].fn_can = scripts.enemy_elvira.can_lifesteal
    tt.motion.max_speed = 0.9 * FPS
    tt.render.sprites[1].prefix = "enemy_elvira"
    tt.render.sprites[1].anchor.y = anchor_y
    tt.sound_events.death = nil
    tt.ui.click_rect = r(-20, -5, 40, 50)
    tt.unit.blood_color = BLOOD_RED
    tt.unit.hit_offset = vec_2(0, 16)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 16)
    tt.unit.hide_after_death = true

    tt = E:register_t("elvira_bat", "decal_scripted")
    E:add_comps(tt, "nav_path", "motion", "spawner")
    anchor_y = 0.1
    image_y = 50
    tt.main_script.update = scripts.elvira_bat.update
    tt.motion.max_speed = 2 * FPS
    tt.render.sprites[1].prefix = "elvira_bat"
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].offset = vec_2(0, 0)
    tt.payload = "enemy_elvira"

    tt = E:register_t("mod_elvira_lifesteal", "modifier")
    E:add_comps(tt, "moon")
    tt.heal_hp = 360
    tt.damage = 150
    tt.main_script.insert = scripts.mod_elvira_lifesteal.insert
    tt.moon.heal_hp_factor = 2
    tt.moon.damage_factor = 1.5

    tt = E:register_t("enemy_headless_horseman", "enemy")
    E:add_comps(tt, "melee", "ranged", "lifespan", "idle_flip", "auras")
    image_y = 104
    anchor_y = 12 / image_y
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "headless_horseman_spawner_aura"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 200
    tt.enemy.lives_cost = 0
    tt.enemy.melee_slot = vec_2(36, 0)
    tt.health.armor = 0
    tt.health.hp_max = 500
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, 65)
    tt.idle_flip.cooldown = 3
    tt.idle_flip.last_dir = -1
    tt.idle_flip.walk_dist = 30
    tt.info.portrait = IS_PHONE and "portraits_sc_0089" or "kr2_info_portraits_enemies_0064"
    tt.lifespan.duration = 15
    tt.lifespan.animation_in = "rise"
    tt.lifespan.animation_out = "death"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_headless_horseman.update
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_max = 90
    tt.melee.attacks[1].damage_min = 50
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 3.74 * FPS
    tt.ranged.attacks[1].bullet = "headless_horseman_pumpkin"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(20, 65)}
    tt.ranged.attacks[1].cooldown = 4
    tt.ranged.attacks[1].min_range = 40
    tt.ranged.attacks[1].max_range = 190
    tt.ranged.attacks[1].shoot_time = fts(28)
    tt.render.sprites[1].prefix = "enemy_headless_horseman"
    tt.render.sprites[1].anchor.y = anchor_y
    tt.sound_events.insert = {"HWHeadlessHorsemanLaugh", "HWHeadlessHorsemanEntry"}
    tt.sound_events.death = nil
    tt.ui.click_rect = r(-20, -5, 40, 60)
    tt.unit.blood_color = BLOOD_NONE
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 35)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 35)
    tt.unit.hide_after_death = true
    tt.vis.flags = bor(F_ENEMY)
    tt.vis.bans = bor(F_SKELETON)

    tt = E:register_t("headless_horseman_pumpkin", "bomb")
    tt.bullet.damage_min = 50
    tt.bullet.damage_max = 70
    tt.bullet.damage_radius = 40
    tt.bullet.damage_bans = F_ENEMY
    tt.bullet.damage_flags = F_AREA
    tt.bullet.flight_time = fts(20)
    tt.render.sprites[1].name = "HalloweenRider_bomb"
    tt.main_script.insert = scripts.enemy_bomb.insert
    tt.main_script.update = scripts.enemy_bomb.update
    tt.sound_events.insert = nil

    tt = E:register_t("headless_horseman_spawner_aura", "aura")
    E:add_comps(tt, "spawner")
    tt.main_script.update = scripts.headless_horseman_spawner_aura.update
    tt.spawner.cycle_time = 10

    -- 纳泽鲁
    tt = E:register_t("eb_efreeti", "boss")
    E:add_comps(tt, "attacks", "tween")
    anchor_y = 0.1
    image_y = 198
    tt.attacks.cooldown = 7
    tt.attacks.list[1] = E:clone_c("custom_attack")
    tt.attacks.list[1].animation = "attack"
    tt.attacks.list[1].chance = 0.2
    tt.attacks.list[1].hit_time = fts(13)
    tt.attacks.list[1].max_count = 3
    tt.attacks.list[1].max_range = 320
    tt.attacks.list[1].min_range = 76.8
    tt.attacks.list[2] = E:clone_c("custom_attack")
    tt.attacks.list[2].animation = "attack"
    tt.attacks.list[2].hit_time = fts(13)
    tt.attacks.list[2].max_count = 10
    tt.attacks.list[2].max_range = 96
    tt.attacks.list[2].min_range = 0
    tt.attacks.list[3] = E:clone_c("mod_attack")
    tt.attacks.list[3].animation = "attack_sand"
    tt.attacks.list[3].chance = 0.3
    tt.attacks.list[3].max_count = 3
    tt.attacks.list[3].max_range = 192
    tt.attacks.list[3].mod = "mod_efreeti"
    tt.attacks.list[3].shoot_time = fts(19)
    tt.attacks.list[4] = E:clone_c("spawn_attack")
    tt.attacks.list[4].animation = "attack"
    tt.attacks.list[4].coords = {vec_2(816, 430), vec_2(415, 490), vec_2(270, 340), vec_2(690, 290)}
    tt.attacks.list[4].entity = "enemy_efreeti_small"
    tt.attacks.list[4].health_threshold = 3000
    tt.attacks.list[4].max_count = 2
    tt.attacks.list[4].spawn_time = fts(13)
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(50, 0)
    tt.health.dead_lifetime = fts(200)
    tt.health.hp_max = 8400
    tt.health_bar.offset = vec_2(0, ady(195))
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.info.fn = scripts.eb_efreeti.get_info
    tt.info.portrait = IS_PHONE and "portraits_sc_0040" or "kr2_info_portraits_enemies_0015"
    tt.info.enc_icon = 14
    tt.main_script.insert = scripts.eb_efreeti.insert
    tt.main_script.update = scripts.eb_efreeti.update
    tt.motion.max_speed = 0.375 * FPS
    tt.render.sprites[1] = E:clone_c("sprite")
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].angles = {}
    tt.render.sprites[1].angles.walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    tt.render.sprites[1].loop_forced = true
    tt.render.sprites[1].prefix = "eb_efreeti_legs"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].anchor.y = anchor_y
    tt.render.sprites[2].angles = {}
    tt.render.sprites[2].angles.walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    tt.render.sprites[2].prefix = "eb_efreeti"
    tt.render.sprites[3] = E:clone_c("sprite")
    tt.render.sprites[3].anchor.y = anchor_y
    tt.render.sprites[3].angles = {}
    tt.render.sprites[3].angles.walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    tt.render.sprites[3].loop_forced = true
    tt.render.sprites[3].prefix = "eb_efreeti_belt"
    tt.tween.props[1].keys = {{0, 0}, {1.5, 255}}
    tt.tween.props[1].sprite_id = 1
    tt.tween.props[2] = E:clone_c("tween_prop")
    tt.tween.props[2].keys = {{0, 0}, {1.5, 255}}
    tt.tween.props[2].sprite_id = 2
    tt.tween.props[3] = E:clone_c("tween_prop")
    tt.tween.props[3].keys = {{0, 0}, {1.5, 255}}
    tt.tween.props[3].sprite_id = 3
    tt.tween.remove = false
    tt.ui.click_rect = r(-40, -5, 80, 160)
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 103)
    tt.unit.marker_hidden = true
    tt.unit.mod_offset = vec_2(0, ady(104))
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = F_ALL
    tt.vis.bans_in_battlefield = bor(F_SKELETON)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.sound_events.insert = "MusicBossFight"
    tt.sound_events.laugh = "BossEfreetiLaugh"
    tt.sound_events.death = "BossEfreetiDeath"
    tt.sound_events.desintegrate = "BossEfreetiSnap"
    tt.sound_events.polymorph = "BossEfreetiSnap"
    tt.sound_events.spawn = "BossEfreetiSnap"
    tt.sound_events.sand = "BossEfreetiClap"

    tt = E:register_t("mod_efreeti", "modifier")
    E:add_comps(tt, "render")
    tt.main_script.update = scripts.mod_tower_block.update
    tt.modifier.duration = 10
    tt.modifier.hide_tower = true
    tt.render.sprites[1].anchor.y = 0.17
    tt.render.sprites[1].draw_order = 10
    tt.render.sprites[1].z = Z_OBJECTS
    tt.render.sprites[1].name = "start"
    tt.render.sprites[1].prefix = "efreeti_sandblock_tower"
    tt.sound_events.finish = "BossEfreetiTowerReleased"

    tt = E:register_t("eb_gorilla", "boss")
    E:add_comps(tt, "melee", "attacks", "idle_flip")
    anchor_y = 0.21
    image_y = 172
    tt.jump_down_advance_nodes = 10
    tt.nodes_limit = 30
    tt.on_tower_time = 9
    tt.tower_pos_left = nil
    tt.tower_pos_right = nil
    tt.attacks.list[1] = E:clone_c("spawn_attack")
    tt.attacks.list[1].animation = "call"
    tt.attacks.list[1].cooldown = 8
    tt.attacks.list[1].entity = "gorilla_small_liana"
    tt.attacks.list[1].max_count = 8
    tt.attacks.list[1].sound = "BossMonkeyChestPounding"
    tt.attacks.list[1].spawn_node_ranges = {{{62, 113}, {130, 150}}, {{60, 105}, {120, 140}}}
    tt.attacks.list[2] = E:clone_c("custom_attack")
    tt.attacks.list[2].cooldown = 10
    tt.attacks.list[2].points = 500
    tt.attacks.list[2].sound = "EnemyHealing"
    tt.attacks.list[3] = E:clone_c("bullet_attack")
    tt.attacks.list[3].animation = "throw_barrel"
    tt.attacks.list[3].bullet = "gorilla_boss_barrel"
    tt.attacks.list[3].bullet_start_offset = {vec_2(60, 70)}
    tt.attacks.list[3].cooldown = 2
    tt.attacks.list[3].max_range = 448
    tt.attacks.list[3].min_range = 50
    tt.attacks.list[3].shoot_time = fts(9)
    tt.attacks.list[3].vis_bans = bor(F_FLYING, F_ENEMY)
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(50, 0)
    tt.health.dead_lifetime = fts(300)
    tt.health.hp_max = {8000, 12000, 12000}
    tt.health_bar.offset = vec_2(0, ady(160))
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.idle_flip.chance = 1
    tt.idle_flip.cooldown = 5
    tt.info.fn = scripts.eb_gorilla.get_info
    tt.info.portrait = IS_PHONE and "portraits_sc_0068" or "kr2_info_portraits_enemies_0039"
    tt.info.enc_icon = 38
    tt.main_script.insert = scripts.eb_gorilla.insert
    tt.main_script.update = scripts.eb_gorilla.update
    tt.melee.attacks[1] = E:clone_c("area_attack")
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].damage_max = 500
    tt.melee.attacks[1].damage_min = 200
    tt.melee.attacks[1].damage_radius = 44.800000000000004
    tt.melee.attacks[1].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[1].hit_decal = "decal_ground_hit"
    tt.melee.attacks[1].hit_fx = "fx_ground_hit"
    tt.melee.attacks[1].hit_offset = vec_2(50, 0)
    tt.melee.attacks[1].hit_time = fts(17)
    tt.melee.attacks[1].sound = "BossMonkeySmashGround"
    tt.motion.max_speed = 0.534 * FPS
    tt.render.sprites[1] = E:clone_c("sprite")
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].angles = {}
    tt.render.sprites[1].angles.walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    tt.render.sprites[1].prefix = "eb_gorilla"
    tt.sound_events.death = "BossMonkeyDeath"
    tt.sound_events.insert = "MusicBossFight"
    tt.sound_events.jump_to_tower = "BossMonkeyJumpToTotem"
    tt.sound_events.drop_from_sky = "BossMonkeyFallSpawn"
    tt.unit.hit_offset = vec_2(0, 45)
    tt.unit.marker_hidden = true
    tt.unit.mod_offset = vec_2(0, ady(73))
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_SKELETON, F_BLOOD)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)

    tt = E:register_t("fx_gorilla_boss_heal", "fx")
    tt.render.sprites[1].name = "fx_gorilla_boss_heal"
    tt.render.sprites[1].anchor.y = 0.21

    tt = E:register_t("fx_gorilla_boss_jump_smoke", "fx")
    tt.render.sprites[1].name = "fx_gorilla_boss_jump_smoke"
    tt.render.sprites[1].anchor.y = 0.12

    tt = E:register_t("gorilla_boss_barrel", "bomb")
    tt.bullet.flight_time_base = fts(30)
    tt.bullet.flight_time_factor = fts(0.025)
    tt.bullet.g = -0.85 / (fts(1) * fts(1))
    tt.bullet.warp_time = 2
    tt.bullet.damage_min = 100
    tt.bullet.damage_max = 150
    tt.bullet.damage_radius = 51.2
    tt.bullet.damage_bans = F_ENEMY
    tt.bullet.damage_flags = F_AREA
    tt.bullet.damage_decay_random = true
    tt.bullet.pop = nil
    tt.render.sprites[1].name = "CanibalBoos_Proy"
    tt.main_script.insert = scripts.enemy_bomb.insert
    tt.main_script.update = scripts.enemy_bomb.update

    tt = E:register_t("enemy_gorilla_small", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.21
    image_y = 68
    tt.enemy.gold = 50
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(26, 0)
    tt.health.armor = 0
    tt.health.hp_max = 1200
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(64))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0067" or "kr2_info_portraits_enemies_0038"
    tt.info.enc_icon = 39
    tt.main_script.insert = scripts.enemy_gorilla_small.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_max = 100
    tt.melee.attacks[1].damage_min = 50
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 1.067 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].name = "idle"
    tt.render.sprites[1].prefix = "enemy_gorilla_small"
    tt.render.sprites[1].angles_flip_vertical = {
        walk = true
    }
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, ady(13))
    tt.unit.mod_offset = vec_2(0, ady(28))
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.sound_events.death = "DeathBig"

    tt = E:register_t("gorilla_small_liana", "decal_scripted")
    E:add_comps(tt, "sound_events")
    tt.main_script.update = scripts.gorilla_small_liana.update
    tt.render.sprites[1].flip_x = true
    tt.render.sprites[1].name = "gorilla_small_liana"
    tt.spawn_name = "gorilla_small_falling"
    tt.spawn_offset = {vec_2(-130, 38), vec_2(130, 38)}
    tt.spawn_time = fts(8)
    tt.spawn_dest = nil
    tt.sound_events.insert = "BossMonkeyMonkeysScreams"

    tt = E:register_t("gorilla_small_falling", "bomb")
    tt.render.sprites[1].name = "CanibalBoos_Offspring_0030"
    tt.bullet.flight_time = fts(27)
    tt.bullet.vis_bans = F_ALL
    tt.bullet.hit_fx = "enemy_gorilla_small"
    tt.bullet.hit_decal = nil
    tt.bullet.pop = nil
    tt.bullet.hide_radius = nil
    tt.bullet.rotation_speed = nil
    tt.sound_events.insert = nil
    tt.sound_events.hit = nil
    tt.sound_events.hit_water = nil

    tt = E:register_t("eb_umbra", "boss")
    E:add_comps(tt, "melee", "attacks")
    anchor_y = 0.18
    image_y = 176
    tt.attacks.list[1] = E:clone_c("spawn_attack")
    tt.attacks.list[1].animation = "open_portals"
    tt.attacks.list[1].cooldowns = {}
    tt.attacks.list[1].cooldowns.at_home = {3, 3, 1, 1, 0, 0, 0, 2, 2, 2}
    tt.attacks.list[1].cooldowns.on_battlefield = {0, 0, 0, 0, 3, 3, 3, 3, 3, 3}
    tt.attacks.list[1].cooldown = nil
    tt.attacks.list[1].entity = "umbra_portal"
    tt.attacks.list[1].nodes_left = {{np(1, 1, 53), np(2, 1, 53)}, {np(1, 1, 85), np(2, 1, 85)}}
    tt.attacks.list[1].nodes_right = {{np(3, 1, 26), np(4, 1, 24)}, {np(3, 1, 68), np(4, 1, 69)}}
    tt.attacks.list[1].count_min = 3
    tt.attacks.list[1].add_per_missing_piece = 0.4
    tt.attacks.list[2] = E:clone_c("custom_attack")
    tt.attacks.list[2].cooldowns = {}
    tt.attacks.list[2].cooldowns.at_home = {7, 7, 7, 7, 8, 8, 8, 8, 8, 8}
    tt.attacks.list[2].cooldowns.on_battlefield = {6, 6, 6, 6, 8, 8, 8, 8, 8, 8}
    tt.attacks.list[2].cooldown = nil
    tt.attacks.list[2].max_side_jumps = 3
    tt.attacks.list[2].nodes_battlefield = {np(5, 1, 48), np(2, 1, 69), np(3, 1, 51)}
    tt.attacks.list[3] = E:clone_c("bullet_attack")
    tt.attacks.list[3].animation = "eyes"
    tt.attacks.list[3].bullet = "ray_umbra"
    tt.attacks.list[3].bullet_start_offset = {vec_2(-9, ady(109)), vec_2(9, ady(109))}
    tt.attacks.list[3].cooldown = 2.5
    tt.attacks.list[3].max_range = 192
    tt.attacks.list[3].shoot_time = fts(17)
    tt.attacks.list[3].vis_bans = bor(F_FLYING, F_ENEMY)
    tt.attacks.list[3].sound = "FrontiersFinalBossRay"
    tt.attacks.list[4] = table.deepclone(tt.attacks.list[3])
    tt.attacks.list[4].inner_towers = {"3", "4", "5", "8", "11", "13"}
    tt.attacks.list[4].lower_towers = {"7", "9", "15", "16"}
    tt.attacks.list[4].cooldowns = {}
    tt.attacks.list[4].cooldowns.at_home = {2, 2, 0, 0, 1, 1, 1, 0, 0, 0}
    tt.attacks.list[4].cooldowns.on_battlefield = {1, 2, 2, 2, 0, 0, 0, 0, 0, 0}
    tt.attacks.list[4].bullet = "ray_umbra_tower"
    tt.attacks.list[4].sound = "FrontiersFinalBossRayTower"
    tt.attacks.list[5] = E:clone_c("spawn_attack")
    tt.attacks.list[5].entity = "enemy_umbra_piece_flying"
    tt.attacks.list[5].payload_entity = "enemy_umbra_piece"
    tt.attacks.list[5].start_offset_x = {-20, 20}
    tt.attacks.list[5].start_offset_y = {60, 80}
    tt.attacks.list[5].dest_pi = {5, 6, 7, 8, 9}
    tt.attacks.list[5].initial_ni = 20
    tt.attacks.list[5].limit_ni = 50
    tt.attacks.list[5].cooldown = 30
    tt.attacks.list[5].callback_pieces = {7, 4, 2}
    tt.attacks.list[5].min_pieces_to_respawn = 3
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(25, 0)
    tt.health.dead_lifetime = fts(1000)
    tt.health.hp_max = {7000, 9000, 9999}
    tt.health_bar.offset = vec_2(0, ady(166))
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.health_bar.hidden = true
    tt.info.fn = scripts.eb_umbra.get_info
    tt.info.portrait = IS_PHONE and "portraits_sc_0070" or "kr2_info_portraits_enemies_0040"
    tt.info.enc_icon = 40
    tt.main_script.insert = scripts.eb_umbra.insert
    tt.main_script.update = scripts.eb_umbra.update
    tt.motion.max_speed = 0.534 * FPS
    tt.render.sprites[1] = E:clone_c("sprite")
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "eb_umbra"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].prefix = "eb_umbra"
    tt.render.sprites[2].name = "eyes"
    tt.render.sprites[2].hidden = true
    tt.render.sprites[2].anchor.y = anchor_y
    tt.taunt = {}
    tt.taunt.cooldown = 4
    tt.taunt.format = "FINAL_BOSS_TAUNT_%04d"
    tt.taunt.start_idx = 3
    tt.taunt.end_idx = 25
    tt.taunt.left_pos = vec_2(331, 677)
    tt.taunt.right_pos = vec_2(696, 677)
    tt.taunt.duration = 4
    tt.taunt.ts = 0
    tt.unit.blood_color = BLOOD_GRAY
    tt.unit.hit_offset = vec_2(0, 55)
    tt.unit.marker_hidden = true
    tt.unit.mod_offset = vec_2(0, ady(80))
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans_at_home = bor(F_RANGED, F_SKELETON, F_MOD, F_BLOCK, F_LETHAL, F_FREEZE)
    tt.vis.bans_in_battlefield = bor(F_SKELETON, F_BLOOD, F_POISON, F_LETHAL, F_FREEZE)
    tt.vis.bans_in_pieces = F_ALL
    tt.vis.bans = tt.vis.bans_at_home
    tt.vis.flags = bor(F_ENEMY, F_BOSS)

    tt = E:register_t("decal_umbra_shoutbox", "decal_tween")
    E:add_comps(tt, "texts", "timed")
    tt.render.sprites[1].name = "finalBoss_tauntBox"
    tt.render.sprites[1].animated = false
    tt.render.sprites[1].z = Z_BULLETS
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].z = Z_BULLETS
    tt.render.sprites[2].offset = vec_2(20, 2)
    tt.texts.list[1].text = "Hello world"
    tt.texts.list[1].size = vec_2(176, 70)
    tt.texts.list[1].font_name = "body_bold"
    tt.texts.list[1].font_sizes = {24, 23, 18}
    tt.texts.list[1].color = {94, 217, 229}
    tt.texts.list[1].line_height = 0.8
    tt.texts.list[1].sprite_id = 2
    tt.texts.list[1].fit_height = true
    tt.tween.props[1].name = "scale"
    tt.tween.props[1].keys = {{0, vec_2(1.01, 1.01)}, {0.4, vec_2(0.99, 0.99)}, {0.8, vec_2(1.01, 1.01)}}
    tt.tween.props[1].sprite_id = 1
    tt.tween.props[1].loop = true
    tt.tween.props[2] = table.deepclone(tt.tween.props[1])
    tt.tween.props[2].sprite_id = 2
    tt.tween.remove = false

    tt = E:register_t("ray_umbra", "bullet")
    tt.image_width = 190
    tt.main_script.update = scripts.ray_enemy.update
    tt.render.sprites[1].name = "ray_umbra"
    tt.render.sprites[1].loop = false
    tt.render.sprites[1].anchor = vec_2(0, 0.5)
    tt.bullet.damage_type = DAMAGE_TRUE
    tt.bullet.damage_min = 100
    tt.bullet.damage_max = 150
    tt.bullet.damage_radius = 64
    tt.bullet.max_track_distance = 50
    tt.bullet.vis_bans = bor(F_ENEMY, F_FLYING)
    tt.bullet.hit_time = fts(7)
    tt.bullet.hit_fx = "fx_ray_umbra_explosion"

    tt = E:register_t("ray_umbra_tower", "ray_umbra")
    tt.bullet.damage_radius = 0
    tt.bullet.damage_type = DAMAGE_NONE
    tt.bullet.hit_fx = nil
    tt.bullet.mod = "mod_umbra"

    tt = E:register_t("fx_ray_umbra_explosion", "fx")
    tt.render.sprites[1].name = "ray_umbra_explosion"

    tt = E:register_t("fx_ray_umbra_explosion_smoke", "fx")
    tt.render.sprites[1].name = "ray_umbra_explosion_smoke"

    tt = E:register_t("fx_umbra_death_blast", "fx")
    tt.render.sprites[1].prefix = "umbra_death_blast"
    tt.render.sprites[1].name = "short"
    tt.render.sprites[1].anchor.y = 0.18

    tt = E:register_t("mod_umbra", "modifier")
    E:add_comps(tt, "render")
    tt.main_script.update = scripts.mod_tower_remove.update
    tt.modifier.hide_time = fts(22)
    tt.render.sprites[1].anchor.y = 0.19
    tt.render.sprites[1].z = Z_OBJECTS + 1
    tt.render.sprites[1].name = "umbra_tower_remove"

    tt = E:register_t("umbra_portal", "decal_scripted")
    E:add_comps(tt, "render", "spawner")
    tt.main_script.update = scripts.umbra_portal.update
    tt.render.sprites[1].prefix = "umbra_portal"
    tt.render.sprites[1].z = Z_DECALS
    tt.spawner.count = 0
    tt.spawner.cycle_time = fts(6)
    tt.spawner.entity = "enemy_umbra_minion"
    tt.spawner.animation_start = "start"
    tt.spawner.animation_loop = "loop"
    tt.spawner.animation_end = "end"
    tt.spawner.ni_var = 3
    tt.spawner.spawn_fx = "fx_umbra_minion_spawn"

    tt = E:register_t("fx_umbra_minion_spawn", "fx")
    tt.render.sprites[1].name = "umbra_minion_spawn"
    tt.render.sprites[1].anchor.y = 0.19

    tt = E:register_t("enemy_umbra_minion", "enemy")
    E:add_comps(tt, "melee")
    anchor_y = 0.19
    image_y = 66
    tt.enemy.gold = 5
    tt.enemy.melee_slot = vec_2(26, 0)
    tt.health.armor = 0
    tt.health.hp_max = 450
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(62))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0069" or "kr2_info_portraits_enemies_0055"
    tt.info.enc_icon = 41
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_max = 170
    tt.melee.attacks[1].damage_min = 120
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 0.967 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].name = "idle"
    tt.render.sprites[1].prefix = "enemy_umbra_minion"
    tt.sound_events.death = "DeathPuff"
    tt.unit.can_explode = false
    tt.unit.blood_color = BLOOD_GRAY
    tt.unit.hit_offset = vec_2(0, 16)
    tt.unit.marker_offset = vec_2(0, ady(13))
    tt.unit.mod_offset = vec_2(0, ady(30))
    tt.unit.show_blood_pool = false
    tt.unit.hide_after_death = true
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_SKELETON)

    tt = E:register_t("enemy_umbra_piece", "enemy")
    E:add_comps(tt, "melee", "timed")
    anchor_y = 0.21
    image_y = 70
    tt.enemy.gold = 90
    tt.enemy.melee_slot = vec_2(30, 0)
    tt.health.armor = 0
    tt.health.hp_max = 1000
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(59))
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.portrait = IS_PHONE and "portraits_sc_0069" or "kr2_info_portraits_enemies_0056"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_umbra_piece.update
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_max = 50
    tt.melee.attacks[1].damage_min = 30
    tt.melee.attacks[1].hit_time = fts(12)
    tt.motion.max_speed = 1.067 * FPS
    tt.motion.max_speed_called = 6.656000000000001 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].name = "idle"
    tt.render.sprites[1].prefix = "enemy_umbra_piece"
    tt.sound_events.death = "DeathPuff"
    tt.sound_events.raise = "FrontiersFinalBossPiecesRespawn"
    tt.timed.disabled = true
    tt.ui.click_rect = r(-20, -5, 40, 50)
    tt.unit.blood_color = BLOOD_GRAY
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 24)
    tt.unit.marker_offset = vec_2(0, ady(14))
    tt.unit.mod_offset = vec_2(0, ady(33))
    tt.unit.show_blood_pool = false
    tt.unit.hide_after_death = true
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = F_ALL
    tt.vis.bans_walking = bor(F_SKELETON, F_BLOOD, F_EAT, F_POISON, F_TWISTER, F_POLYMORPH, F_TELEPORT)
    tt.piece_respawn_delay = fts(35) + 3
    tt.piece_respawn_delay_repeating = fts(35)

    tt = E:register_t("enemy_umbra_piece_flying", "bomb")
    tt.render.sprites[1].name = "enemy_umbra_piece_flying"
    tt.render.sprites[1].animated = true
    tt.render.sprites[1].loop = false
    tt.bullet.flight_time = fts(20)
    tt.bullet.vis_bans = F_ALL
    tt.bullet.hit_fx = nil
    tt.bullet.hit_decal = nil
    tt.bullet.pop = nil
    tt.bullet.rotation_speed = nil
    tt.bullet.hide_radius = nil
    tt.bullet.align_with_trajectory = true
    tt.sound_events.insert = nil
    tt.sound_events.hit = nil
    tt.sound_events.hit_water = nil

    tt = E:register_t("fx_umbra_white_circle", "decal_tween")
    tt.render.sprites[1].name = "white_explosion"
    tt.render.sprites[1].animated = false
    tt.render.sprites[1].loop = false
    tt.render.sprites[1].z = Z_GUI - 2
    tt.tween.remove = false
    tt.tween.props[1].name = "scale"
    tt.tween.props[1].keys = {{0, vec_2(0.3, 0.3)}, {0.6, vec_2(20, 20)}}

    tt = E:register_t("umbra_crystals", "decal_scripted")
    tt.render.sprites[1].prefix = "umbra_crystals"
    tt.render.sprites[1].name = "idle"
    tt.render.sprites[1].loop = false
    tt.render.sprites[1].z = Z_OBJECTS - 1
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].name = "umbra_crystals_crack1"
    tt.render.sprites[2].hidden = true
    tt.render.sprites[2].loop = false
    tt.render.sprites[3] = table.deepclone(tt.render.sprites[2])
    tt.render.sprites[3].name = "umbra_crystals_crack2"
    tt.render.sprites[4] = table.deepclone(tt.render.sprites[2])
    tt.render.sprites[4].name = "umbra_crystals_crack3"
    tt.main_script.update = scripts.decal_umbra_crystals.update

    tt = E:register_t("umbra_crystals_broken", "decal")
    tt.render.sprites[1].name = "finalBoss_spawn_0108"
    tt.render.sprites[1].animated = false

    tt = E:register_t("umbra_crystals_piece", "decal_tween")
    tt.render.sprites[1].name = "umbra_crystals_piece"
    tt.render.sprites[1].loop = false
    tt.render.sprites[1].z = Z_OBJECTS
    tt.tween.props[1].name = "alpha"
    tt.tween.props[1].keys = {{0, 255}, {fts(21), 255}, {fts(21) + 1, 0}}

    tt = E:register_t("umbra_guy", "decal_scripted")
    E:add_comps(tt, "attacks")
    tt.main_script.update = scripts.umbra_guy.update
    tt.render.sprites[1].prefix = "umbra_guy"
    tt.attacks.list[1] = E:clone_c("bullet_attack")
    tt.attacks.list[1].bullet = "ray_umbra_guy"
    tt.attacks.list[1].cooldown = 40
    tt.attacks.list[1].vis_bans = bor(F_FLYING, F_ENEMY)
    tt.attacks.list[1].shoot_time = fts(19)
    tt.attacks.list[1].max_range = 300.16
    tt.attacks.list[1].bullet_start_offset = vec_2(-17, 41)
    tt.taunt = {}
    tt.taunt.cooldown = 20
    tt.taunt.format = "FINAL_BOSS_GUY_TAUNT_%04d"
    tt.taunt.normal_idx = {3, 25}
    tt.taunt.attack_idx = {30, 34}
    tt.taunt.lost_life_idx = {26, 29}
    tt.taunt.normal_pos = vec_2(579, 655)
    tt.taunt.death_pos = vec_2(656, 610)
    tt.taunt.duration = 4
    tt.taunt.attack_duration = 1.25
    tt.taunt.shoutbox = "decal_umbra_guy_shoutbox"
    tt.taunt.ts = 0

    tt = E:register_t("umbra_guy_force_field", "decal_tween")
    tt.render.sprites[1].name = "finalBoss_guy_forceShield_0013"
    tt.render.sprites[1].animated = false
    tt.tween.remove = false
    tt.tween.props[1].name = "scale"
    tt.tween.props[1].keys = {{0, vec_2(1, 1)}, {0.25, vec_2(0.92, 0.92)}, {0.5, vec_2(1, 1)}}
    tt.tween.props[1].loop = true

    tt = E:register_t("ray_umbra_guy", "bullet")
    tt.image_width = 238
    tt.main_script.update = scripts.ray_enemy.update
    tt.render.sprites[1].name = "ray_umbra_guy"
    tt.render.sprites[1].loop = false
    tt.render.sprites[1].anchor = vec_2(0, 0.5)
    tt.bullet.damage_type = DAMAGE_TRUE
    tt.bullet.damage_min = 200
    tt.bullet.damage_max = 400
    tt.bullet.damage_radius = 60.160000000000004
    tt.bullet.max_track_distance = 50
    tt.bullet.vis_bans = bor(F_ENEMY, F_FLYING)
    tt.bullet.hit_time = fts(7)
    tt.bullet.hit_fx = "fx_ray_umbra_guy_explosion"
    tt.sound_events.insert = "TeslaAttack"

    tt = E:register_t("fx_ray_umbra_guy_explosion", "fx")
    tt.render.sprites[1].name = "ray_umbra_guy_explosion"

    tt = E:register_t("decal_umbra_guy_shoutbox", "decal_tween")
    E:add_comps(tt, "texts", "timed")
    tt.render.sprites[1].name = "finalBoss_GuyTauntBox"
    tt.render.sprites[1].animated = false
    tt.render.sprites[1].z = Z_BULLETS
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].z = Z_BULLETS
    tt.render.sprites[2].offset = vec_2(7, 15)
    tt.texts.list[1].text = "Hello world"
    tt.texts.list[1].size = vec_2(168, 60)
    tt.texts.list[1].font_name = "body_bold"
    tt.texts.list[1].font_size = 20
    tt.texts.list[1].color = {255, 145, 114}
    tt.texts.list[1].line_heights = {0.8, 0.8}
    tt.texts.list[1].sprite_id = 2
    tt.texts.list[1].fit_height = true
    tt.tween.props[1].name = "scale"
    tt.tween.props[1].keys = {{0, vec_2(1.01, 1.01)}, {0.4, vec_2(0.99, 0.99)}, {0.8, vec_2(1.01, 1.01)}}
    tt.tween.props[1].sprite_id = 1
    tt.tween.props[1].loop = true
    tt.tween.props[2] = table.deepclone(tt.tween.props[1])
    tt.tween.props[2].sprite_id = 2
    tt.tween.remove = false

    tt = E:register_t("enemy_gunboat", "enemy")
    E:add_comps(tt, "attacks")
    anchor_y = 0.20666666666666667
    image_y = 150
    tt.attacks.list[1] = E:clone_c("bullet_attack")
    tt.attacks.list[1].animations = {"fire_start", "fire_loop", "fire_end"}
    tt.attacks.list[1].bullet = "bomb_gunboat"
    tt.attacks.list[1].bullet_start_offset = vec_2(21, 73)
    tt.attacks.list[1].cooldown = 1
    tt.attacks.list[1].max_range = 5000
    tt.attacks.list[1].min_range = 0
    tt.attacks.list[1].shoot_time = fts(1)
    tt.attacks.list[1].vis_bans = bor(F_ENEMY, F_BOSS, F_FLYING)
    tt.attacks.list[1].vis_flags = F_RANGED
    tt.enemy.gold = 150
    tt.enemy.lives_cost = 0
    tt.health.armor = 0.2
    tt.health.dead_lifetime = 3
    tt.health.hp_max = 1000
    tt.health_bar.offset = vec_2(7, 85)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM_LARGE
    tt.info.fn = scripts.enemy_gunboat.get_info
    tt.info.portrait = IS_PHONE and "portraits_sc_0078" or "kr2_info_portraits_enemies_0059"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_gunboat.update
    tt.motion.max_speed = 0.854 * FPS
    tt.render.sprites[1] = E:clone_c("sprite")
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "enemy_gunboat_l1"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].anchor.y = anchor_y
    tt.render.sprites[2].prefix = "enemy_gunboat_l2"
    tt.render.sprites[3] = E:clone_c("sprite")
    tt.render.sprites[3].anchor.y = anchor_y
    tt.render.sprites[3].prefix = "enemy_gunboat_l3"
    tt.ui.click_rect = r(-40, 0, 80, 60)
    tt.unit.blood_color = BLOOD_NONE
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 25)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 28)
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_STUN, F_BLOCK, F_DRILL, F_POISON, F_TWISTER, F_SKELETON, F_EAT)
    tt.sound_events.death_water = "RTGunboatDeath"

    tt = E:register_t("bomb_gunboat", "bullet")
    tt.bullet.damage_max = 120
    tt.bullet.damage_min = 80
    tt.bullet.damage_radius = 51.2
    tt.bullet.damage_type = DAMAGE_EXPLOSION
    tt.bullet.g = -0.8 / (fts(1) * fts(1))
    tt.bullet.hit_decal = "decal_bomb_crater"
    tt.bullet.hit_fx = "fx_fireball_explosion"
    tt.bullet.particles_name = "ps_bomb_gunboat"
    tt.bullet.pop = {"pop_kboom"}
    tt.bullet.align_with_trajectory = true
    tt.bullet.damage_bans = F_ENEMY
    tt.bullet.damage_flags = F_AREA
    tt.bullet.flight_time_base = fts(50)
    tt.bullet.flight_time_factor = fts(0.04)
    tt.main_script.insert = scripts.enemy_bomb.insert
    tt.main_script.update = scripts.enemy_bomb.update
    tt.render.sprites[1].animated = false
    tt.render.sprites[1].name = "waterCannon_proy"
    tt.sound_events.insert = "SpecialVolcanoLavaShoot"
    tt.sound_events.hit = "BombExplosionSound"

    tt = E:register_t("eb_leviathan", "boss")
    E:add_comps(tt, "attacks")
    anchor_y = 0.15254237288135594
    image_y = 118
    tt.attacks.list[1] = E:clone_c("custom_attack")
    tt.attacks.list[1].cooldown = 12
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(50, 0)
    tt.health.dead_lifetime = fts(200)
    tt.health.hp_max = {10000, 12000, 14000}
    tt.health_bar.offset = vec_2(0, ady(120))
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.info.fn = scripts.eb_leviathan.get_info
    tt.info.portrait = IS_PHONE and "portraits_sc_0077" or "kr2_info_portraits_enemies_0060"
    tt.info.enc_icon = 48
    tt.main_script.insert = scripts.eb_leviathan.insert
    tt.main_script.update = scripts.eb_leviathan.update
    tt.motion.max_speed = 0.384 * FPS
    tt.render.sprites[1] = E:clone_c("sprite")
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "eb_leviathan_water"
    tt.render.sprites[1].name = "spawn"
    tt.render.sprites[1].loop_forced = true
    tt.render.sprites[1].hidden = true
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].anchor.y = anchor_y
    tt.render.sprites[2].prefix = "eb_leviathan"
    tt.render.sprites[2].name = "spawn"
    tt.ui.click_rect = r(-50, 0, 100, 80)
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, ady(47))
    tt.unit.marker_hidden = true
    tt.unit.mod_offset = vec_2(0, ady(65))
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_LARGE
    tt.unit.hit_rect = r(-58, 0, 116, 78)
    tt.vis.bans = F_ALL
    tt.vis.bans_in_battlefield = bor(F_STUN, F_BLOOD, F_DRILL, F_LETHAL, F_SKELETON, F_POLYMORPH, F_TELEPORT, F_BLOCK)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.sound_events.spawn = "RTBossSpawn"
    tt.sound_events.death = "RTBossDeath"

    tt = E:register_t("leviathan_head", "decal")
    tt.render.sprites[1].prefix = "leviathan_head"
    tt.render.sprites[1].name = "show"
    tt.render.sprites[1].anchor.y = 0.4830508474576271

    tt = E:register_t("leviathan_tentacle", "decal_scripted")
    tt.render.sprites[1].prefix = "leviathan_tentacle"
    tt.render.sprites[1].name = "show"
    tt.render.sprites[1].anchor.y = 0.23076923076923078
    tt.main_script.update = scripts.leviathan_tentacle.update
    tt.tower_bans = {"tower_mech"}
    tt.range = 50
    tt.search_off_x = 90
    tt.duration = 8
    tt.interrupt = nil
    tt.flip = nil

    tt = E:register_t("fx_leviathan_incoming", "decal_tween")
    tt.tween.remove = true
    tt.tween.props[1].name = "alpha"
    tt.tween.props[1].keys = {{0, 0}, {1, 255}, {3, 255}}
    tt.tween.props[2] = E:clone_c("tween_prop")
    tt.tween.props[2].name = "scale"
    tt.tween.props[2].keys = {{0, vec_2(0.35, 0.35)}, {3, vec_2(1, 1)}}
    tt.render.sprites[1].name = "fx_leviathan_bubbles"
    tt.render.sprites[1].z = Z_DECALS + 2
    tt.render.sprites[1].loop = true
    tt.render.sprites[1].anchor.y = 0.15254237288135594

    tt = E:register_t("eb_dracula", "boss")
    E:add_comps(tt, "melee")
    image_y = 80
    anchor_y = 0.1375
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(15, 0)
    tt.health.dead_lifetime = fts(10000)
    tt.health.hp_max = 8475
    tt.health_bar.offset = vec_2(0, 60)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.fn = scripts.eb_dracula.get_info
    tt.info.portrait = IS_PHONE and "portraits_sc_0090" or "kr2_info_portraits_enemies_0067"
    tt.info.enc_icon = 57
    tt.main_script.insert = scripts.eb_dracula.insert
    tt.main_script.update = scripts.eb_dracula.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 200
    tt.melee.attacks[1].damage_min = 150
    tt.melee.attacks[1].hit_time = fts(19)
    tt.melee.attacks[2] = E:clone_c("melee_attack")
    tt.melee.attacks[2].mod = "mod_dracula_lifesteal"
    tt.melee.attacks[2].cooldown = 5
    tt.melee.attacks[2].animation = "lifesteal"
    tt.melee.attacks[2].hit_time = fts(6)
    tt.melee.attacks[2].fn_can = scripts.eb_dracula.can_lifesteal
    tt.motion.max_speed = 0.427 * FPS
    tt.motion.max_speed_bat = 2.56 * FPS
    tt.motion.max_speed_default = 0.427 * FPS
    tt.motion.max_speed_angry = 0.747 * FPS
    tt.render.sprites[1] = E:clone_c("sprite")
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].angles = {}
    tt.render.sprites[1].angles.walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    tt.render.sprites[1].prefix = "eb_dracula"
    tt.ui.click_rect = r(-20, -5, 40, 65)
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 33)
    tt.unit.mod_offset = vec_2(0, ady(33))
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_SKELETON)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.sound_events.insert = "MusicBossFight"
    tt.sound_events.death = "HWBossVampireDeath"

    tt = E:register_t("mod_dracula_lifesteal", "modifier")
    tt.modifier.duration = fts(50)
    tt.cycle_time = fts(2)
    tt.heal_hp = 25
    tt.damage = 150
    tt.main_script.update = scripts.mod_dracula_lifesteal.update
    tt.sound_events.insert = "HWBossVampireLifesteal"

    tt = E:register_t("dracula_damage_aura", "aura")
    E:add_comps(tt, "render")
    tt.aura.cycle_time = fts(2)
    tt.aura.duration = -1
    tt.aura.radius = 128
    tt.aura.dist_factor_min_radius = 38.4
    tt.aura.vis_bans = bor(F_ENEMY, F_BOSS)
    tt.aura.vis_flags = F_MOD
    tt.aura.dps_min = 3 * FPS
    tt.aura.dps_max = 18 * FPS
    tt.aura.damage_type = DAMAGE_TRUE
    tt.aura.hero_damage_factor = 0.5555555555555556
    tt.main_script.update = scripts.dracula_damage_aura.update
    tt.render.sprites[1].name = "dracula_damage_aura"
    tt.render.sprites[1].loop = true
    tt.render.sprites[1].anchor = vec_2(0.5289855072463768, 0.48484848484848486)
    tt.render.sprites[1].z = Z_DECALS

    tt = E:register_t("eb_saurian_king", "boss")
    E:add_comps(tt, "melee", "timed_attacks")
    image_y = 150
    anchor_y = 0.16666666666666666
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(25, 0)
    tt.health.armor = 0.5
    tt.health.dead_lifetime = fts(200)
    tt.health.hp_max = 11000
    tt.health_bar.offset = vec_2(0, 103)
    tt.health_bar.type = HEALTH_BAR_SIZE_LARGE
    tt.info.fn = scripts.eb_saurian_king.get_info
    tt.info.portrait = IS_PHONE and "portraits_sc_0096" or "kr2_info_portraits_enemies_0042"
    tt.info.enc_icon = 60
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.eb_saurian_king.update
    tt.motion.max_speed = 1.494 * FPS
    tt.render.sprites[1] = E:clone_c("sprite")
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].angles_stickiness = {
        walk = 10
    }
    tt.render.sprites[1].angles = {}
    tt.render.sprites[1].angles.walk = {"walkingRightLeft", "walkingUp", "walkingDown"}
    tt.render.sprites[1].prefix = "eb_saurian_king"
    tt.ui.click_rect = r(-35, 0, 70, 80)
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 45)
    tt.unit.mod_offset = vec_2(0, 45)
    tt.unit.show_blood_pool = false
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_SKELETON)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
    tt.sound_events.insert = "MusicBossFight"
    tt.sound_events.death = "SaurianKingBossDeath"
    tt.melee.attacks[1] = E:clone_c("area_attack")
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_max = 0
    tt.melee.attacks[1].damage_min = 0
    tt.melee.attacks[1].damage_radius = 25
    tt.melee.attacks[1].hit_time = fts(6)
    tt.melee.attacks[1].hit_offset = tt.enemy.melee_slot
    tt.melee.attacks[1].mod = "mod_saurian_king_tongue"
    tt.melee.attacks[1].sound = "SaurianKingBossTongue"
    tt.timed_attacks.list[1] = E:clone_c("custom_attack")
    tt.timed_attacks.list[1].animations = {"hammer_start", "hammer_loop"}
    tt.timed_attacks.list[1].cooldown = 5
    tt.timed_attacks.list[1].damage_radius = 500
    tt.timed_attacks.list[1].damage_type = DAMAGE_EXPLOSION
    tt.timed_attacks.list[1].hit_times = {fts(11), fts(18)}
    tt.timed_attacks.list[1].max_damage_radius = 50
    tt.timed_attacks.list[1].max_damages = {10, 15, 25, 40, 65, 100, 145, 200}
    tt.timed_attacks.list[1].vis_bans = bor(F_FLYING)
    tt.timed_attacks.list[1].min_damages = {5, 7, 12, 20, 30, 50, 70, 100}
    tt.timed_attacks.list[1].sound = "SaurianKingBossHammer"
    tt.timed_attacks.list[1].vis_flags = F_RANGED
    tt.timed_attacks.list[1].fx_offsets = {vec_2(48, -11), vec_2(62, 1)}

    tt = E:register_t("decal_saurian_king_hammer", "fx")
    tt.render.sprites[1].name = "decal_saurian_king_hammer"
    tt.render.sprites[1].z = Z_DECALS

    tt = E:register_t("mod_saurian_king_tongue", "modifier")
    tt.main_script.insert = scripts.mod_saurian_king_tongue.insert
    tt.modifier.damage_radius = 25
    tt.modifier.damage_max = 150
    tt.modifier.damage_min = 100
    tt.modifier.vis_flags = F_MOD
    tt.modifier.vis_bans = bor(F_ENEMY, F_FLYING)

    tt = E:register_t("enemy_gnoll_reaver", "enemy")
    E:add_comps(tt, "melee")
    image_y = 54
    anchor_y = 9 / image_y
    tt.enemy.gold = 5
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.armor = 0
    tt.health.hp_max = 50
    tt.health.magic_armor = 0
    tt.health_bar.offset = vec_2(0, ady(38))
    tt.info.enc_icon = 1
    tt.info.portrait = "kr3_portraits_sc_0004"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = {6, 6, 7}
    tt.melee.attacks[1].damage_min = {3, 3, 4}
    tt.melee.attacks[1].hit_time = fts(9)
    tt.motion.max_speed = 1.245 * FPS
    tt.render.sprites[1].anchor.y = anchor_y
    tt.render.sprites[1].prefix = "gnoll_reaver"
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, ady(8))
    tt.unit.mod_offset = vec_2(0, ady(20))

    tt = E:register_t("enemy_gnoll_burner", "enemy")
    E:add_comps(tt, "melee", "ranged")
    tt.info.enc_icon = 2
    tt.info.portrait = "kr3_portraits_sc_0006"
    tt.enemy.gold = 5
    tt.enemy.melee_slot = vec_2(27, 0)
    tt.health.hp_max = 50
    tt.health_bar.offset = vec_2(0, 38)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = {4, 4, 10}
    tt.melee.attacks[1].damage_min = {2, 2, 5}
    tt.melee.attacks[1].hit_time = fts(17)
    tt.motion.max_speed = 1.245 * FPS
    tt.ranged.attacks[1].bullet = "torch_gnoll_burner"
    tt.ranged.attacks[1].hold_advance = false
    tt.ranged.attacks[1].shoot_time = fts(7)
    tt.ranged.attacks[1].cooldown = 3
    tt.ranged.attacks[1].max_range = 125
    tt.ranged.attacks[1].min_range = 40
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(0, 36)}
    tt.ranged.attacks[1].vis_flags = bor(F_RANGED, F_CUSTOM, F_BURN)
    tt.render.sprites[1].anchor = vec_2(0.5, 0.21428571428571427)
    tt.render.sprites[1].prefix = "gnoll_burner"
    tt.sound_events.death = "DeathGoblin"
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 16)
    tt.unit.size = UNIT_SIZE_SMALL

    tt = E:register_t("enemy_gnoll_gnawer", "enemy")
    E:add_comps(tt, "melee", "auras")
    tt.info.enc_icon = 3
    tt.info.portrait = "kr3_portraits_sc_0005"
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "aura_gnoll_gnawer"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 20
    tt.enemy.melee_slot = vec_2(35, 0)
    tt.health.armor = {0.4, 0.4, 0.6}
    tt.health.hp_max = {200, 250, 300, 300}
    tt.health_bar.offset = vec_2(0, 47)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1.2
    tt.melee.attacks[1].damage_max = 20
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(17)
    tt.motion.max_speed = 0.913 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.25)
    tt.render.sprites[1].prefix = "gnoll_gnawer"
    tt.sound_events.death = "DeathBig"
    tt.ui.click_rect = r(-20, 0, 40, 40)
    tt.unit.hit_offset = vec_2(0, 22)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 19)
    tt.unit.size = UNIT_SIZE_MEDIUM

    tt = E:register_t("enemy_gnoll_blighter", "enemy")
    E:add_comps(tt, "melee", "ranged", "timed_attacks")
    tt.info.portrait = "kr3_portraits_sc_0019"
    tt.info.enc_icon = 4
    tt.enemy.gold = 50
    tt.enemy.melee_slot = vec_2(30, 0)
    tt.health.hp_max = 700
    tt.health.magic_armor = {0.75, 0.75, 0.85}
    tt.health_bar.offset = vec_2(0, 42)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_gnoll_blighter.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 12
    tt.melee.attacks[1].damage_min = 8
    tt.melee.attacks[1].hit_time = fts(23)
    tt.motion.max_speed = 0.664 * FPS
    tt.ranged.attacks[1].animation = "energy"
    tt.ranged.attacks[1].bullet = "bullet_gnoll_blighter"
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].shoot_time = fts(20)
    tt.ranged.attacks[1].cooldown = 1 + fts(23) + fts(6)
    tt.ranged.attacks[1].max_range = 160
    tt.ranged.attacks[1].min_range = 30
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(14, 0)}
    tt.ranged.attacks[1].vis_flags = bor(F_RANGED)
    tt.ranged.attacks[1].vis_bans = F_FLYING
    tt.ranged.attacks[1].requires_magic = true
    tt.render.sprites[1].anchor = vec_2(0.5, 0.1891891891891892)
    tt.render.sprites[1].prefix = "gnoll_blighter"
    tt.sound_events.death = "DeathBig"
    tt.timed_attacks.list[1] = E:clone_c("mod_attack")
    tt.timed_attacks.list[1].cooldown = 5
    tt.timed_attacks.list[1].mod = "mod_gnoll_blighter"
    tt.timed_attacks.list[1].cast_time = fts(15)
    tt.timed_attacks.list[1].animation = "attackPlants"
    tt.timed_attacks.list[1].range = 175
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 16)
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)

    tt = E:register_t("enemy_hyena", "enemy")
    E:add_comps(tt, "melee")
    tt.info.enc_icon = 7
    tt.info.portrait = "kr3_portraits_sc_0008"
    tt.enemy.gold = 10
    tt.enemy.melee_slot = vec_2(10, 0)
    tt.health.hp_max = 40
    tt.health.magic_armor = {0.3, 0.3, 0.7}
    tt.health_bar.offset = vec_2(0, 35)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_hyena.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 0
    tt.melee.attacks[1].damage_min = 0
    tt.melee.attacks[1].hit_time = fts(22)
    tt.motion.max_speed = 2.158 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.3382352941176471)
    tt.render.sprites[1].prefix = "hyena"
    tt.render.sprites[1].angles.run = {"runningRightLeft", "runningUp", "runningDown"}
    tt.render.sprites[1].angles_stickiness.run = 10
    tt.sound_events.death = "DeathGoblin"
    tt.sound_events.insert = "ElvesCreepHyena"
    tt.unit.hit_offset = vec_2(0, 12)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 15)
    tt.coward_duration = 1.2
    tt.coward_speed_factor = 1.5

    tt = E:register_t("enemy_ettin", "enemy")
    E:add_comps(tt, "melee", "auras", "endless")
    tt.info.portrait = "kr3_portraits_sc_0014"
    tt.info.enc_icon = 5
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "aura_ettin_regen"
    tt.auras.list[1].cooldown = 0
    tt.endless.factor_map = {{"enemy_ettin.basicCooldownTime", "insane.cooldown_min", true},
                             {"enemy_ettin.basicCooldownTime", "insane.cooldown_max", true}}
    tt.enemy.gold = 70
    tt.enemy.lives_cost = {2, 2, 4}
    tt.enemy.melee_slot = vec_2(35, 0)
    tt.health.hp_max = 900
    tt.health_bar.offset = vec_2(0, 72)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_ettin.update
    tt.melee.attacks[1].cooldown = 1.2
    tt.melee.attacks[1].damage_max = {95, 95, 105}
    tt.melee.attacks[1].damage_min = {85, 85, 85}
    tt.melee.attacks[1].hit_time = fts(23)
    tt.motion.max_speed = 0.581 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.1111111111111111)
    tt.render.sprites[1].prefix = "ettin"
    tt.sound_events.death = "DeathBig"
    tt.unit.hit_offset = vec_2(0, 32)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 30)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.insane = {}
    tt.insane.cooldown_max = 22
    tt.insane.cooldown_min = 12
    tt.insane.damage_max = 10
    tt.insane.damage_min = 5
    tt.insane.damage_type = DAMAGE_TRUE
    tt.insane.stun_duration = 2
    tt.insane.hit_time = fts(28)
    tt.ui.click_rect = r(-25, -5, 50, 60)

    tt = E:register_t("enemy_perython", "enemy")
    tt.info.enc_icon = 6
    tt.info.portrait = "kr3_portraits_sc_0009"
    tt.enemy.gold = 18
    tt.health.hp_max = {90, 120, 120}
    tt.health_bar.offset = vec_2(0, 90)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_passive.update
    tt.motion.max_speed = {1.494 * FPS, 1.494 * FPS, 1.992 * FPS}
    tt.render.sprites[1].anchor = vec_2(0.5, 0.058823529411764705)
    tt.render.sprites[1].prefix = "perython"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].offset = vec_2(0, 0)
    tt.sound_events.death = "DeathPuff"
    tt.ui.click_rect = r(-15, 50, 30, 25)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 65)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 60)
    tt.unit.size = UNIT_SIZE_SMALL
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_BLOCK, F_SKELETON)
    tt.vis.flags = bor(F_ENEMY, F_FLYING)

    tt = E:register_t("enemy_perython_gnoll_gnawer", "enemy_perython")
    E:add_comps(tt, "death_spawns")
    tt.info.i18n_key = "ENEMY_PERYTHON"
    tt.render.sprites[3] = E:clone_c("sprite")
    tt.render.sprites[3].prefix = "gnoll_gnawer_flying"
    tt.render.sprites[3].anchor = vec_2(0.5, 0.25)
    tt.death_spawns.name = "enemy_gnoll_gnawer"
    tt.death_spawns.concurrent_with_death = false
    tt.main_script.update = scripts.enemy_perython_carrier.update
    tt.spawn_trigger_range = 100

    tt = E:register_t("enemy_twilight_elf_harasser", "enemy")
    E:add_comps(tt, "melee", "ranged", "dodge")
    tt.info.enc_icon = 8
    tt.info.portrait = "kr3_portraits_sc_0021"
    tt.dodge.ranged = false
    tt.dodge.cooldown = 7
    tt.dodge.chance = 1
    tt.dodge.max_nodes = -15
    tt.dodge.min_nodes = -24
    tt.dodge.nodeslimit = 15
    tt.dodge.requires_magic = true
    tt.enemy.gold = 25
    tt.enemy.melee_slot = vec_2(26, 0)
    tt.health.armor = {0.3, 0.45, 0.6}
    tt.health.hp_max = 240
    tt.health_bar.offset = vec_2(0, 34)
    tt.health.armor_resilience = 0.6
    tt.info.enc_icon = 8
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_twilight_elf_harasser.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = {30, 30, 35}
    tt.melee.attacks[1].damage_min = {20, 20, 25}
    tt.melee.attacks[1].hit_time = fts(24)
    tt.motion.max_speed = 1.245 * FPS
    tt.ranged.attacks[1].animations = {"shoot_start", "shoot_loop", "shoot_end"}
    tt.ranged.attacks[1].bullet = "arrow_twilight_elf_harasser"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(0, 27)}
    tt.ranged.attacks[1].cooldown = 10
    tt.ranged.attacks[1].loops = 4
    tt.ranged.attacks[1].max_range = 125
    tt.ranged.attacks[1].min_range = 60
    tt.ranged.attacks[1].repeat_cooldown = fts(20)
    tt.ranged.attacks[1].shoot_time = fts(3)
    tt.ranged.attacks[1].vis_flags = bor(F_RANGED, F_CUSTOM)
    tt.render.sprites[1].anchor = vec_2(0.5, 0.1891891891891892)
    tt.render.sprites[1].prefix = "harraser"
    tt.sound_events.death = "DeathHuman"
    tt.unit.hit_offset = vec_2(0, 16)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 15)
    tt.vis.flags = bor(tt.vis.flags, F_DARK_ELF, F_SPELLCASTER)
    tt.shadow_shot = E:clone_c("bullet_attack")
    tt.shadow_shot.bullet = "arrow_twilight_elf_harasser_shadowshot"
    tt.shadow_shot.animation = "shadow_shot"
    tt.shadow_shot.shoot_time = fts(14)
    tt.shadow_shot.bullet_start_offset = {vec_2(0, 27)}
    tt.shadow_shot.min_range = 0
    tt.shadow_shot.max_range = 200

    tt = E:register_t("enemy_catapult", "enemy")
    E:add_comps(tt, "ranged")
    tt.duration = nil
    tt.enemy.gold = 100
    tt.enemy.melee_slot = vec_2(40, -10)
    tt.enemy.remove_at_goal_line = false
    tt.health.hp_max = 200
    tt.health.dead_lifetime = 3
    tt.health_bar.offset = vec_2(0, 60)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.i18n_key = "ENEMY_GNOLL_CATAPULT"
    tt.info.portrait = "kr3_portraits_sc_0051"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_catapult.update
    tt.motion.max_speed = 37.35
    tt.phase_1_ni = nil
    tt.ranged.attacks[1].bullet = "rock_enemy_catapult"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(30, 90)}
    tt.ranged.attacks[1].cooldown = 3 + fts(80)
    tt.ranged.attacks[1].max_x = 800
    tt.ranged.attacks[1].min_x = 150
    tt.ranged.attacks[1].shoot_time = fts(33)
    tt.ranged.attacks[1].vis_bans = bor(F_ENEMY, F_FLYING)
    tt.render.sprites[1].anchor.y = 0.14285714285714285
    tt.render.sprites[1].angles.walk = {"running"}
    tt.render.sprites[1].prefix = "catapult"
    tt.ui.click_rect = r(-35, -10, 70, 60)
    tt.unit.blood_color = BLOOD_GRAY
    tt.unit.can_explode = false
    tt.unit.mod_offset = vec_2(0, 34)
    tt.unit.hit_offset = vec_2(0, 34)
    tt.unit.marker_offset = vec_2(0, -5)
    tt.unit.size = UNIT_SIZE_LARGE
    tt.vis.bans = bor(F_STUN, F_TELEPORT, F_DRILL, F_POISON, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)

    tt = E:register_t("rock_enemy_catapult", "bomb")
    tt.bullet.damage_bans = F_ENEMY
    tt.bullet.damage_flags = F_AREA
    tt.bullet.damage_max = 200
    tt.bullet.damage_min = 150
    tt.bullet.damage_radius = 50
    tt.bullet.damage_type = DAMAGE_PHYSICAL
    tt.bullet.flight_time_base = fts(60)
    tt.bullet.flight_time_factor = fts(0.04)
    tt.bullet.hit_decal = "decal_rock_crater"
    tt.bullet.hit_fx = "fx_rock_explosion"
    tt.main_script.insert = scripts.enemy_bomb.insert
    tt.main_script.update = scripts.enemy_bomb.update
    tt.render.sprites[1].name = "catapult_proy"
    tt.sound_events.insert = "TowerStoneDruidBoulderThrow"

    tt = E:register_t("enemy_bandersnatch", "enemy")
    E:add_comps(tt, "melee", "timed_attacks")
    tt.info.enc_icon = 16
    tt.info.portrait = "kr3_portraits_sc_0012"
    tt.enemy.gold = 300
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(42, 0)
    tt.health.hp_max = 3000
    tt.health_bar.offset = vec_2(0, 63)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.melee.attacks[1] = E:clone_c("area_attack")
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_radius = 100
    tt.melee.attacks[1].damage_max = 60
    tt.melee.attacks[1].damage_min = 40
    tt.melee.attacks[1].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[1].hit_time = fts(24)
    tt.melee.attacks[1].fn_filter = scripts.enemy_bandersnatch.fn_filter_melee
    tt.timed_attacks.list[1] = E:clone_c("aura_attack")
    tt.timed_attacks.list[1].animation = "spineAttack"
    tt.timed_attacks.list[1].bullet = "aura_bandersnatch_spines"
    tt.timed_attacks.list[1].cooldown = 4
    tt.timed_attacks.list[1].shoot_time = fts(31)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_bandersnatch.update
    tt.motion.min_speed = 2.075 * FPS
    tt.motion.max_speed = 2.075 * FPS
    tt.motion.speed_limit = {3.5 * FPS, 3.5 * FPS, 4.5 * FPS}
    tt.motion.accel = 0.2 * FPS
    tt.motion.invulnerable = true
    tt.render.sprites[1].anchor = vec_2(0.5, 0.25862068965517243)
    tt.render.sprites[1].prefix = "bandersnatch"
    tt.sound_events.death = "DeathBig"
    tt.ui.click_rect = r(-20, -2, 40, 52)
    tt.unit.hit_offset = vec_2(0, 19)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 24)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans_rolling = bor(F_SKELETON, F_STUN, F_FREEZE)
    tt.vis.bans_standing = bor(F_SKELETON)
    tt.vis.bans = tt.vis.bans_standing

    tt = E:register_t("enemy_boomshrooms", "enemy")
    E:add_comps(tt, "death_spawns")
    tt.info.enc_icon = 32
    tt.info.portrait = "kr3_portraits_sc_0017"
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.name = "aura_boomshrooms_death"
    tt.unit.explode_when_silenced_death = true
    tt.enemy.gold = 6
    tt.enemy.melee_slot = vec_2(25, 0)
    tt.health.hp_max = 75
    tt.health.poison_armor = 0.5
    tt.health_bar.offset = vec_2(0, 25)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_boomshrooms.update
    tt.motion.max_speed = 1.66 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.1956521739130435)
    tt.render.sprites[1].prefix = "fungusRider_small"
    tt.sound_events.death = "DeathPuff"
    tt.unit.blood_color = BLOOD_VIOLET
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 13)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 16)
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_SKELETON)

    tt = E:register_t("enemy_munchshrooms", "enemy")
    E:add_comps(tt, "melee", "death_spawns")
    tt.info.enc_icon = 31
    tt.info.portrait = "kr3_portraits_sc_0016"
    tt.death_spawns.name = "enemy_boomshrooms"
    tt.death_spawns.delay = 0.93
    tt.death_spawns.quantity = {2, 2, 3}
    tt.death_spawns.spread_nodes = 2
    tt.enemy.gold = 12
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(23, 0)
    tt.health.hp_max = 200
    tt.health.poison_armor = 0.5
    tt.health_bar.offset = vec_2(0, 40)
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = {15, 15, 30}
    tt.melee.attacks[1].damage_min = 5
    tt.melee.attacks[1].hit_time = fts(21)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.motion.max_speed = 1.245 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.17142857142857143)
    tt.render.sprites[1].prefix = "fungusRider_medium"
    tt.sound_events.death = "DeathEplosion"
    tt.unit.blood_color = BLOOD_VIOLET
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 14)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 16)
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_SKELETON)

    tt = E:register_t("enemy_shroom_breeder", "enemy")
    E:add_comps(tt, "melee", "death_spawns", "timed_attacks")
    tt.info.enc_icon = 15
    tt.info.portrait = "kr3_portraits_sc_0015"
    tt.death_spawns.name = "enemy_munchshrooms"
    tt.death_spawns.delay = 0.5
    tt.death_spawns.quantity = {2, 2, 3}
    tt.death_spawns.spread_nodes = 2
    tt.enemy.gold = 25
    tt.enemy.lives_cost = 4
    tt.enemy.melee_slot = vec_2(25, 0)
    tt.health.hp_max = 600
    tt.health.poison_armor = 0.5
    tt.health_bar.offset = vec_2(0, 58)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_shroom_breeder.update
    tt.melee.attacks[1].cooldown = 1.5
    tt.melee.attacks[1].damage_max = 40
    tt.melee.attacks[1].damage_min = 20
    tt.melee.attacks[1].hit_time = fts(25)
    tt.motion.max_speed = 0.83 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.125)
    tt.render.sprites[1].prefix = "fungusRider"
    tt.sound_events.death = "DeathPuff"
    tt.timed_attacks.list[1] = E:clone_c("custom_attack")
    tt.timed_attacks.list[1].allowed_templates = {"enemy_boomshrooms"}
    tt.timed_attacks.list[1].spawn_name = "enemy_munchshrooms"
    tt.timed_attacks.list[1].animation = "cast"
    tt.timed_attacks.list[1].cast_time = fts(19)
    tt.timed_attacks.list[1].cooldown = 5
    tt.timed_attacks.list[1].max_range = 125
    tt.timed_attacks.list[1].max_count = 5
    tt.timed_attacks.list[1].vis_flags = F_RANGED
    tt.unit.blood_color = BLOOD_VIOLET
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 15)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 22)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_SKELETON)
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)

    tt = E:register_t("enemy_gloomy", "enemy")
    E:add_comps(tt, "melee", "timed_attacks", "count_group")
    tt.info.enc_icon = 17
    tt.info.portrait = "kr3_portraits_sc_0018"
    tt.count_group.name = "enemy_gloomy"
    tt.count_group.type = COUNT_GROUP_CONCURRENT
    tt.enemy.gold = 5
    tt.enemy.melee_slot = vec_2(18, 0)
    tt.health.hp_max = {30, 35, 40}
    tt.health_bar.offset = vec_2(0, 67)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_gloomy.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 0
    tt.melee.attacks[1].damage_min = 0
    tt.melee.attacks[1].hit_time = fts(19)
    tt.motion.max_speed = 1.245 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.04054054054054054)
    tt.render.sprites[1].prefix = "gloomy"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].offset = vec_2(0, 0)
    tt.sound_events.death = "DeathPuff"
    tt.timed_attacks.list[1] = E:clone_c("custom_attack")
    tt.timed_attacks.list[1].spawn_name = "enemy_gloomy"
    tt.timed_attacks.list[1].animation = "castClone"
    tt.timed_attacks.list[1].cast_time = fts(8)
    tt.timed_attacks.list[1].cooldown_after = 5
    tt.timed_attacks.list[1].cooldown = 3
    tt.timed_attacks.list[1].count_group_max = 100
    tt.timed_attacks.list[1].nodes_limit = 30
    tt.timed_attacks.list[1].max_clones = {2, 2, 3}
    tt.ui.click_rect = r(-12, 24, 24, 36)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 32)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 37)
    tt.unit.show_blood_pool = false
    tt.vis.bans = bor(F_BLOCK, F_SKELETON)
    tt.vis.flags = bor(F_ENEMY, F_FLYING)

    tt = E:register_t("enemy_redcap", "enemy")
    E:add_comps(tt, "melee")
    tt.info.enc_icon = 14
    tt.info.portrait = "kr3_portraits_sc_0024"
    tt.enemy.gold = 12
    tt.enemy.melee_slot = vec_2(27, 0)
    tt.health.hp_max = 120
    tt.health_bar.offset = vec_2(0, 28)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].damage_max = {25, 25, 35}
    tt.melee.attacks[1].damage_min = {15, 15, 25}
    tt.melee.attacks[1].hit_time = fts(23)
    tt.melee.attacks[1].shared_cooldown = true
    tt.melee.attacks[2] = E:clone_c("melee_attack")
    tt.melee.attacks[2].animation = "special"
    tt.melee.attacks[2].chance = 0.2
    tt.melee.attacks[2].fn_can = function(t, s, a, target)
        return band(target.vis.flags, F_HERO) == 0
    end
    tt.melee.attacks[2].hit_time = fts(15)
    tt.melee.attacks[2].hit_offset = vec_2(24, 10)
    tt.melee.attacks[2].instakill = true
    tt.melee.attacks[2].shared_cooldown = true
    tt.melee.attacks[2].mod = "mod_redcap_heal"
    tt.melee.attacks[3] = table.deepclone(tt.melee.attacks[2])
    tt.melee.attacks[3].chance = 0.1
    tt.melee.attacks[3].damage_max = 100
    tt.melee.attacks[3].damage_min = 100
    tt.melee.attacks[3].fn_can = function(t, s, a, target)
        return band(target.vis.flags, F_HERO) ~= 0
    end
    tt.melee.attacks[3].instakill = nil
    tt.melee.cooldown = 1.2
    tt.motion.max_speed = 1.8 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.20833333333333334)
    tt.render.sprites[1].prefix = "redcap"
    tt.sound_events.death = "DeathHuman"
    tt.unit.hit_offset = vec_2(0, 10)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 12)

    tt = E:register_t("enemy_satyr_cutthroat", "enemy")
    E:add_comps(tt, "melee", "ranged")
    tt.info.enc_icon = 12
    tt.info.portrait = "kr3_portraits_sc_0025"
    tt.enemy.gold = 15
    tt.enemy.melee_slot = vec_2(25, 0)
    tt.health.hp_max = 150
    tt.health_bar.offset = vec_2(0, 35)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 0.8
    tt.melee.attacks[1].damage_max = 10
    tt.melee.attacks[1].damage_min = 6
    tt.melee.attacks[1].hit_time = fts(20)
    tt.motion.max_speed = 1.826 * FPS
    tt.ranged.attacks[1].animations = {"shoot_start", "shoot_loop", "shoot_end"}
    tt.ranged.attacks[1].bullet = "knife_satyr"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(13, 15), vec_2(13, 15)}
    tt.ranged.attacks[1].cooldown = {3, 3, 2.5}
    tt.ranged.attacks[1].loops = 1
    tt.ranged.attacks[1].max_range = 90
    tt.ranged.attacks[1].min_range = 10
    tt.ranged.attacks[1].shoot_times = {fts(5), fts(15)}
    tt.render.sprites[1].anchor = vec_2(0.5, 0.125)
    tt.render.sprites[1].prefix = "satyr"
    tt.sound_events.death = "DeathHuman"
    tt.unit.hit_offset = vec_2(0, 15)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 14)

    tt = E:register_t("enemy_satyr_hoplite", "enemy")
    E:add_comps(tt, "melee", "timed_attacks")
    tt.info.enc_icon = 13
    tt.info.portrait = "kr3_portraits_sc_0026"
    tt.enemy.gold = 60
    tt.enemy.melee_slot = vec_2(32, 0)
    tt.health.armor = {0.5, 0.5, 0.75}
    tt.health.hp_max = 700
    tt.health_bar.offset = vec_2(0, 49)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_satyr_hoplite.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 35
    tt.melee.attacks[1].damage_min = 25
    tt.melee.attacks[1].hit_time = fts(24)
    tt.motion.max_speed = 1.245 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.1167)
    tt.render.sprites[1].prefix = "satyrHoplite"
    tt.timed_attacks.list[1] = E:clone_c("spawn_attack")
    tt.timed_attacks.list[1].entity = "satyr_hoplite_spawner"
    tt.timed_attacks.list[1].animation = "cast"
    tt.timed_attacks.list[1].spawn_time = fts(16)
    tt.timed_attacks.list[1].cooldown = {8, 8, 6}
    tt.timed_attacks.list[1].count_group_name = "enemy_satyr_cutthroat_from_hoplite"
    tt.timed_attacks.list[1].count_group_type = COUNT_GROUP_CONCURRENT
    tt.timed_attacks.list[1].count_group_max = 12
    tt.timed_attacks.list[1].nodes_limit = 60
    tt.timed_attacks.list[1].sound = "ElvesCreepHoplite"
    tt.sound_events.death = "DeathHuman"
    tt.ui.click_rect = r(-25, 0, 50, 60)
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 20)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)

    tt = E:register_t("satyr_hoplite_spawner")
    E:add_comps(tt, "pos", "spawner", "main_script")
    tt.main_script.update = scripts.enemies_spawner.update
    tt.spawner.count = 3
    tt.spawner.random_cycle = {0, 1}
    tt.spawner.entity = "enemy_satyr_cutthroat"
    tt.spawner.random_node_offset_range = {-12, -7}
    tt.spawner.random_subpath = true
    tt.spawner.initial_spawn_animation = "raise"
    tt.spawner.check_node_valid = true
    tt.spawner.use_node_pos = true

    tt = E:register_t("enemy_twilight_avenger", "enemy")
    E:add_comps(tt, "melee", "timed_attacks")
    tt.info.enc_icon = 9
    tt.info.portrait = "kr3_portraits_sc_0032"
    tt.enemy.gold = 30
    tt.enemy.melee_slot = vec_2(30, 0)
    tt.health.armor = 0.5
    tt.health.hp_max = 1100
    tt.health_bar.offset = vec_2(0, 47)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.health.armor_resilience = 0.4
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_twilight_avenger.update
    tt.melee.attacks[1].cooldown = 1.5
    tt.melee.attacks[1].damage_max = {75, 75, 125}
    tt.melee.attacks[1].damage_min = {50, 50, 100}
    tt.melee.attacks[1].hit_time = fts(24)
    tt.timed_attacks.list[1] = E:clone_c("mod_attack")
    tt.timed_attacks.list[1].animation = "cast"
    tt.timed_attacks.list[1].cast_time = fts(16)
    tt.timed_attacks.list[1].cooldown = 7
    tt.timed_attacks.list[1].vis_bans = bor(F_BOSS, F_DARK_ELF)
    tt.timed_attacks.list[1].vis_flags = bor(F_RANGED, F_ENEMY)
    tt.timed_attacks.list[1].max_range = 125
    tt.timed_attacks.list[1].mod = "mod_twilight_avenger_last_service"
    tt.timed_attacks.list[1].sound = "ElvesCreepAvenger"
    tt.vis.flags = bor(tt.vis.flags, F_DARK_ELF)
    tt.motion.max_speed = 0.913 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.15)
    tt.render.sprites[1].prefix = "twilight_avenger"
    tt.sound_events.death = "DeathHuman"
    tt.shield_extra_armor = 0.4
    tt.shield_off_armor = tt.health.armor
    tt.shield_on_armor = tt.health.armor + tt.shield_extra_armor
    tt.ui.click_rect = r(-20, 0, 40, 40)
    tt.unit.hit_offset = vec_2(0, 22)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 23)
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)

    tt = E:register_t("mod_twilight_avenger_last_service", "modifier")
    E:add_comps(tt, "render")
    tt.modifier.duration = -1
    tt.render.sprites[1].prefix = "mod_twilight_avenger_last_service"
    tt.render.sprites[1].size_names = {"small", "big", "big"}
    tt.render.sprites[1].name = "small"
    tt.render.sprites[1].draw_order = 10
    tt.main_script.insert = scripts.mod_track_target.insert
    tt.main_script.update = scripts.mod_track_target.update
    tt.main_script.remove = scripts.mod_twilight_avenger_last_service.remove
    tt.explode_fx = "fx_twilight_avenger_explosion"
    tt.explode_range = 60
    tt.explode_damage = 80
    tt.explode_vis_bans = bor(F_DARK_ELF, F_BOSS)
    tt.explode_vis_flags = F_RANGED
    tt.explode_excluded_templates = {"hero_regson"}


    tt = E:register_t("enemy_twilight_scourger", "enemy")
    E:add_comps(tt, "melee", "death_spawns", "timed_attacks")
    tt.info.enc_icon = 11
    tt.info.portrait = "kr3_portraits_sc_0027"
    tt.death_spawns.name = "enemy_twilight_scourger_banshee"
    tt.death_spawns.delay = fts(5)
    tt.death_spawns.quantity = 1
    tt.enemy.gold = 40
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.health.hp_max = 500
    tt.health.magic_armor = {0.8, 0.8, 0.9}
    tt.health_bar.offset = vec_2(0, 37)
    tt.health.dead_lifetime = 2.5
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_twilight_scourger.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 35
    tt.melee.attacks[1].damage_min = 15
    tt.melee.attacks[1].hit_time = fts(23)
    tt.timed_attacks.list[1] = E:clone_c("custom_attack")
    tt.timed_attacks.list[1].animation = "special"
    tt.timed_attacks.list[1].event_times = {fts(8), fts(14), fts(16), fts(24)}
    tt.timed_attacks.list[1].cooldown = {7, 7, 5}
    tt.timed_attacks.list[1].damage_type = DAMAGE_PHYSICAL
    tt.timed_attacks.list[1].damage_min = 5
    tt.timed_attacks.list[1].damage_max = 10
    tt.timed_attacks.list[1].vis_bans = bor(F_BOSS)
    tt.timed_attacks.list[1].excluded_templates = {"enemy_twilight_scourger", "enemy_twilight_scourger_banshee"}
    tt.timed_attacks.list[1].max_range = 75
    tt.timed_attacks.list[1].max_cast_range = 50
    tt.timed_attacks.list[1].mod = "mod_twilight_scourger_lash"
    tt.timed_attacks.list[1].sound = "ElvesCreepScreecher"
    tt.timed_attacks.list[1].min_count = 2
    tt.timed_attacks.list[1].loops = 3
    tt.timed_attacks.list[1].cast_fx = "fx_twilight_scourger_lash"
    tt.timed_attacks.list[1].cast_decal = "decal_twilight_scourger_lash"
    tt.motion.max_speed = 0.83 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.14705882352941177)
    tt.render.sprites[1].prefix = "scourger"
    tt.sound_events.death = "ElvesScourgerDeath"
    tt.unit.hit_offset = vec_2(0, 20)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 18)
    tt.vis.flags = bor(tt.vis.flags, F_DARK_ELF, F_SPELLCASTER)

    tt = E:register_t("enemy_twilight_scourger_banshee", "enemy")
    E:add_comps(tt, "mod_attack", "tween")
    tt.info.portrait = "kr3_portraits_sc_0028"
    tt.mod_attack.cooldown = 1
    tt.mod_attack.mod = "mod_twilight_scourger_banshee"
    tt.mod_attack.max_range = 180
    tt.mod_attack.excluded_templates = {"tower_baby_ashbite", "tower_black_baby_dragon"}
    tt.mod_attack.max_speed = 12 * FPS
    tt.enemy.gold = 0
    tt.enemy.lives_cost = 0
    tt.enemy.melee_slot = vec_2(29, 0)
    tt.fade_nodes_to_defend_point = 25
    tt.health.armor = 1
    tt.health.hp_max = 90
    tt.health.immune_to = DAMAGE_ALL_TYPES
    tt.health_bar.offset = vec_2(0, 42)
    tt.health_bar.hidden = true
    tt.main_script.update = scripts.enemy_twilight_scourger_banshee.update
    tt.motion.max_speed = 4.98 * FPS
    tt.particles_name = "ps_twilight_scourger_banshee"
    tt.sound_events.death = nil
    tt.render.sprites[1].anchor = vec_2(0.5, 0.13043478260869565)
    tt.render.sprites[1].prefix = "scourger_shadow"
    tt.render.sprites[1].sort_y_offset = -2
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].animated = false
    tt.unit.blood_color = BLOOD_NONE
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 18)
    tt.vis.flags = 0
    tt.vis.bans = band(F_ALL, bnot(bor(F_MOD, F_TELEPORT)))
    tt.tween.disabled = true
    tt.tween.remove = true
    tt.tween.props[1].keys = {{0, 255}, {2, 0}}
    tt.tween.props[2] = table.deepclone(tt.tween.props[1])
    tt.tween.props[2].sprite_id = 2

    tt = E:register_t("enemy_webspitting_spider", "enemy")
    E:add_comps(tt, "melee", "timed_attacks")
    tt.info.enc_icon = 18
    tt.info.portrait = "kr3_portraits_sc_0035"
    tt.enemy.gold = 60
    tt.enemy.melee_slot = vec_2(36, 0)
    tt.health.hp_max = 550
    tt.health.magic_armor = 0.85
    tt.health.poison_armor = 0.5
    tt.health_bar.offset = vec_2(0, 40)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 14
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(18)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_webspitting_spider.update
    tt.motion.max_speed = 1.7 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.2714285714285714)
    tt.render.sprites[1].prefix = "webspitting_spider"
    tt.sound_events.death = "DeathEplosion"
    tt.timed_attacks.list[1] = E:clone_c("mod_attack")
    tt.timed_attacks.list[1].animation = "spitWeb"
    tt.timed_attacks.list[1].cast_time = fts(11)
    tt.timed_attacks.list[1].cooldown = {6, 6, 6, 4}
    tt.timed_attacks.list[1].mod = "mod_spider_web"
    tt.timed_attacks.list[1].vis_flags = bor(F_NET, F_STUN)
    tt.ui.click_rect = r(-20, 0, 40, 30)
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.hit_offset = vec_2(0, 12)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 12)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_SKELETON)

    tt = E:register_t("enemy_sword_spider", "enemy")
    E:add_comps(tt, "melee")
    tt.info.enc_icon = 10
    tt.info.portrait = "kr3_portraits_sc_0007"
    tt.enemy.gold = 16
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.health.hp_max = 135
    tt.health.magic_armor = {0.75, 0.75, 0.9}
    tt.health.poison_armor = 0.5
    tt.health_bar.offset = vec_2(0, 28)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1.2
    tt.melee.attacks[1].damage_max = 12
    tt.melee.attacks[1].damage_min = 8
    tt.melee.attacks[1].hit_time = fts(17)
    tt.motion.max_speed = 1.411 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.13157894736842105)
    tt.render.sprites[1].prefix = "sword_spider"
    tt.sound_events.death = "DeathEplosion"
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.hit_offset = vec_2(0, 12)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 12)
    tt.vis.bans = bor(F_SKELETON)

    tt = E:register_t("enemy_rabbit", "enemy")
    tt.info.portrait = "kr3_portraits_sc_0023"
    tt.enemy.gold = 7
    tt.health.hp_max = 80
    tt.health_bar.offset = vec_2(0, 20)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_passive.update
    tt.motion.max_speed = 0.747 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.21428571428571427)
    tt.render.sprites[1].prefix = "rabbit"
    tt.sound_events.death = "DeathEplosion"
    tt.ui.click_rect = r(-10, -5, 20, 20)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 10)
    tt.unit.size = UNIT_SIZE_SMALL
    tt.vis.bans = bor(F_BLOCK, F_SKELETON)

    tt = E:register_t("enemy_zealot", "enemy")
    E:add_comps(tt, "melee", "tween")
    tt.enemy.gold = 40
    tt.enemy.lives_cost = 0
    tt.enemy.melee_slot = vec_2(25, 0)
    tt.health.hp_max = 0
    tt.health_bar.offset = vec_2(0, 36)
    tt.info.portrait = "kr3_portraits_sc_0063"
    tt.info.i18n_key = "ENEMY_BOSS_DROW_QUEEN_ZEALOT"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_zealot.update
    tt.melee.attacks[1].cooldown = 1.2
    tt.melee.attacks[1].damage_max = 20
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(8)
    tt.motion.max_speed = 0.664 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.078125)
    tt.render.sprites[1].prefix = "zealot"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].animated = false
    tt.render.sprites[2].name = "zealot_glow_0001"
    tt.render.sprites[2].anchor.y = 0.06666666666666667
    tt.render.sprites[2].draw_order = 2
    tt.render.sprites[3] = E:clone_c("sprite")
    tt.render.sprites[3].animated = false
    tt.render.sprites[3].name = "zealot_glow_0002"
    tt.render.sprites[3].anchor.y = 0.06666666666666667
    tt.render.sprites[3].draw_order = -2
    tt.tween.remove = false
    tt.tween.disabled = true
    tt.tween.props[1].keys = {{0, 255}, {0.3, 0}}
    tt.tween.props[1].sprite_id = 2
    tt.tween.props[2] = table.deepclone(tt.tween.props[1])
    tt.tween.props[2].sprite_id = 3
    tt.unit.hit_offset = vec_2(0, 15)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 15)
    tt.unit.show_blood_pool = false
    tt.vis.flags = bor(tt.vis.flags, F_DARK_ELF)

    tt = E:register_t("enemy_twilight_evoker", "enemy")
    E:add_comps(tt, "melee", "ranged", "timed_attacks")
    tt.enemy.gold = 65
    tt.enemy.melee_slot = vec_2(15, 0)
    tt.info.i18n_key = "ENEMY_EVOKER"
    tt.info.enc_icon = 21
    tt.info.portrait = "kr3_portraits_sc_0033"
    tt.health.hp_max = 600
    tt.health.magic_armor = {0.75, 0.75, 0.9}
    tt.health.armor_resilience = 0.6
    tt.health_bar.offset = vec_2(0, 38)
    tt.motion.max_speed = 0.913 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.175)
    tt.render.sprites[1].prefix = "twilight_evoker"
    tt.sound_events.death = "ElvesScourgerDeath"
    tt.unit.hit_offset = vec_2(0, 21)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 16)
    tt.vis.flags = bor(tt.vis.flags, F_DARK_ELF, F_SPELLCASTER)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_twilight_evoker.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 15
    tt.melee.attacks[1].damage_min = 5
    tt.melee.attacks[1].hit_time = fts(17)
    tt.ranged.attacks[1].bullet = "bullet_twilight_evoker"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(3, 42)}
    tt.ranged.attacks[1].cooldown = 1.5 + fts(19)
    tt.ranged.attacks[1].max_range = 110
    tt.ranged.attacks[1].min_range = 25
    tt.ranged.attacks[1].shoot_time = fts(13)
    tt.ranged.attacks[1].hold_advance = true
    tt.timed_attacks.list[1] = E:clone_c("mod_attack")
    tt.timed_attacks.list[1].animation = "towerAttack"
    tt.timed_attacks.list[1].cast_time = fts(15)
    tt.timed_attacks.list[1].cooldown = {7, 7, 7, 4}
    tt.timed_attacks.list[1].mod = "mod_twilight_evoker_silence"
    tt.timed_attacks.list[1].range = 165
    tt.timed_attacks.list[1].included_templates = {"tower_high_elven", "tower_wild_magus", "tower_druid",
                                                   "tower_entwood", "tower_archer_dwarf", "tower_musketeer",
                                                   "tower_crossbow", "tower_totem", "tower_arcane", "tower_silver",
                                                   "tower_arcane_wizard", "tower_sorcerer", "tower_archmage",
                                                   "tower_necromancer","tower_bfg","tower_dwaarp"}
    tt.timed_attacks.list[2] = E:clone_c("mod_attack")
    tt.timed_attacks.list[2].cast_time = fts(16)
    tt.timed_attacks.list[2].animation = "heal"
    tt.timed_attacks.list[2].cooldown = {7, 7, 4}
    tt.timed_attacks.list[2].max_count = 4
    tt.timed_attacks.list[2].hp_trigger_factor = 0.7
    tt.timed_attacks.list[2].mod = "mod_twilight_evoker_heal"
    tt.timed_attacks.list[2].range = 110
    tt.timed_attacks.list[2].sound = "ElvesCreepEvokerHeal"
    tt.timed_attacks.list[2].vis_flags = F_RANGED

    tt = E:register_t("enemy_twilight_golem", "enemy")
    E:add_comps(tt, "melee")
    tt.enemy.gold = 125
    tt.enemy.lives_cost = 3
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.info.portrait = "kr3_portraits_sc_0055"
    tt.info.enc_icon = 25
    tt.health.armor = 0.9
    tt.health.hp_max = 4000
    tt.health_bar.offset = vec_2(0, 80)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.health.on_damage = scripts.enemy_twilight_golem.on_damage
    tt.motion.max_speed = {0.996 * FPS, 0.996 * FPS, 1.494 * FPS}
    tt.motion.min_speed_sub_factor = 0.7
    tt.render.sprites[1].anchor = vec_2(0.5, 0.28448275862068967)
    tt.render.sprites[1].prefix = "twilight_golem"
    tt.sound_events.death = "ElvesCreepGolemDeath"
    tt.sound_events.death_args = {
        delay = fts(10)
    }
    tt.ui.click_rect = r(-30, 0, 60, 60)
    tt.unit.blood_color = BLOOD_NONE
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 30)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 30)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = F_INSTAKILL
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1] = E:clone_c("area_attack")
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_max = 180
    tt.melee.attacks[1].damage_min = 120
    tt.melee.attacks[1].damage_radius = 45
    tt.melee.attacks[1].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[1].count = 5
    tt.melee.attacks[1].hit_time = fts(14)
    tt.melee.attacks[1].sound_hit = "ElvesCreepGolemAreaAttack"
    tt.melee.attacks[1].hit_fx = "decal_twilight_golem_attack"

    tt = E:register_t("enemy_twilight_heretic", "enemy")
    E:add_comps(tt, "melee", "ranged", "timed_attacks")
    tt.info.portrait = "kr3_portraits_sc_0034"
    tt.info.enc_icon = 24
    tt.enemy.gold = 150
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(23, 0)
    tt.health.dead_lifetime = 3
    tt.health.hp_max = 1600
    tt.health.magic_armor = 0.9
    tt.health_bar.offset = vec_2(0, 40)
    tt.motion.max_speed = 0.913 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.17567567567567569)
    tt.render.sprites[1].prefix = "twilight_heretic"
    tt.sound_events.death = "DeathHuman"
    tt.unit.hit_offset = vec_2(0, 17)
    tt.unit.hide_after_death = true
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 14)
    tt.unit.show_blood_pool = false
    tt.vis.flags = bor(tt.vis.flags, F_DARK_ELF, F_SPELLCASTER)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_twilight_heretic.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 50
    tt.melee.attacks[1].damage_min = 40
    tt.melee.attacks[1].hit_time = fts(14)
    tt.ranged.attacks[1].bullet = "bullet_twilight_heretic"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(3, 42)}
    tt.ranged.attacks[1].cooldown = 0.8 + fts(23)
    tt.ranged.attacks[1].max_range = 100
    tt.ranged.attacks[1].min_range = 5
    tt.ranged.attacks[1].shoot_time = fts(15)
    tt.ranged.attacks[1].hold_advance = false
    tt.ranged.attacks[1].vis_bans = bor(F_SERVANT)
    tt.timed_attacks.list[1] = E:clone_c("mod_attack")
    tt.timed_attacks.list[1].animations = {"consumeStart", "consumeLoop", "consumeEnd"}
    tt.timed_attacks.list[1].cast_time = 0.4
    tt.timed_attacks.list[1].cooldown = {5, 5, 4}
    tt.timed_attacks.list[1].mod = "mod_twilight_heretic_consume"
    tt.timed_attacks.list[1].range = 125
    tt.timed_attacks.list[1].nodes_limit = 45
    tt.timed_attacks.list[1].vis_bans = bor(F_FLYING, F_HERO, F_ENEMY, F_SERVANT)
    tt.timed_attacks.list[1].vis_flags = bor(F_RANGED, F_MOD)
    tt.timed_attacks.list[1].hit_fx = "fx_twilight_heretic_consume"
    tt.timed_attacks.list[1].ball = "decal_twilight_heretic_consume_ball"
    tt.timed_attacks.list[1].balls_count = 3
    tt.timed_attacks.list[1].balls_dest_offset = vec_2(20, 10)
    tt.timed_attacks.list[2] = E:clone_c("mod_attack")
    tt.timed_attacks.list[2].animation = "shadowCast"
    tt.timed_attacks.list[2].cast_time = fts(15)
    tt.timed_attacks.list[2].cooldown = {20, 20, 13}
    tt.timed_attacks.list[2].mod = "mod_twilight_heretic_servant"
    tt.timed_attacks.list[2].range = 175
    tt.timed_attacks.list[2].radius = 50
    tt.timed_attacks.list[2].vis_bans = bor(F_FLYING, F_HERO, F_ENEMY, F_SERVANT)
    tt.timed_attacks.list[2].vis_flags = bor(F_RANGED, F_MOD)

    tt = E:register_t("enemy_drider", "enemy")
    E:add_comps(tt, "melee")
    tt.info.portrait = "kr3_portraits_sc_0053"
    tt.info.enc_icon = 20
    tt.enemy.gold = 50
    tt.enemy.melee_slot = vec_2(28, 0)
    tt.health.hp_max = 500
    tt.health_bar.offset = vec_2(0, 47)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.motion.max_speed = 1.411 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.15517241379310345)
    tt.render.sprites[1].prefix = "drider"
    tt.sound_events.death = "DeathEplosion"
    tt.ui.click_rect = r(-20, 0, 40, 35)
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.show_blood_pool = false
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.marker_offset = vec_2(0, 3)
    tt.unit.mod_offset = vec_2(0, 17)
    tt.vis.flags = bor(tt.vis.flags, F_DARK_ELF)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1 - fts(12)
    tt.melee.attacks[1].damage_max = 20
    tt.melee.attacks[1].damage_min = 10
    tt.melee.attacks[1].hit_time = fts(12)
    tt.melee.attacks[2] = E:clone_c("melee_attack")
    tt.melee.attacks[2].animation = "poison"
    tt.melee.attacks[2].cooldown = {5, 5, 5, 4}
    tt.melee.attacks[2].cooldown_inc = 5
    tt.melee.attacks[2].hit_time = fts(15)
    tt.melee.attacks[2].mod = "mod_drider_poison"
    tt.generation = 0

    tt = E:register_t("enemy_mantaray", "enemy")
    E:add_comps(tt, "tween", "track_kills")
    tt.info.enc_icon = 28
    tt.info.portrait = "kr3_portraits_sc_0056"
    tt.enemy.gold = 15
    tt.enemy.max_blockers = 1
    tt.enemy.melee_slot = vec_2(17, 0)
    tt.health.hp_max = 70
    tt.health_bar.offset = vec_2(0, 42)
    tt.motion.max_speed = {2.9 * FPS, 2.9 * FPS, 3.5 * FPS}
    tt.render.sprites[1].anchor = vec_2(0.5, 0.07142857142857142)
    tt.render.sprites[1].prefix = "mantaray"
    tt.render.sprites[2] = E:clone_c("sprite")
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].animated = false
    tt.sound_events.death = "DeathEplosion"
    tt.ui.click_rect = r(-20, 15, 40, 25)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset_fly = vec_2(0, 27)
    tt.unit.mod_offset_facehug = vec_2(0, 15)
    tt.unit.mod_offset = tt.unit.mod_offset_fly
    tt.unit.hit_offset_fly = vec_2(0, 24)
    tt.unit.hit_offset_facehug = vec_2(0, 16)
    tt.unit.hit_offset = tt.unit.hit_offset_fly
    tt.unit.hide_after_death = true
    tt.unit.show_blood_pool = false
    tt.vis.flags = bor(tt.vis.flags, F_FLYING)
    tt.vis.bans = bor(tt.vis.bans, F_SKELETON, F_BLOOD)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mantaray.update
    tt.main_script.remove = scripts.enemy_mantaray.remove
    tt.tween.props[1].name = "offset"
    tt.tween.disabled = true
    tt.tween.remove = false
    tt.facehug_damage_cooldown = 1
    tt.facehug_offsets = {}
    tt.facehug_offsets.hero_default = vec_2(0, 4)
    tt.facehug_offsets.soldier_default = vec_2(-2, 3)
    tt.facehug_offsets.hero_arivan = vec_2(4, 5)
    tt.facehug_offsets.hero_bravebark = vec_2(10, 22)
    tt.facehug_offsets.hero_bruce = vec_2(3, 23)
    tt.facehug_offsets.hero_catha = vec_2(3, 15)
    tt.facehug_offsets.hero_durax = vec_2(4, 28)
    tt.facehug_offsets.hero_durax_clone = vec_2(4, 28)
    tt.facehug_offsets.hero_elves_archer = vec_2(3, 9)
    tt.facehug_offsets.hero_elves_denas = vec_2(4, 13)
    tt.facehug_offsets.hero_lilith = vec_2(0, 17)
    tt.facehug_offsets.hero_lynn = vec_2(0, 8)
    tt.facehug_offsets.hero_rag = vec_2(9, 18)
    tt.facehug_offsets.hero_regson = vec_2(5, 3)
    tt.facehug_offsets.hero_veznan = vec_2(0, 8)
    tt.facehug_offsets.hero_xin = vec_2(2, 16)
    tt.facehug_offsets.soldier_blade = vec_2(0, 10)
    tt.facehug_offsets.soldier_bravebark = vec_2(0, 1)
    tt.facehug_offsets.soldier_catha = vec_2(0, 14)
    tt.facehug_offsets.soldier_drow = vec_2(0, 10)
    tt.facehug_offsets.soldier_druid_bear = vec_2(15, 0)
    tt.facehug_offsets.soldier_elves_denas_guard = vec_2(0, 10)
    tt.facehug_offsets.soldier_forest = vec_2(0, 13)
    tt.facehug_offsets.soldier_rag = vec_2(0, 10)
    tt.facehug_offsets.soldier_re_5_1 = vec_2(-3, 18)
    tt.facehug_offsets.soldier_re_5_2 = vec_2(-3, 18)
    tt.facehug_offsets.soldier_re_5_3 = vec_2(-3, 18)
    tt.facehug_offsets.soldier_veznan_demon = vec_2(10, 21)
    tt.facehug_damage_soldier_min = 15
    tt.facehug_damage_soldier_max = 20
    tt.facehug_damage_hero_min = 10
    tt.facehug_damage_hero_max = 30
    tt.facehug_spawn_bans = {"soldier_druid_bear", "soldier_xin_ultimate", "soldier_xin_shadow", "soldier_bravebark",
                             "hero_alleria", "soldier_veznan_demon", "hero_baby_malik"}

    tt = E:register_t("enemy_razorboar", "enemy")
    E:add_comps(tt, "melee", "timed_attacks", "auras")
    tt.info.enc_icon = 23
    tt.info.portrait = "kr3_portraits_sc_0052"
    tt.auras.list[1] = E:clone_c("aura_attack")
    tt.auras.list[1].name = "aura_razorboar_rage"
    tt.auras.list[1].cooldown = 0
    tt.enemy.gold = 75
    tt.enemy.melee_slot = vec_2(35, 0)
    tt.health.armor = {0.6, 0.6, 0.75}
    tt.health.hp_max = 1250
    tt.health_bar.offset = vec_2(0, 47)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.motion.max_speed = 0.913 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.15625)
    tt.render.sprites[1].prefix = "razorboar"
    tt.render.sprites[1].angles.run = {"runningRightLeft", "runningDown", "runningUp"}
    tt.render.sprites[1].angles_stickiness.run = 10
    tt.sound_events.death = "DeathBig"
    tt.ui.click_rect = r(-20, 0, 40, 30)
    tt.unit.hit_offset = vec_2(0, 16)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 16)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_SKELETON)
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_razorboar.update
    tt.melee.attacks[1].cooldown = 1.5
    tt.melee.attacks[1].damage_max = {40, 40, 80}
    tt.melee.attacks[1].damage_min = {30, 30, 60}
    tt.melee.attacks[1].hit_time = fts(14)
    tt.timed_attacks.list[1] = E:clone_c("custom_attack")
    tt.timed_attacks.list[1].cooldown = 5
    tt.timed_attacks.list[1].nodes_limit = 35
    tt.timed_attacks.list[1].vis_flags_enemies = bor(F_MOD, F_RANGED)
    tt.timed_attacks.list[1].vis_bans_enemies = bor(F_FLYING, F_BOSS)
    tt.timed_attacks.list[1].vis_flags_soldiers = bor(F_MOD, F_RANGED)
    tt.timed_attacks.list[1].vis_bans_soldiers = bor(F_FLYING)
    tt.timed_attacks.list[1].trigger_range = 50
    tt.timed_attacks.list[1].range = 37.5
    tt.timed_attacks.list[1].sound = "ElvesCreepRazorboarCharge"
    tt.timed_attacks.list[1].duration = 1.2
    tt.timed_attacks.list[1].mod_enemy = "mod_razorboar_rampage_enemy"
    tt.timed_attacks.list[1].mod_soldier = "mod_razorboar_rampage_soldier"
    tt.timed_attacks.list[1].mod_self = "mod_razorboar_rampage_speed"
    tt.timed_attacks.list[1].particles_name = "ps_razorboar_rampage"

    tt = E:register_t("enemy_arachnomancer", "enemy")
    E:add_comps(tt, "melee", "timed_attacks", "death_spawns")
    tt.info.portrait = "kr3_portraits_sc_0010"
    tt.info.enc_icon = 22
    tt.death_spawns.name = "bullet_arachnomancer_spawn"
    tt.death_spawns.delay = fts(26)
    tt.death_spawns.spread_nodes = 3
    tt.death_spawns.offset = vec_2(0, 6)
    tt.death_spawns.quantity = 3
    tt.enemy.gold = 110
    tt.enemy.lives_cost = 3
    tt.enemy.melee_slot = vec_2(22, 0)
    tt.health.hp_max = 750
    tt.health_bar.offset = vec_2(0, 33)
    tt.motion.max_speed = 1.079 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.136)
    tt.render.sprites[1].prefix = "arachnomancer"
    tt.sound_events.death = "DeathHuman"
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 16)
    tt.unit.mod_offset = vec_2(0, 15)
    tt.unit.can_explode = false
    tt.vis.flags = bor(tt.vis.flags, F_DARK_ELF, F_SPELLCASTER)
    tt.vis.bans = bor(tt.vis.bans, F_POLYMORPH)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_arachnomancer.update
    tt.melee.attacks[1].cooldown = 1 - fts(23)
    tt.melee.attacks[1].damage_max = 24
    tt.melee.attacks[1].damage_min = 16
    tt.melee.attacks[1].hit_time = fts(23)
    tt.timed_attacks.list[1] = E:clone_c("spawn_attack")
    tt.timed_attacks.list[1].entity = "arachnomancer_random_spawner"
    tt.timed_attacks.list[1].animation = "summon"
    tt.timed_attacks.list[1].spawn_time = fts(20)
    tt.timed_attacks.list[1].cooldown = {7, 7, 5}
    tt.timed_attacks.list[1].nodes_limit = 40
    tt.timed_attacks.list[1].spawn_sets = {{4, "decal_webspawn_enemy_spider_arachnomancer"},
                                           {3, "decal_webspawn_enemy_sword_spider"},
                                           {2, "decal_webspawn_enemy_spider_son_of_mactans"}}

    tt = E:register_t("arachnomancer_random_spawner")
    E:add_comps(tt, "pos", "spawner", "main_script", "sound_events")
    tt.main_script.update = scripts.enemies_spawner.update
    tt.spawner.count = nil
    tt.spawner.random_cycle = {0, fts(2)}
    tt.spawner.entity = nil
    tt.spawner.random_node_offset_range = {-8, 2}
    tt.spawner.random_subpath = true
    tt.spawner.initial_spawn_animation = "idle"
    tt.spawner.check_node_valid = true
    tt.spawner.use_node_pos = true
    tt.sound_events.insert = "ElvesCreepArachnomancerSpiderSpawn"

    tt = E:register_t("enemy_spider_arachnomancer", "enemy")
    E:add_comps(tt, "melee")
    tt.enemy.gold = 15
    tt.enemy.melee_slot = vec_2(20, 0)
    tt.health.hp_max = 80
    tt.health.magic_armor = 0.5
    tt.health_bar.offset = vec_2(0, 21)
    tt.info.portrait = "kr3_portraits_sc_0054"
    tt.info.i18n_key = "ENEMY_ARACHNOMANCER_SPIDER"
    tt.info.enc_icon = 30
    tt.motion.max_speed = 1.992 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.15625)
    tt.render.sprites[1].prefix = "arachnomancer_spider"
    tt.sound_events.death = "DeathEplosion"
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.hit_offset = vec_2(0, 12)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 12)
    tt.vis.bans = bor(tt.vis.bans, F_POISON, F_SKELETON)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 6
    tt.melee.attacks[1].damage_min = 4
    tt.melee.attacks[1].hit_time = fts(14)

    tt = RT("spider_arachnomancer_egg_spawner", "decal_scripted")
    AC(tt, "spawner", "sound_events", "tween", "editor")
    tt.render.sprites[1].prefix = "spider_egg_spawner"
    tt.render.sprites[1].name = "spawn"
    tt.render.sprites[1].loop = false
    tt.render.sprites[1].anchor.y = 0.4
    tt.spawner.entity = "enemy_spider_arachnomancer"
    tt.spawner.eternal = true
    tt.spawner.random_subpath = true
    tt.spawner.cycle_time = fts(10)
    tt.main_script.update = scripts.spider_arachnomancer_egg_spawner.update
    tt.sound_events.open = "ElvesSpecialSpiderEggs"
    tt.idle_range = {5, 15}
    tt.spawn_time = fts(8)
    tt.spawn_once = nil
    tt.spawn_data = nil
    tt.tween.disabled = true
    tt.tween.props[1].keys = {{0, 255}, {fts(10), 0}}

    tt = E:register_t("enemy_spider_son_of_mactans", "enemy")
    E:add_comps(tt, "melee")
    tt.info.portrait = "kr3_portraits_sc_0031"
    tt.info.enc_icon = 29
    tt.enemy.gold = 35
    tt.enemy.melee_slot = vec_2(32, 0)
    tt.health.hp_max = 260
    tt.health.magic_armor = 0.9
    tt.health_bar.offset = vec_2(0, 32)
    tt.info.i18n_key = "ENEMY_SON_OF_MACTANS"
    tt.motion.max_speed = {2 * FPS, 2 * FPS, 2.2 * FPS}
    tt.render.sprites[1].anchor = vec_2(0.5, 0.128571)
    tt.render.sprites[1].prefix = "son_of_mactans"
    tt.sound_events.death = "DeathEplosion"
    tt.unit.blood_color = BLOOD_GREEN
    tt.unit.hit_offset = vec_2(0, 15)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 15)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 12
    tt.melee.attacks[1].damage_min = 8
    tt.melee.attacks[1].hit_time = fts(12)
    tt.melee.attacks[2] = table.deepclone(tt.melee.attacks[1])
    tt.melee.attacks[2].mod = "mod_son_of_mactans_poison"
    tt.melee.attacks[2].cooldown = 6

    tt = RT("spider_son_of_mactans_drop_spawner", "decal_scripted")
    AC(tt, "nav_path", "motion", "spawner", "sound_events")
    tt.spawn = "enemy_spider_son_of_mactans"
    tt.main_script.update = scripts.spider_son_of_mactans_drop_spawner.update
    tt.sound_events.insert = "ElvesCreepSonOfMactansLanding"
    tt.render.sprites[1].prefix = "son_of_mactans"
    tt.render.sprites[1].name = "netDescend"
    tt.render.sprites[1].anchor.y = 0.12857142857142856
    tt.render.sprites[1].z = Z_OBJECTS_SKY

    for i = 1, math.ceil(REF_H / 18) do
        local s = E:clone_c("sprite")

        s.prefix = "son_of_mactans_thread_" .. (i % 2 == 0 and "1" or "2")
        s.name = "idle"
        s.loop = false
        s.anchor.y = 0
        s.offset.y = (i - 1) * 18 + 40
        s.z = Z_OBJECTS_SKY - 1
        tt.render.sprites[i + 1] = s
    end

    tt = RT("enemy_mactans", "decal_scripted")
    AC(tt, "ui", "tween", "editor")
    tt.render.sprites[1].prefix = "mactans"
    tt.render.sprites[1].name = "falling"
    tt.render.sprites[1].anchor.y = 0
    tt.render.sprites[1].z = Z_OBJECTS_SKY + 1
    tt.drop_duration = 2
    tt.retreat_duration = 1.5
    tt.netting_duration = 2.6
    tt.main_script.update = scripts.enemy_mactans.update
    tt.ui.can_select = false
    tt.ui.can_click = true
    tt.ui.click_rect = r(-40, 30, 80, 80)
    tt.ui.z = 1
    tt.tween.disabled = true
    tt.tween.remove = false
    tt.tween.props[1].name = "offset"
    tt.tween.props[1].keys = {{0, vec_1(0)}, {fts(2), vec_2(0, 7)}, {fts(4), vec_2(0, 2)}, {fts(6), vec_2(0, 1)},
                              {fts(8), vec_2(0, -3)}, {fts(10), vec_2(0, -8)}, {fts(12), vec_2(0, -2)},
                              {fts(14), vec_2(0, 3)}}
    tt.tween.props[2] = CC("tween_prop")
    tt.tween.props[2].name = "r"
    tt.tween.props[2].keys = {{0, 0}, {fts(2), d2r(-6)}, {fts(4), d2r(-1)}, {fts(6), d2r(3)}, {fts(8), d2r(5)},
                              {fts(10), d2r(0)}, {fts(12), d2r(0)}, {fts(14), d2r(0)}}
    tt.editor.overrides = {
        ["render.sprites[1].name"] = "retreat"
    }

    tt = RT("enemy_gnoll_bloodsydian", "enemy")
    E:add_comps(tt, "melee")
    tt.info.portrait = "kr3_portraits_sc_0070"
    tt.info.enc_icon = 35
    tt.enemy.gold = 20
    tt.enemy.melee_slot = vec_2(32, 0)
    tt.health.damage_factor_magical = 1.3
    tt.health.hp_max = 400
    tt.health_bar.offset = vec_2(0, 38)
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = {24, 24, 40}
    tt.melee.attacks[1].damage_min = {16, 16, 20}
    tt.melee.attacks[1].hit_time = fts(16)
    tt.motion.max_speed = 2.075 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.3111111111111111)
    tt.render.sprites[1].prefix = "bloodsydianGnoll"
    tt.sound_events.death = "ElvesDeathGnolls"
    tt.unit.hit_offset = vec_2(0, 16)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 16)

    tt = RT("enemy_bloodsydian_warlock", "enemy")
    AC(tt, "melee", "timed_attacks")
    tt.info.enc_icon = 37
    tt.info.portrait = "kr3_portraits_sc_0071"
    tt.enemy.gold = 50
    tt.enemy.melee_slot = vec_2(37, 0)
    tt.health.hp_max = 1200
    tt.health.magic_armor = {0.5, 0.5, 0.75}
    tt.health_bar.offset = vec_2(0, 58)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_bloodsydian_warlock.update
    tt.melee.attacks[1].cooldown = 1.5
    tt.melee.attacks[1].damage_max = 30
    tt.melee.attacks[1].damage_min = 23
    tt.melee.attacks[1].hit_time = fts(27)
    tt.motion.max_speed = 0.664 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.16279069767441862)
    tt.render.sprites[1].prefix = "bloodsydianWarlock"
    tt.sound_events.death = "ElvesDeathGnolls"
    tt.ui.click_rect = r(-20, 0, 40, 40)
    tt.unit.hit_offset = vec_2(0, 24)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 23)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)
    tt.timed_attacks.list[1] = CC("mod_attack")
    tt.timed_attacks.list[1].allowed_templates = {"enemy_gnoll_burner", "enemy_gnoll_reaver"}
    tt.timed_attacks.list[1].mod = "mod_bloodsydian_warlock"
    tt.timed_attacks.list[1].animation = "convert"
    tt.timed_attacks.list[1].cast_time = fts(20)
    tt.timed_attacks.list[1].hit_decal = "decal_bloodsydian_warlock"
    tt.timed_attacks.list[1].cooldown = {8, 8, 5}
    tt.timed_attacks.list[1].max_range = 150
    tt.timed_attacks.list[1].max_count = 5
    tt.timed_attacks.list[1].min_count = 2
    tt.timed_attacks.list[1].nodes_min = 30
    tt.timed_attacks.list[1].nodes_limit = 20
    tt.timed_attacks.list[1].vis_flags = bor(F_RANGED, F_MOD)

    tt = RT("enemy_perython_rock_thrower", "enemy_perython")
    AC(tt, "death_spawns")
    tt.info.i18n_key = "ENEMY_PERYTHON"
    tt.render.sprites[3] = E:clone_c("sprite")
    tt.render.sprites[3].prefix = "perython_rock"
    tt.render.sprites[3].name = "flySide"
    tt.render.sprites[3].anchor = vec_2(0.5, 0.5)
    tt.render.sprites[3].offset.y = 10
    tt.death_spawns.name = "rock_perython"
    tt.death_spawns.concurrent_with_death = true
    tt.main_script.update = scripts.enemy_perython_carrier.update
    tt.spawn_trigger_range = 50
    tt.drop_delay = {0.5, 0.9}

    tt = RT("enemy_ogre_magi", "enemy")
    AC(tt, "ranged", "auras")
    tt.auras.list[1] = CC("aura_attack")
    tt.auras.list[1].name = "aura_ogre_magi_shield"
    tt.auras.list[1].cooldown = 0
    tt.auras.list[2] = CC("aura_attack")
    tt.auras.list[2].name = "aura_ogre_magi_regen"
    tt.auras.list[2].cooldown = 0
    tt.info.enc_icon = 36
    tt.info.portrait = "kr3_portraits_sc_0050"
    tt.enemy.gold = 100
    tt.enemy.lives_cost = {2, 2, 2, 3}
    tt.enemy.melee_slot = vec_2(38, 0)
    tt.health.hp_max = 1700
    tt.health.magic_armor = {0.75, 0.75, 0.8}
    tt.health_bar.offset = vec_2(0, 63)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_ogre_magi.update
    tt.ranged.attacks[1].cooldown = 1.5
    tt.ranged.attacks[1].animation = "attack"
    tt.ranged.attacks[1].damage_max = 72
    tt.ranged.attacks[1].damage_min = 48
    tt.ranged.attacks[1].shoot_time = fts(17)
    tt.ranged.attacks[1].bullet = "bolt_ogre_magi"
    tt.ranged.attacks[1].max_range = 125
    tt.ranged.attacks[1].min_range = 50
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(-25, 53)}
    tt.motion.max_speed = 0.83 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.17777777777777778)
    tt.render.sprites[1].prefix = "ogre_mage"
    tt.sound_events.death = "DeathBig"
    tt.ui.click_rect = r(-20, 0, 40, 45)
    tt.unit.hit_offset = vec_2(0, 27)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 25)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.flags = bor(tt.vis.flags, F_SPELLCASTER)

    tt = RT("enemy_ogre_magi_custody_ettin", "enemy_ettin")
    tt.motion.max_speed = 0.83 * FPS
    tt.info.i18n_key = "ENEMY_ETTIN"
    tt = RT("enemy_ogre_magi_custody_gnoll_gnawer", "enemy_gnoll_gnawer")
    tt.motion.max_speed = 0.83 * FPS
    tt.info.i18n_key = "ENEMY_GNOLL_GNAWER"
    tt = RT("enemy_ogre_magi_custody_warlock", "enemy_bloodsydian_warlock")
    tt.motion.max_speed = 0.83 * FPS
    tt.info.i18n_key = "ENEMY_BLOODSYDIAN_WARLOCK"

    tt = RT("enemy_blood_servant", "enemy")
    E:add_comps(tt, "melee")
    tt.enemy.gold = 20
    tt.enemy.melee_slot = vec_2(30, 0)
    tt.health.hp_max = 200
    tt.health_bar.offset = vec_2(0, 30)
    tt.info.enc_icon = 39
    tt.info.portrait = "kr3_portraits_sc_0073"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = {24, 24, 30}
    tt.melee.attacks[1].damage_min = {16, 16, 20}
    tt.melee.attacks[1].hit_time = fts(15)
    tt.melee.attacks[1].sound = "WolfAttack"
    tt.motion.max_speed = 2.241 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.14285714285714285)
    tt.render.sprites[1].prefix = "bloodServant"
    tt.sound_events.death = "ElvesCreepServantDeath"
    tt.unit.hit_offset = vec_2(0, 16)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 14)

    tt = RT("enemy_mounted_avenger", "enemy")
    E:add_comps(tt, "melee", "death_spawns")
    tt.death_spawns.name = "enemy_twilight_avenger"
    tt.death_spawns.delay = fts(21)
    tt.death_spawns.offset = vec_2(0, 7)
    tt.enemy.gold = 60
    tt.enemy.lives_cost = 2
    tt.enemy.melee_slot = vec_2(35, 0)
    tt.health.hp_max = 1000
    tt.health.magic_armor = {0.5, 0.5, 0.7}
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.health_bar.offset = vec_2(0, 65)
    tt.info.enc_icon = 40
    tt.info.portrait = "kr3_portraits_sc_0074"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = {90, 90, 110}
    tt.melee.attacks[1].damage_min = {60, 60, 70}
    tt.melee.attacks[1].hit_time = fts(19)
    tt.motion.max_speed = 1.411 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.1875)
    tt.render.sprites[1].prefix = "mountedAvenger"
    tt.ui.click_rect = r(-20, 0, 40, 50)
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 21)
    tt.unit.marker_offset = vec_2(0, -2)
    tt.unit.mod_offset = vec_2(0, 27)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.flags = bor(tt.vis.flags, F_DARK_ELF)
    tt.sound_events.death = "ElvesCreepMountedAvengerDeath"
    tt.sound_events.death_args = {
        delay = fts(15)
    }

    tt = RT("enemy_screecher_bat", "enemy")
    E:add_comps(tt, "timed_attacks")
    tt.enemy.gold = 30
    tt.health.hp_max = 90
    tt.health_bar.offset = vec_2(0, 90)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.enc_icon = 41
    tt.info.portrait = "kr3_portraits_sc_0075"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_screecher_bat.update
    tt.motion.max_speed = {1.9 * FPS, 1.9 * FPS, 2 * FPS}
    tt.render.sprites[1].anchor = vec_2(0.5, 0.05)
    tt.render.sprites[1].prefix = "screecher_bat"
    tt.render.sprites[2] = CC("sprite")
    tt.render.sprites[2].name = "decal_flying_shadow"
    tt.render.sprites[2].animated = false
    tt.sound_events.death = "ElvesCreepScreecherDeath"
    tt.timed_attacks.list[1] = CC("mod_attack")
    tt.timed_attacks.list[1].animation = "attack"
    tt.timed_attacks.list[1].mod = "mod_screecher_bat_stun"
    tt.timed_attacks.list[1].cooldown = {5, 5, 4.5}
    tt.timed_attacks.list[1].max_range = 50
    tt.timed_attacks.list[1].attack_time = fts(10)
    tt.timed_attacks.list[1].vis_bans = bor(F_FLYING)
    tt.timed_attacks.list[1].vis_flags = bor(F_STUN)
    tt.timed_attacks.list[1].sound = "ElvesCreepScreecherScream"
    tt.ui.click_rect = r(-15, 45, 30, 35)
    tt.unit.can_explode = false
    tt.unit.hide_after_death = true
    tt.unit.hit_offset = vec_2(0, 54)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 50)
    tt.unit.show_blood_pool = false
    tt.vis.flags = bor(tt.vis.flags, F_FLYING)
    tt.vis.bans = bor(F_BLOCK)

    tt = RT("enemy_dark_spitters", "enemy")
    AC(tt, "melee", "ranged")
    tt.enemy.gold = 70
    tt.enemy.melee_slot = vec_2(27, 0)
    tt.health.armor = {0.5, 0.5, 0.8}
    tt.health.hp_max = 800
    tt.health_bar.offset = vec_2(0, 53)
    tt.info.enc_icon = 45
    tt.info.portrait = "kr3_portraits_sc_0080"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 36
    tt.melee.attacks[1].damage_min = 24
    tt.melee.attacks[1].hit_time = fts(17)
    tt.motion.max_speed = 0.83 * FPS
    tt.ranged.attacks[1].bullet = "bullet_dark_spitters"
    tt.ranged.attacks[1].bullet_start_offset = {vec_2(8, 36)}
    tt.ranged.attacks[1].cooldown = 1.5 + fts(19)
    tt.ranged.attacks[1].hold_advance = true
    tt.ranged.attacks[1].max_range = 125
    tt.ranged.attacks[1].min_range = 40
    tt.ranged.attacks[1].shoot_time = fts(11)
    tt.ranged.attacks[1].vis_flags = bor(F_RANGED, F_BURN)
    tt.render.sprites[1].anchor = vec_2(0.5, 0.12857142857142856)
    tt.render.sprites[1].prefix = "dark_spitters"
    tt.sound_events.death = "ElvesDarkSpitterDeath"
    tt.ui.click_rect = r(-15, 0, 30, 40)
    tt.unit.blood_color = BLOOD_ORANGE
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 16)

    tt = RT("enemy_shadows_spawns", "enemy")
    AC(tt, "melee")
    tt.enemy.gold = 20
    tt.enemy.melee_slot = vec_2(25, 0)
    tt.health.hp_max = 350
    tt.health_bar.offset = vec_2(0, 34)
    tt.info.enc_icon = 44
    tt.info.portrait = "kr3_portraits_sc_0079"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = 24
    tt.melee.attacks[1].damage_min = 16
    tt.melee.attacks[1].hit_time = fts(17)
    tt.motion.max_speed = 1.66 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.29411764705882354)
    tt.render.sprites[1].prefix = "shadow_spawn"
    tt.sound_events.death = "ElvesShadowSpawnDeath"
    tt.sound_events.raise = "ElvesShadowSpawnSpawn"
    tt.sound_events.raise_args = {
        delay = fts(2)
    }
    tt.unit.blood_color = BLOOD_ORANGE
    tt.unit.hit_offset = vec_2(0, 16)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 16)

    tt = RT("enemy_grim_devourers", "enemy")
    AC(tt, "melee")
    tt.cannibalize = {}
    tt.cannibalize.extra_hp = 50
    tt.cannibalize.cycles = 26
    tt.cannibalize.hp_per_cycle = 2
    tt.enemy.gold = 40
    tt.enemy.melee_slot = vec_2(23, 0)
    tt.health.armor = {0.3, 0.3, 0.6}
    tt.health.hp_max = 500
    tt.health_bar.offset = vec_2(0, 42)
    tt.info.enc_icon = 46
    tt.info.portrait = "kr3_portraits_sc_0081"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_grim_devourers.update
    tt.melee.attacks[1].cooldown = 1
    tt.melee.attacks[1].damage_max = {48, 48, 55}
    tt.melee.attacks[1].damage_min = {32, 32, 40}
    tt.melee.attacks[1].hit_time = fts(9)
    tt.motion.max_speed = 1.245 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.14705882352941177)
    tt.render.sprites[1].prefix = "grim_devourers"
    tt.sound_events.death = "ElvesGrimDevourerDeath"
    tt.sound_events.cannibalize = "ElvesGrimDevourerConsume"
    tt.unit.blood_color = BLOOD_ORANGE
    tt.unit.hit_offset = vec_2(0, 18)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 16)

    tt = RT("enemy_shadow_champion", "enemy")
    AC(tt, "melee", "death_spawns")
    tt.death_spawns.name = "aura_shadow_champion_death"
    tt.death_spawns.delay = fts(26)
    tt.death_spawns.no_spawn_damage_types = bor(DAMAGE_EXPLOSION, DAMAGE_FX_EXPLODE)
    tt.enemy.gold = 140
    tt.enemy.lives_cost = 3
    tt.enemy.melee_slot = vec_2(40, 0)
    tt.health.armor = 0.9
    tt.health.hp_max = 2200
    tt.health_bar.offset = vec_2(0, 55)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.enc_icon = 47
    tt.info.portrait = "kr3_portraits_sc_0082"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].count = 50
    tt.melee.attacks[1].damage_max = 96
    tt.melee.attacks[1].damage_min = 64
    tt.melee.attacks[1].damage_radius = 45
    tt.melee.attacks[1].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[1].hit_time = fts(10)
    tt.melee.attacks[1].hit_offset = vec_2(40, 0)
    tt.melee.attacks[1].sound_hit = "ElvesShadowChampionAttack"
    tt.motion.max_speed = 0.664 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.203125)
    tt.render.sprites[1].prefix = "shadow_champion"
    tt.sound_events.death = "ElvesShadowChampionDeath"
    tt.ui.click_rect = r(-20, 0, 40, 45)
    tt.unit.blood_color = BLOOD_ORANGE
    tt.unit.hit_offset = vec_2(0, 27)
    tt.unit.marker_offset = vec_2(0, 0)
    tt.unit.mod_offset = vec_2(0, 27)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = F_INSTAKILL

    tt = RT("enemy_gnoll_warleader", "enemy")
    AC(tt, "melee", "death_spawns")
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.name = "fx_coin_shower"
    tt.death_spawns.offset = vec_2(0, 60)
    tt.enemy.gold = 250
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(43, 0)
    tt.health.hp_max = 2500
    tt.health_bar.offset = vec_2(0, 65)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.enc_icon = 34
    tt.info.i18n_key = "ENEMY_ENDLESS_MINIBOSS_GNOLL"
    tt.info.portrait = "kr3_portraits_sc_0069"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1] = E:clone_c("area_attack")
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].damage_max = 80
    tt.melee.attacks[1].damage_min = 50
    tt.melee.attacks[1].damage_radius = 45
    tt.melee.attacks[1].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[1].hit_offset = vec_2(43, 0)
    tt.melee.attacks[1].sound_hit = "EndlessWarleaderDoubleSword"
    tt.melee.attacks[1].hit_time = fts(11)
    tt.motion.max_speed = 0.664 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.2222222222222222)
    tt.render.sprites[1].prefix = "enemy_gnoll_warleader"
    tt.sound_events.death = "EndlessWarleaderDeath"
    tt.unit.hit_offset = vec_2(0, 27)
    tt.unit.mod_offset = vec_2(0, 25)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_TELEPORT, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)

    tt = RT("enemy_twilight_brute", "enemy")
    AC(tt, "melee", "auras", "death_spawns")
    tt.auras.list[1] = CC("aura_attack")
    tt.auras.list[1].name = "aura_twilight_brute"
    tt.auras.list[1].cooldown = 0
    tt.death_spawns.concurrent_with_death = true
    tt.death_spawns.name = "fx_coin_shower"
    tt.death_spawns.offset = vec_2(0, 60)
    tt.enemy.gold = 250
    tt.enemy.lives_cost = 20
    tt.enemy.melee_slot = vec_2(43, 0)
    tt.health.hp_max = 2500
    tt.health_bar.offset = vec_2(0, 65)
    tt.health_bar.type = HEALTH_BAR_SIZE_MEDIUM
    tt.info.enc_icon = 43
    tt.info.i18n_key = "ENEMY_ENDLESS_MINIBOSS_TWILIGHT"
    tt.info.portrait = "kr3_portraits_sc_0077"
    tt.main_script.insert = scripts.enemy_basic.insert
    tt.main_script.update = scripts.enemy_mixed.update
    tt.melee.attacks[1] = CC("area_attack")
    tt.melee.attacks[1].cooldown = 2
    tt.melee.attacks[1].damage_max = 80
    tt.melee.attacks[1].damage_min = 50
    tt.melee.attacks[1].damage_radius = 45
    tt.melee.attacks[1].damage_type = DAMAGE_PHYSICAL
    tt.melee.attacks[1].count = 10
    tt.melee.attacks[1].hit_offset = vec_2(43, 3)
    tt.melee.attacks[1].hit_time = fts(11)
    tt.motion.max_speed = 0.664 * FPS
    tt.render.sprites[1].anchor = vec_2(0.5, 0.1875)
    tt.render.sprites[1].prefix = "enemy_twilight_bannerbearer"
    tt.sound_events.death = "EndlessBruteDeath"
    tt.unit.can_explode = false
    tt.unit.hit_offset = vec_2(0, 25)
    tt.unit.mod_offset = vec_2(0, 25)
    tt.unit.size = UNIT_SIZE_MEDIUM
    tt.vis.bans = bor(F_TELEPORT, F_POLYMORPH)
    tt.vis.flags = bor(F_ENEMY, F_BOSS)
end

return enemies
